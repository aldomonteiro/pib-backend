{"version":3,"sources":["../../../src/api/bot/botController.js"],"names":["log_file","fs","createWriteStream","__dirname","flags","log_stdout","process","stdout","console","log","d","write","util","format","MSG_GENERAL_ERROR","sendErrorMsg","_errorMsg","out","Elements","_showErrorMsg","add","text","askForContinue","type","options","data","event","checkLastAction","pageId","userId","pendingOrder","order","wf","waitingFor","wfd","waitingForData","addrData","confirmAddress","askForLocation","location","lat","location_lat","location_long","url","location_url","confirmLocationAddress","askForSizeCat","askForDeliver","askForCategory","askForQuantity","checkSplit","askForFlavor","askForChangeOrder","showPartialOrder","askForWantBeverage","askForBeverages","askForPaymentType","askForPaymentChange","askForComments","showFullOrder","showOrderOrNextItem","sendMainMenu","optionsStopOrder","passThreadControl","source","user","_txt","error","sendWelcomeMessage","pageID","sender","_nameToReplace","fetch","first_name","page","replyMsg","firstResponseText","replace","sendHorario","todayIsOpen","todayOpenAt","todayCloseAt","reply","sendCardapio","id","getFlavorsAndToppings","categoryID","sizeID","flavorArray","allToppings","pricings","flavorsWithPrice","flavor","categoryId","price","sizeId","toppingsNames","toppings","tId","topping","push","flavorsAndToppingsErr","askForWantOrder","storeData","delivery_time","delivery_fees","length","delivFee","fee","to","pickup_time","time","address","showDeliver","_phone","deliverType","deliverTime","storeAddress","phone","_txtReply","showDeliverCheckAddress","prevAnswer","confirmAddressOrAskLocation","nextQuestion","isLocation","addresses","foundAnyCompleteAddress","i","element","address_components","_data","formatted_address","button","addressNumber","subtext","buttons","buttonsOpt","isOnlyButtons","askToTypeAddress","userID","waitingForAddress","_replyText","formattedAddress","showAddress","formattedAddrData","showOrderOrAskForPhone","isComplete","po","askForPhone","_options","isPhoneNumber","askToTypePhone","confirmTypedPhone","replies","QuickReplies","setQuickReplies","showPhone","showDeliverAskForQuantity","showAddressAskForQuantity","backToConfirmation","whatsText","askForQuantityMore","showQuantity","qty","substr","undo","currentItem","askForSize","_text","sizesWithPricing","sizes","size","split","qty_total","eraseSplit","showQuantityAskForSize","showSize","multiple","currentItemSize","currentSize","askForFlavorOrConfirm","showSizeCheckSplit","showSplit","originalSplit","_txtFlavor","currentItemSplit","items","status","flavorId","_id","showSplitCheckFlavor","currentItemCategory","flavorsArray","_splitForTheItem","currentSplit","NUMBER_OF_ITEMS","_rangeIni","_rangeEnd","_fl","_subtext","join","concat","hidden","option","showFlavor","origSplit","orderId","itemId","_complete","info","completeItem","calcTotal","cancelPendingShowPartialOrder","splice","total_price","item","_txtQty","_txtSize","deliver_type","delivery_fee","backTo","showFlavorCheckItem","payment_types","paymentType","payment_type","surcharge_percent","surcharge_amount","surcharge_amonut","showPaymentType","_txtPaymentType","showPaymentTypeAskForPaymentChange","showPaymentChange","paymentChange","_txtPaymentChange","showPaymentChangeAskForComments","askToTypeComments","showComments","comments","_txtComments","store_address","payment_change","showPaymentTypeAskForComments","showFullOrderConfirmOrder","confirmOrder","nextAnswer","hasOwnProperty","confirmStep","_evt","askForOptionsToChange","askForOptionsToChangeErr","askForSpecificItem","_itemId","_sizeSplit","category","toUpperCase","indexOf","_txtHead","noBeverage","no_beverage","beveragesArr","_bev","beverage","name","kind","showNoBeverage","showBeverage","beverageId","beveragePrice","showBeverageAskForPaymentType","showNoBeverageAskForPaymentType","changeItem","showCommentsItem","cancelItem","result1","updateItemAskOptions","sendShippingNotification","accessToken","Bot","send_message_tag","sendRejectionNotification","rejectionExplanation","cancelPendingOrder","showDeliverAskForCategory","showAddressAskForCategory","categories","is_pizza","showCategory","eraseSize","showCategoryAskForSize","price_by_size","sizeData"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AAIA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAIA;;AAIA;;AACA;;;;;;;;AAEA;AACA,IAAIA,QAAQ,GAAGC,eAAGC,iBAAH,CAAqBC,SAAS,GAAG,YAAjC,EAA+C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA/C,CAAf;;AACA,IAAIC,UAAU,GAAGC,OAAO,CAACC,MAAzB;;AAEAC,OAAO,CAACC,GAAR,GAAc,UAAUC,CAAV,EAAa;AAAE;AACzBV,EAAAA,QAAQ,CAACW,KAAT,CAAeC,iBAAKC,MAAL,CAAYH,CAAZ,IAAiB,IAAhC;AACAL,EAAAA,UAAU,CAACM,KAAX,CAAiBC,iBAAKC,MAAL,CAAYH,CAAZ,IAAiB,IAAlC;AACH,CAHD;;AAKA,IAAMI,iBAAiB,GAAG,2CAA1B,C,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEO,IAAMC,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,iBAAOC,SAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAClBC,YAAAA,GADkB,GACZ,IAAIC,8BAAJ,EADY;AAEpBC,YAAAA,aAFoB,GAEJH,SAAS,IAAI,mBAFT;AAGxBC,YAAAA,GAAG,CAACG,GAAJ,CAAQ;AAAEC,cAAAA,IAAI,EAAEP,iBAAiB,GAAGK;AAA5B,aAAR;AAHwB,6CAIjBF,GAJiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAZF,YAAY;AAAA;AAAA;AAAA,GAAlB;AAOP;;;;;;;;;AAKO,IAAMO,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG;AAAA;AAAA;AAAA;AAAA;AAAA,8CACnB;AACHC,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE,wEAFH;AAGHG,cAAAA,OAAO,EAAE,CACL;AAAEH,gBAAAA,IAAI,EAAE,KAAR;AAAeI,gBAAAA,IAAI,EAAE,mBAArB;AAA0CC,gBAAAA,KAAK,EAAE;AAAjD,eADK,EAEL;AAAEL,gBAAAA,IAAI,EAAE,KAAR;AAAeI,gBAAAA,IAAI,EAAE,kBAArB;AAAyCC,gBAAAA,KAAK,EAAE;AAAhD,eAFK;AAHN,aADmB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAdJ,cAAc;AAAA;AAAA;AAAA,GAApB;;;;AAWA,IAAMK,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,kBAAOC,MAAP,EAAeC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACA,uCAAgB;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA;AAAV,aAAhB,CADA;;AAAA;AACrBC,YAAAA,YADqB;;AAAA,iBAGvBA,YAAY,CAACC,KAHU;AAAA;AAAA;AAAA;;AAIjBC,YAAAA,EAJiB,GAIZF,YAAY,CAACC,KAAb,CAAmBE,UAJP;AAKjBC,YAAAA,GALiB,GAKXJ,YAAY,CAACC,KAAb,CAAmBI,cALR;;AAAA,kBAOnBH,EAAE,KAAK,iBAPY;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAQI,6CAAmBJ,MAAnB,EAA2BC,MAA3B,CARJ;;AAAA;AAQbO,YAAAA,QARa;AAAA;AAAA,mBASNC,cAAc,CAACT,MAAD,EAASC,MAAT,EAAiBO,QAAjB,CATR;;AAAA;AAAA;;AAAA;AAAA,kBAUZJ,EAAE,KAAK,UAVK;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAWNM,cAAc,CAACV,MAAD,EAASC,MAAT,CAXR;;AAAA;AAAA;;AAAA;AAAA,kBAYdG,EAAE,KAAK,kBAZO;AAAA;AAAA;AAAA;;AAabO,YAAAA,QAba,GAaF;AACbC,cAAAA,GAAG,EAAEV,YAAY,CAACC,KAAb,CAAmBU,YADX;AAEb,sBAAMX,YAAY,CAACC,KAAb,CAAmBW,aAFZ;AAGbC,cAAAA,GAAG,EAAEb,YAAY,CAACC,KAAb,CAAmBa;AAHX,aAbE;AAAA;AAAA,mBAkBNC,sBAAsB,CAACjB,MAAD,EAASC,MAAT,EAAiBU,QAAjB,CAlBhB;;AAAA;AAAA;;AAAA;AAAA,kBAmBZP,EAAE,KAAK,MAnBK;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAoBNc,aAAa,CAAClB,MAAD,EAASC,MAAT,CApBP;;AAAA;AAAA;;AAAA;AAAA,kBAqBdG,EAAE,KAAK,SArBO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAsBNe,aAAa,CAACnB,MAAD,EAASC,MAAT,CAtBP;;AAAA;AAAA;;AAAA;AAAA,kBAuBdG,EAAE,KAAK,UAvBO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAwBNgB,cAAc,CAACpB,MAAD,EAASC,MAAT,EAAiBK,GAAjB,CAxBR;;AAAA;AAAA;;AAAA;AAAA,kBAyBdF,EAAE,KAAK,UAzBO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBA0BNiB,cAAc,CAACrB,MAAD,EAASC,MAAT,CA1BR;;AAAA;AAAA;;AAAA;AAAA,kBA2BdG,EAAE,KAAK,OA3BO;AAAA;AAAA;AAAA;;AAAA,8CA4BZkB,UAAU,CAACtB,MAAD,EAASC,MAAT,EAAiB,CAAjB,CA5BE;;AAAA;AAAA,kBA6BdG,EAAE,KAAK,QA7BO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBA8BNmB,YAAY,CAACvB,MAAD,EAASC,MAAT,EAAiB,CAAjB,CA9BN;;AAAA;AAAA;;AAAA;AAAA,kBA+BdG,EAAE,KAAK,cA/BO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAgCNoB,iBAAiB,CAACxB,MAAD,EAASC,MAAT,CAhCX;;AAAA;AAAA;;AAAA;AAAA,kBAiCdG,EAAE,KAAK,sBAjCO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAkCNqB,gBAAgB,CAACzB,MAAD,EAASC,MAAT,CAlCV;;AAAA;AAAA;;AAAA;AAAA,kBAmCdG,EAAE,KAAK,eAnCO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAoCNsB,kBAAkB,CAAC1B,MAAD,EAASC,MAAT,CApCZ;;AAAA;AAAA;;AAAA;AAAA,kBAqCdG,EAAE,KAAK,UArCO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAsCNuB,eAAe,CAAC3B,MAAD,EAASC,MAAT,EAAiB,CAAjB,CAtCT;;AAAA;AAAA;;AAAA;AAAA,kBAuCdG,EAAE,KAAK,cAvCO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAwCNwB,iBAAiB,CAAC5B,MAAD,EAASC,MAAT,CAxCX;;AAAA;AAAA;;AAAA;AAAA,kBAyCdG,EAAE,KAAK,gBAzCO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBA0CNyB,mBAAmB,CAAC7B,MAAD,EAASC,MAAT,CA1Cb;;AAAA;AAAA;;AAAA;AAAA,kBA2CdG,EAAE,KAAK,UA3CO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBA4CN0B,cAAc,CAAC9B,MAAD,EAASC,MAAT,CA5CR;;AAAA;AAAA;;AAAA;AAAA,kBA6CdG,EAAE,KAAK,mBA7CO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBA8CN2B,aAAa,CAAC/B,MAAD,EAASC,MAAT,CA9CP;;AAAA;AAAA;;AAAA;AAAA,kBA+CdG,EAAE,KAAK,SA/CO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAgDN4B,mBAAmB,CAAChC,MAAD,EAASC,MAAT,CAhDb;;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAkDNgC,YAAY,EAlDN;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAoDVA,YAAY,EApDF;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAflC,eAAe;AAAA;AAAA;AAAA,GAArB;;;;AAuDA,IAAMmC,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG;AAAA;AAAA;AAAA;AAAA;AAAA,8CACrB;AACHvC,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE,kCAFH;AAGHG,cAAAA,OAAO,EAAE,CACL;AAAEH,gBAAAA,IAAI,EAAE,kBAAR;AAA4BI,gBAAAA,IAAI,EAAE,gBAAlC;AAAoDC,gBAAAA,KAAK,EAAE;AAA3D,eADK,EAEL;AAAEL,gBAAAA,IAAI,EAAE,oBAAR;AAA8BI,gBAAAA,IAAI,EAAE,iBAApC;AAAuDC,gBAAAA,KAAK,EAAE;AAA9D,eAFK;AAHN,aADqB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAhBoC,gBAAgB;AAAA;AAAA;AAAA,GAAtB;;;;AAWA,IAAMC,iBAAiB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,kBAAOnC,MAAP,EAAeC,MAAf,EAAuBmC,MAAvB,EAA+BC,IAA/B;AAAA;;AAAA;AAAA;AAAA;AAAA;AACzBC,YAAAA,IADyB,GAClB,8DADkB;AAE7BA,YAAAA,IAAI,IAAI,wEAAR;AACAA,YAAAA,IAAI,IAAI,yBAAR;;AAEA,gBAAIF,MAAM,KAAK,UAAf,EAA2B;AACvB,2DAAmBpC,MAAnB,EAA2BC,MAA3B,EAAmCoC,IAAnC;AACH;;AAP4B;AAAA;AAAA,mBASnB,4CAAsBrC,MAAtB,EAA8BC,MAA9B,EAAsCmC,MAAtC,CATmB;;AAAA;AAAA,8CAUlB;AAAEzC,cAAAA,IAAI,EAAE,MAAR;AAAgBF,cAAAA,IAAI,EAAE6C;AAAtB,aAVkB;;AAAA;AAAA;AAAA;AAYzB1D,YAAAA,OAAO,CAAC2D,KAAR;AAZyB,8CAalB;AAAE5C,cAAAA,IAAI,EAAE,MAAR;AAAgBF,cAAAA,IAAI,EAAE6C;AAAtB,aAbkB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAjBH,iBAAiB;AAAA;AAAA;AAAA,GAAvB;AAiBP;;;;;;;;;AAKO,IAAMK,kBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,kBAAOC,MAAP,EAAeC,MAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;AAC1BC,YAAAA,cAD0B,GACT,EADS;;AAAA,kBAE1BD,MAAM,IAAI,OAAOA,MAAP,KAAkB,QAFF;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAIpBA,MAAM,CAACE,KAAP,CAAa,YAAb,CAJoB;;AAAA;AAK1BD,YAAAA,cAAc,GAAGD,MAAM,CAACG,UAAxB;AAL0B;AAAA;;AAAA;AAMvB,gBAAIH,MAAM,IAAI,OAAOA,MAAP,KAAkB,QAAhC,EACHC,cAAc,GAAGD,MAAjB;;AAP0B;AAAA;AAAA,mBASX,qCAAeD,MAAf,CATW;;AAAA;AASxBK,YAAAA,IATwB;AAUxBC,YAAAA,QAVwB,GAUbD,IAAI,CAACE,iBAAL,CAAuBC,OAAvB,CAA+B,OAA/B,EAAwCN,cAAxC,CAVa;AAAA,8CAYvB;AAAEhD,cAAAA,IAAI,EAAE,MAAR;AAAgBF,cAAAA,IAAI,EAAEsD;AAAtB,aAZuB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAlBP,kBAAkB;AAAA;AAAA;AAAA,GAAxB;;;;AAeA,IAAMP,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG;AAAA;AAAA;AAAA;AAAA;AAAA,8CACjB;AACHtC,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE,kCAFH;AAGHG,cAAAA,OAAO,EAAE,CACL;AAAEH,gBAAAA,IAAI,EAAE,aAAR;AAAuBI,gBAAAA,IAAI,EAAE,kBAA7B;AAAiDC,gBAAAA,KAAK,EAAE;AAAxD,eADK,EAEL;AAAEL,gBAAAA,IAAI,EAAE,aAAR;AAAuBI,gBAAAA,IAAI,EAAE,iBAA7B;AAAgDC,gBAAAA,KAAK,EAAE;AAAvD,eAFK,EAGL;AAAEL,gBAAAA,IAAI,EAAE,iBAAR;AAA2BI,gBAAAA,IAAI,EAAE,gBAAjC;AAAmDC,gBAAAA,KAAK,EAAE;AAA1D,eAHK,EAIL;AAAEL,gBAAAA,IAAI,EAAE,uBAAR;AAAiCI,gBAAAA,IAAI,EAAE,iBAAvC;AAA0DC,gBAAAA,KAAK,EAAE;AAAjE,eAJK;AAHN,aADiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAZmC,YAAY;AAAA;AAAA;AAAA,GAAlB;;;;AAuBA,IAAMiB,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,kBAAOT,MAAP,EAAeL,MAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACkC,2CAAoBK,MAApB,CADlC;;AAAA;AAAA;AACfU,YAAAA,WADe,SACfA,WADe;AACFC,YAAAA,WADE,SACFA,WADE;AACWC,YAAAA,YADX,SACWA,YADX;AAGnBN,YAAAA,QAHmB,GAGR,EAHQ;;AAIvB,gBAAII,WAAW,KAAK,IAApB,EAA0B;AACtBJ,cAAAA,QAAQ,GAAG,wCAAwCK,WAAxC,GAAsD,iBAAtD,GAA0EC,YAA1E,GAAyF,SAApG;AACH,aAFD,MAEO;AACHN,cAAAA,QAAQ,GAAG,kGAAX;AACH;;AARsB,kBAUnBX,MAAM,IAAIA,MAAM,KAAK,UAVF;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAWCH,YAAY,EAXb;;AAAA;AAWbqB,YAAAA,KAXa;AAYnBA,YAAAA,KAAK,CAAC7D,IAAN,GAAasD,QAAQ,GAAG,MAAX,GAAoBO,KAAK,CAAC7D,IAAvC;AAZmB,8CAaZ6D,KAbY;;AAAA;AAAA,8CAeZ;AAAE3D,cAAAA,IAAI,EAAE,MAAR;AAAgBF,cAAAA,IAAI,EAAEsD;AAAtB,aAfY;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAXG,WAAW;AAAA;AAAA;AAAA,GAAjB;AAkBP;;;;;;;;AAIO,IAAMK,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,kBAAOd,MAAP,EAAe5C,IAAf,EAAqBuC,MAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACD,gCAAYK,MAAZ,EAAoB5C,IAAI,CAAC2D,EAAzB,CADC;;AAAA;AAClBT,YAAAA,QADkB;;AAAA,kBAGpBX,MAAM,IAAIA,MAAM,KAAK,UAHD;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAIAH,YAAY,EAJZ;;AAAA;AAIdqB,YAAAA,KAJc;AAKpBA,YAAAA,KAAK,CAAC7D,IAAN,GAAasD,QAAQ,GAAG,MAAX,GAAoBO,KAAK,CAAC7D,IAAvC;AALoB,8CAMb6D,KANa;;AAAA;AAAA,8CAQb;AAAE3D,cAAAA,IAAI,EAAE,MAAR;AAAgBF,cAAAA,IAAI,EAAEsD;AAAtB,aARa;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAZQ,YAAY;AAAA;AAAA;AAAA,GAAlB;AAYP;;;;;;;;;AAKO,IAAME,qBAAqB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOhB,MAAP,EAAeiB,UAAf,EAA2BC,MAA3B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEH,mCAAWlB,MAAX,CAFG;;AAAA;AAEvBmB,YAAAA,WAFuB;AAAA;AAAA,mBAGH,yCAAgBnB,MAAhB,CAHG;;AAAA;AAGvBoB,YAAAA,WAHuB;AAAA;AAAA,mBAIN,qCAAYpB,MAAZ,CAJM;;AAAA;AAIvBqB,YAAAA,QAJuB;AAKvBC,YAAAA,gBALuB,GAKJ,EALI;AAAA;AAAA;AAAA;AAAA;AAAA,wBAMVH,WANU;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAMpBI,YAAAA,MANoB;;AAAA,kBAOrBN,UAAU,IAAIM,MAAM,CAACC,UAAP,KAAsBP,UAPf;AAAA;AAAA;AAAA;;AAAA,iBAQjBC,MARiB;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,yBASCG,QATD;;AAAA;AAAA;AAAA;AAAA;AAAA;;AASRI,YAAAA,KATQ;;AAAA,kBAUTA,KAAK,CAACD,UAAN,KAAqBD,MAAM,CAACC,UAA5B,IAA0CC,KAAK,CAACC,MAAN,KAAiBR,MAVlD;AAAA;AAAA;AAAA;;AAWTK,YAAAA,MAAM,CAACE,KAAP,GAAeA,KAAK,CAACA,KAArB;AAXS;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA,iBAgBjBF,MAAM,CAACE,KAhBU;AAAA;AAAA;AAAA;;AAiBjBF,YAAAA,MAAM,CAACI,aAAP,GAAuB,EAAvB;AAjBiB;AAAA;AAAA;AAAA;AAAA,yBAkBDJ,MAAM,CAACK,QAlBN;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAkBRC,YAAAA,GAlBQ;AAAA;AAAA;AAAA;AAAA;;AAmBb,8BAAoBT,WAApB,2HAAiC;AAAxBU,cAAAA,OAAwB;;AAC7B,kBAAIA,OAAO,CAACf,EAAR,KAAec,GAAnB,EAAwB;AACpBN,gBAAAA,MAAM,CAACI,aAAP,CAAqBI,IAArB,CAA0BD,OAAO,CAACA,OAAlC;AACH;AACJ;;AAvBY;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAyBjBR,YAAAA,gBAAgB,CAACS,IAAjB,CAAsBR,MAAtB;;AAzBiB;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA,+CA6BtBD,gBA7BsB;;AAAA;AAAA;AAAA;AA+B7BnF,YAAAA,OAAO,CAAC2D,KAAR,CAAc;AAAEkC,cAAAA,qBAAqB;AAAvB,aAAd;;AA/B6B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAArBhB,qBAAqB;AAAA;AAAA;AAAA,GAA3B;AAoCP;;;;;;;AAGO,IAAMiB,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG;AAAA;AAAA;AAAA;AAAA;AAAA,+CACpB;AACH/E,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE,0EAFH;AAGHG,cAAAA,OAAO,EAAE,CACL;AAAEH,gBAAAA,IAAI,EAAE,KAAR;AAAeI,gBAAAA,IAAI,EAAE,eAArB;AAAsCC,gBAAAA,KAAK,EAAE;AAA7C,eADK,EAEL;AAAEL,gBAAAA,IAAI,EAAE,KAAR;AAAeI,gBAAAA,IAAI,EAAE,cAArB;AAAqCC,gBAAAA,KAAK,EAAE;AAA5C,eAFK;AAHN,aADoB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAf4E,eAAe;AAAA;AAAA;AAAA,GAArB;;;;AAsBA,IAAMvD,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOnB,MAAP,EAAeC,MAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACnB,mCAAY;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE;AAA9B,aAAZ,CADmB;;AAAA;AAAA;AAAA,mBAGD,oCAAaL,MAAb,CAHC;;AAAA;AAGnB2E,YAAAA,SAHmB;AAIrBrC,YAAAA,IAJqB,GAId,EAJc;;AAMzB,gBAAIqC,SAAS,CAACC,aAAd,EAA6B;AACzBtC,cAAAA,IAAI,qDAA+BqC,SAAS,CAACC,aAAzC,gBAAJ;AACH;;AARwB,kBASrBD,SAAS,CAACE,aAAV,IAA2BF,SAAS,CAACE,aAAV,CAAwBC,MAAxB,GAAiC,CATvC;AAAA;AAAA;AAAA;;AAUrBxC,YAAAA,IAAI,IAAI,mBAAR;AAVqB;AAAA;AAAA;AAAA;;AAWrB,8BAAqBqC,SAAS,CAACE,aAA/B,2HAA8C;AAArCE,cAAAA,QAAqC;AAC1CzC,cAAAA,IAAI,cAAO,6BAAiByC,QAAQ,CAACC,GAA1B,CAAP,sBAA8CD,QAAQ,CAACE,EAAvD,UAAJ;AACH;;AAboB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAcrB3C,YAAAA,IAAI,IAAI,IAAR;;AAdqB;AAgBzB,gBAAIqC,SAAS,CAACO,WAAd,EAA2B;AACvB5C,cAAAA,IAAI,sDAAgCqC,SAAS,CAACO,WAA1C,gBAAJ;AACH;;AAED5C,YAAAA,IAAI,IAAI,oDAAR;AApByB,+CAsBlB;AACH3C,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE6C,IAFH;AAGH1C,cAAAA,OAAO,EAAE,CACL;AACIH,gBAAAA,IAAI,EAAE,UADV;AAEII,gBAAAA,IAAI,EAAE;AAAEF,kBAAAA,IAAI,EAAE,UAAR;AAAoBwF,kBAAAA,IAAI,EAAER,SAAS,CAACC;AAApC,iBAFV;AAGI9E,gBAAAA,KAAK,EAAE;AAHX,eADK,EAML;AACIL,gBAAAA,IAAI,EAAE,SADV;AAEII,gBAAAA,IAAI,EAAE;AAAEF,kBAAAA,IAAI,EAAE,QAAR;AAAkBwF,kBAAAA,IAAI,EAAER,SAAS,CAACO,WAAlC;AAA+CE,kBAAAA,OAAO,EAAET,SAAS,CAACS;AAAlE,iBAFV;AAGItF,gBAAAA,KAAK,EAAE;AAHX,eANK;AAHN,aAtBkB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAbqB,aAAa;AAAA;AAAA;AAAA,GAAnB;;;;AAwCA,IAAMkE,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOrF,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB,EAA6BwC,IAA7B,EAAmCD,MAAnC;AAAA;;AAAA;AAAA;AAAA;AAAA;AACnBkD,YAAAA,MADmB,GACV,IADU;;AAEvB,gBAAIlD,MAAM,IAAIA,MAAM,KAAK,UAAzB,EAAqC;AACjCkD,cAAAA,MAAM,GAAG,iCAAqBrF,MAArB,CAAT;AACH;;AAJsB;AAAA,mBAMjB,mCAAY;AACdD,cAAAA,MAAM,EAANA,MADc;AACNC,cAAAA,MAAM,EAANA,MADM;AAEdsF,cAAAA,WAAW,EAAE1F,IAAI,CAACF,IAFJ;AAEU6F,cAAAA,WAAW,EAAE3F,IAAI,CAACsF,IAF5B;AAEkCM,cAAAA,YAAY,EAAE5F,IAAI,CAACuF,OAFrD;AAGd/C,cAAAA,IAAI,EAAEA,IAHQ;AAIdqD,cAAAA,KAAK,EAAEJ,MAJO;AAIClD,cAAAA,MAAM,EAAEA;AAJT,aAAZ,CANiB;;AAAA;AAcvB,gBAAIvC,IAAI,IAAIA,IAAI,CAACF,IAAL,KAAc,UAA1B,EACIgG,SAAS,GAAG,4BAAZ,CADJ,KAEK;AACDA,cAAAA,SAAS,GAAG,6BAAZ;AACA,kBAAI9F,IAAI,CAACuF,OAAT,EACIO,SAAS,IAAI,wBAAwB9F,IAAI,CAACuF,OAA1C;AACP;AApBsB,+CAsBhB;AACHzF,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE,OAAOkG;AAFV,aAtBgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAXN,WAAW;AAAA;AAAA;AAAA,GAAjB;;;;AA4BA,IAAMO,uBAAuB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO5F,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB,EAA6BwC,IAA7B,EAAmCD,MAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACViD,WAAW,CAACrF,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,EAAuBwC,IAAvB,EAA6BD,MAA7B,CADD;;AAAA;AAC7ByD,YAAAA,UAD6B;AAAA;AAAA,mBAERC,2BAA2B,CAAC9F,MAAD,EAASC,MAAT,EAAiBoC,IAAjB,EAAuBD,MAAvB,CAFnB;;AAAA;AAE7B2D,YAAAA,YAF6B;AAInCA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AAJmC,+CAK5BsG,YAL4B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAvBH,uBAAuB;AAAA;AAAA;AAAA,GAA7B;AASP;;;;;;;;AAIO,IAAMlF,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOV,MAAP,EAAeC,MAAf,EAAuBoC,IAAvB,EAA6BD,MAA7B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAEtBkD,YAAAA,MAFsB,GAEb,IAFa;;AAG1B,gBAAIlD,MAAM,IAAIA,MAAM,KAAK,UAAzB,EAAqC;AACjCkD,cAAAA,MAAM,GAAG,iCAAqBrF,MAArB,CAAT;AACH;;AALyB;AAAA,mBAOpB,mCAAY;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBoC,cAAAA,IAAI,EAAJA,IAAlB;AAAwBhC,cAAAA,UAAU,EAAE,UAApC;AAAgDqF,cAAAA,KAAK,EAAEJ,MAAvD;AAA+DlD,cAAAA,MAAM,EAAEA;AAAvE,aAAZ,CAPoB;;AAAA;AAAA,kBAStB,CAACA,MAAD,IAAWA,MAAM,KAAK,WATA;AAAA;AAAA;AAAA;;AAAA,+CAUf;AACHzC,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE,iGAFH;AAGHG,cAAAA,OAAO,EAAE,CACL;AAAEH,gBAAAA,IAAI,EAAE,aAAR;AAAuBuG,gBAAAA,UAAU,EAAE,IAAnC;AAAyCnG,gBAAAA,IAAI,EAAE,mBAA/C;AAAoEC,gBAAAA,KAAK,EAAE;AAA3E,eADK;AAHN,aAVe;;AAAA;AAAA,kBAiBfsC,MAAM,KAAK,UAjBI;AAAA;AAAA;AAAA;;AAAA,+CAkBf;AACHzC,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE,8EAFH;AAGHG,cAAAA,OAAO,EAAE,CACL;AAAEH,gBAAAA,IAAI,EAAE,aAAR;AAAuBI,gBAAAA,IAAI,EAAE,mBAA7B;AAAkDC,gBAAAA,KAAK,EAAE;AAAzD,eADK;AAHN,aAlBe;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAdY,cAAc;AAAA;AAAA;AAAA,GAApB;;;;AA6BA,IAAMO,sBAAsB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOjB,MAAP,EAAeC,MAAf,EAAuBU,QAAvB,EAAiC0B,IAAjC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,iBAC9B1B,QAD8B;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAExB,mCAAY;AAAEX,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBU,cAAAA,QAAQ,EAARA,QAAlB;AAA4B0B,cAAAA,IAAI,EAAJA,IAA5B;AAAkChC,cAAAA,UAAU,EAAE;AAA9C,aAAZ,CAFwB;;AAAA;AAAA;AAAA,mBAIN,6CAAmBM,QAAnB,CAJM;;AAAA;AAIxBsF,YAAAA,SAJwB;;AAAA,kBAM1BA,SAAS,IAAIA,SAAS,CAACnB,MAAvB,IAAiCmB,SAAS,CAACnB,MAAV,GAAmB,CAN1B;AAAA;AAAA;AAAA;;AAQtBoB,YAAAA,uBARsB,GAQI,KARJ;AASpBtG,YAAAA,OAToB,GASV,EATU;;AAU1B,iBAASuG,CAAT,GAAa,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AAClBC,cAAAA,OADkB,GACRH,SAAS,CAACE,CAAD,CADD;;AAExB,kBAAIC,OAAO,CAACC,kBAAR,IAA8BD,OAAO,CAACC,kBAAR,CAA2BvB,MAA3B,IAAqC,CAAvE,EAA0E;AACtEoB,gBAAAA,uBAAuB,GAAG,IAA1B;AACMI,gBAAAA,KAFgE,GAExD;AAAEC,kBAAAA,iBAAiB,EAAEH,OAAO,CAACG,iBAA7B;AAAgDF,kBAAAA,kBAAkB,EAAED,OAAO,CAACC;AAA5E,iBAFwD;AAGhEG,gBAAAA,MAHgE,GAGvD;AAAE/G,kBAAAA,IAAI,EAAE,OAAR;AAAiBI,kBAAAA,IAAI,EAAEyG,KAAvB;AAA8BxG,kBAAAA,KAAK,EAAE;AAArC,iBAHuD;AAIlE2G,gBAAAA,aAJkE,GAIlDN,CAAC,GAAG,CAJ8C;AAKtEvG,gBAAAA,OAAO,CAAC4E,IAAR,CAAa;AAAE/E,kBAAAA,IAAI,EAAE,cAAcgH,aAAtB;AAAqCC,kBAAAA,OAAO,EAAEN,OAAO,CAACG,iBAAtD;AAAyEI,kBAAAA,OAAO,EAAEH;AAAlF,iBAAb;AACH;AACJ;;AAnByB,iBAqBtBN,uBArBsB;AAAA;AAAA;AAAA;;AAsBhBU,YAAAA,UAtBgB,GAsBH;AAAE/G,cAAAA,IAAI,EAAE,mBAAR;AAA6BC,cAAAA,KAAK,EAAE;AAApC,aAtBG;AAuBtBF,YAAAA,OAAO,CAAC4E,IAAR,CAAa;AACT/E,cAAAA,IAAI,EAAE,sBADG;AAETiH,cAAAA,OAAO,EAAE,kDAFA;AAGTC,cAAAA,OAAO,EAAEC,UAHA;AAITC,cAAAA,aAAa,EAAE;AAJN,aAAb;AAvBsB,+CA6Bf;AACHlH,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE,iDAFH;AAGHG,cAAAA,OAAO,EAAEA;AAHN,aA7Be;;AAAA;AAAA;AAAA,mBAmCTkH,gBAAgB,CAAC9G,MAAD,EAASC,MAAT,CAnCP;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAsCb6G,gBAAgB,CAAC9G,MAAD,EAASC,MAAT,CAtCH;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAyCjB6G,gBAAgB,CAAC9G,MAAD,EAASC,MAAT,CAzCC;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAtBgB,sBAAsB;AAAA;AAAA;AAAA,GAA5B;;;;AA6CA,IAAM6E,2BAA2B;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO9F,MAAP,EAAeC,MAAf,EAAuBoC,IAAvB,EAA6BD,MAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAIhB,6CAAmBpC,MAAnB,EAA2BC,MAA3B,CAJgB;;AAAA;AAIjCO,YAAAA,QAJiC;;AAAA,iBAMnCA,QANmC;AAAA;AAAA;AAAA;;AAAA,+CAO5BC,cAAc,CAACT,MAAD,EAASC,MAAT,EAAiBO,QAAjB,EAA2B6B,IAA3B,EAAiCD,MAAjC,CAPc;;AAAA;AAAA;AAAA,mBAStB1B,cAAc,CAACV,MAAD,EAASC,MAAT,EAAiBoC,IAAjB,EAAuBD,MAAvB,CATQ;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAA3B0D,2BAA2B;AAAA;AAAA;AAAA,GAAjC;;;;AAaA,IAAMgB,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOrE,MAAP,EAAesE,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACtB,mCAAY;AAAE/G,cAAAA,MAAM,EAAEyC,MAAV;AAAkBxC,cAAAA,MAAM,EAAE8G,MAA1B;AAAkCC,cAAAA,iBAAiB,EAAE,IAArD;AAA2D3G,cAAAA,UAAU,EAAE;AAAvE,aAAZ,CADsB;;AAAA;AAAA,+CAGrB;AACHV,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE;AAFH,aAHqB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAhBqH,gBAAgB;AAAA;AAAA;AAAA,GAAtB;;;;AASA,IAAMrG,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOT,MAAP,EAAeC,MAAf,EAAuBO,QAAvB,EAAiC6B,IAAjC,EAAuCD,MAAvC;AAAA;;AAAA;AAAA;AAAA;AAAA;AACtBkD,YAAAA,MADsB,GACb,IADa;;AAE1B,gBAAIlD,MAAM,IAAIA,MAAM,KAAK,UAAzB,EAAqC;AACjCkD,cAAAA,MAAM,GAAG,iCAAqBrF,MAArB,CAAT;AACH;;AAJyB,iBAMtBoC,IANsB;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAOhB,mCAAY;AACdrC,cAAAA,MAAM,EAANA,MADc;AACNC,cAAAA,MAAM,EAANA,MADM;AACEoC,cAAAA,IAAI,EAAJA,IADF;AACQ2E,cAAAA,iBAAiB,EAAE,KAD3B;AAEd3G,cAAAA,UAAU,EAAE,iBAFE;AAEiBqF,cAAAA,KAAK,EAAEJ;AAFxB,aAAZ,CAPgB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAYhB,mCAAY;AACdtF,cAAAA,MAAM,EAANA,MADc;AACNC,cAAAA,MAAM,EAANA,MADM;AACE+G,cAAAA,iBAAiB,EAAE,KADrB;AAEd3G,cAAAA,UAAU,EAAE,iBAFE;AAEiBqF,cAAAA,KAAK,EAAEJ;AAFxB,aAAZ,CAZgB;;AAAA;AAiBtB2B,YAAAA,UAjBsB,GAiBT,sCAjBS;AAkB1BA,YAAAA,UAAU,GAAGA,UAAU,GAAGzG,QAAQ,CAAC0G,gBAAnC;AAlB0B,+CAoBnB;AACHvH,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAEwH,UAFH;AAGHrH,cAAAA,OAAO,EAAE,CACL;AAAEH,gBAAAA,IAAI,EAAE,KAAR;AAAeI,gBAAAA,IAAI,EAAEW,QAArB;AAA+BV,gBAAAA,KAAK,EAAE;AAAtC,eADK,EAEL;AAAEL,gBAAAA,IAAI,EAAE,KAAR;AAAeI,gBAAAA,IAAI,EAAEW,QAArB;AAA+BV,gBAAAA,KAAK,EAAE;AAAtC,eAFK;AAHN,aApBmB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAdW,cAAc;AAAA;AAAA;AAAA,GAApB;;;;AA8BA,IAAM0G,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOnH,MAAP,EAAeC,MAAf,EAAuBO,QAAvB,EAAiC4B,MAAjC;AAAA;;AAAA;AAAA;AAAA;AAAA;AACnBkD,YAAAA,MADmB,GACV,IADU;;AAEvB,gBAAIlD,MAAM,IAAIA,MAAM,KAAK,UAAzB,EAAqC;AACjCkD,cAAAA,MAAM,GAAG,iCAAqBrF,MAArB,CAAT;AACH;;AAJsB,kBAMnBO,QAAQ,IAAIA,QAAQ,CAAC6F,kBANF;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAOa,yCAAe7F,QAAf,CAPb;;AAAA;AAOb4G,YAAAA,iBAPa;AAAA;AAAA,mBAQb,mCAAY;AAAEpH,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBO,cAAAA,QAAQ,EAAE4G,iBAA5B;AAA+C1B,cAAAA,KAAK,EAAEJ;AAAtD,aAAZ,CARa;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAUb,mCAAY;AAAEtF,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBO,cAAAA,QAAQ,EAARA,QAAlB;AAA4BkF,cAAAA,KAAK,EAAEJ;AAAnC,aAAZ,CAVa;;AAAA;AAAA,+CAahB;AACH3F,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE;AAFH,aAbgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAX0H,WAAW;AAAA;AAAA;AAAA,GAAjB;;;;AAoBA,IAAME,sBAAsB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOrH,MAAP,EAAeC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACjB,uCAAgB;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBqH,cAAAA,UAAU,EAAE;AAA9B,aAAhB,CADiB;;AAAA;AAC5BC,YAAAA,EAD4B;;AAAA,kBAG9BA,EAAE,CAACpH,KAAH,IAAYoH,EAAE,CAACpH,KAAH,CAASE,UAAT,KAAwB,sBAHN;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAIjB2B,mBAAmB,CAAChC,MAAD,EAASC,MAAT,CAJF;;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAMjBuH,WAAW,CAACxH,MAAD,EAASC,MAAT,CANM;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAtBoH,sBAAsB;AAAA;AAAA;AAAA,GAA5B;;;;AASA,IAAMG,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOxH,MAAP,EAAeC,MAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACjB,mCAAY;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE;AAA9B,aAAZ,CADiB;;AAAA;AAGjBiC,YAAAA,IAHiB,GAGV,sIAHU;AAKjBmF,YAAAA,QALiB,GAKN,EALM;;AAMvBA,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAE,UAAR;AAAoBiI,cAAAA,aAAa,EAAE,IAAnC;AAAyC7H,cAAAA,IAAI,EAAE,cAA/C;AAA+DC,cAAAA,KAAK,EAAE;AAAtE,aAAd;;AACA2H,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAE,oBAAR;AAA8BI,cAAAA,IAAI,EAAE,cAApC;AAAoDC,cAAAA,KAAK,EAAE;AAA3D,aAAd;;AAPuB,+CAShB;AACHH,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE6C,IAFH;AAGH1C,cAAAA,OAAO,EAAE6H;AAHN,aATgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAXD,WAAW;AAAA;AAAA;AAAA,GAAjB;;;;AAgBA,IAAMG,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO3H,MAAP,EAAeC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEpB,mCAAY;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE;AAA9B,aAAZ,CAFoB;;AAAA;AAIpBhB,YAAAA,GAJoB,GAId,IAAIC,8BAAJ,EAJc;AAK1BD,YAAAA,GAAG,CAACG,GAAJ,CAAQ;AAAEC,cAAAA,IAAI,EAAE;AAAR,aAAR;AAL0B,+CAMnBJ,GANmB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAdsI,cAAc;AAAA;AAAA;AAAA,GAApB;;;;AASA,IAAMC,iBAAiB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO5H,MAAP,EAAeC,MAAf,EAAuByF,KAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AACvBrG,YAAAA,GADuB,GACjB,IAAIC,8BAAJ,EADiB;AAAA;AAAA,mBAGvB,mCAAY;AAAEU,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE;AAA9B,aAAZ,CAHuB;;AAAA;AAKzBiC,YAAAA,IALyB,GAKlB,gBAAgBoD,KAAhB,GAAwB,eALN;AAM7BrG,YAAAA,GAAG,CAACG,GAAJ,CAAQ;AAAEC,cAAAA,IAAI,EAAE6C;AAAR,aAAR;AAEMuF,YAAAA,OARuB,GAQb,IAAIC,kCAAJ,EARa;AAS7BD,YAAAA,OAAO,CAACrI,GAAR,CAAY;AAAEC,cAAAA,IAAI,EAAE,KAAR;AAAeI,cAAAA,IAAI,EAAE6F,KAArB;AAA4B5F,cAAAA,KAAK,EAAE;AAAnC,aAAZ;AACA+H,YAAAA,OAAO,CAACrI,GAAR,CAAY;AAAEC,cAAAA,IAAI,EAAE,iBAAR;AAA2BI,cAAAA,IAAI,EAAE,cAAjC;AAAiDC,cAAAA,KAAK,EAAE;AAAxD,aAAZ;AACAT,YAAAA,GAAG,CAAC0I,eAAJ,CAAoBF,OAApB;AAX6B,+CAatBxI,GAbsB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAjBuI,iBAAiB;AAAA;AAAA;AAAA,GAAvB;;;;AAiBA,IAAMI,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOhI,MAAP,EAAeC,MAAf,EAAuByF,KAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACf,mCAAY;AAAE1F,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkByF,cAAAA,KAAK,EAALA,KAAlB;AAAyBrF,cAAAA,UAAU,EAAE;AAArC,aAAZ,CADe;;AAAA;AAGfhB,YAAAA,GAHe,GAGT,IAAIC,8BAAJ,EAHS;AAIrBD,YAAAA,GAAG,CAACG,GAAJ,CAAQ;AAAEC,cAAAA,IAAI,EAAE,uBAAuBiG,KAAvB,GAA+B;AAAvC,aAAR;AAJqB,+CAKdrG,GALc;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAT2I,SAAS;AAAA;AAAA;AAAA,GAAf;;;;AAQA,IAAMC,yBAAyB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOjI,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB,EAA6BwC,IAA7B,EAAmCD,MAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACZiD,WAAW,CAACrF,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,EAAuBwC,IAAvB,EAA6BD,MAA7B,CADC;;AAAA;AAC/ByD,YAAAA,UAD+B;AAAA;AAAA,mBAEVxE,cAAc,CAACrB,MAAD,EAASC,MAAT,CAFJ;;AAAA;AAE/B8F,YAAAA,YAF+B;AAIrCA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AAJqC,+CAK9BsG,YAL8B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAzBkC,yBAAyB;AAAA;AAAA;AAAA,GAA/B;AASP;;;;;;;;;;;;AAQO,IAAMC,yBAAyB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOlI,MAAP,EAAeC,MAAf,EAAuBO,QAAvB,EAAiC4B,MAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACZ+E,WAAW,CAACnH,MAAD,EAASC,MAAT,EAAiBO,QAAjB,EAA2B4B,MAA3B,CADC;;AAAA;AAC/ByD,YAAAA,UAD+B;AAAA;AAAA,mBAOpB,uCAAgB;AAAE7F,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBqH,cAAAA,UAAU,EAAE;AAA9B,aAAhB,CAPoB;;AAAA;AAO/BC,YAAAA,EAP+B;;AAAA,kBAQjCA,EAAE,IAAIA,EAAE,CAACpH,KAAT,IAAkBoH,EAAE,CAACpH,KAAH,CAASgI,kBARM;AAAA;AAAA;AAAA;;AAAA,kBAS7BZ,EAAE,CAACpH,KAAH,CAASgI,kBAAT,KAAgC,mBATH;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAURpG,aAAa,CAAC/B,MAAD,EAASC,MAAT,CAVL;;AAAA;AAU7B8F,YAAAA,YAV6B;AAAA;AAAA;;AAAA;AAAA,kBAWtBwB,EAAE,CAACpH,KAAH,CAASgI,kBAAT,KAAgC,sBAXV;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAYRnG,mBAAmB,CAAChC,MAAD,EAASC,MAAT,CAZX;;AAAA;AAY7B8F,YAAAA,YAZ6B;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAcR1E,cAAc,CAACrB,MAAD,EAASC,MAAT,CAdN;;AAAA;AAc7B8F,YAAAA,YAd6B;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAiBZ1E,cAAc,CAACrB,MAAD,EAASC,MAAT,CAjBF;;AAAA;AAiBjC8F,YAAAA,YAjBiC;;AAAA;AAoBrCA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AApBqC,+CAqB9BsG,YArB8B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAzBmC,yBAAyB;AAAA;AAAA;AAAA,GAA/B;;;;AAwBA,IAAM7G,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOrB,MAAP,EAAeC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACpB,mCAAY;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE;AAA9B,aAAZ,CADoB;;AAAA;AAAA,+CAGnB;AACHV,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE,2BAFH;AAGHG,cAAAA,OAAO,EAAE,CACL;AAAEH,gBAAAA,IAAI,EAAE,GAAR;AAAa2I,gBAAAA,SAAS,EAAE,KAAxB;AAA+BvI,gBAAAA,IAAI,EAAE,OAArC;AAA8CC,gBAAAA,KAAK,EAAE;AAArD,eADK,EAEL;AAAEL,gBAAAA,IAAI,EAAE,GAAR;AAAa2I,gBAAAA,SAAS,EAAE,MAAxB;AAAgCvI,gBAAAA,IAAI,EAAE,OAAtC;AAA+CC,gBAAAA,KAAK,EAAE;AAAtD,eAFK,EAGL;AAAEL,gBAAAA,IAAI,EAAE,GAAR;AAAa2I,gBAAAA,SAAS,EAAE,MAAxB;AAAgCvI,gBAAAA,IAAI,EAAE,OAAtC;AAA+CC,gBAAAA,KAAK,EAAE;AAAtD,eAHK,EAIL;AAAEL,gBAAAA,IAAI,EAAE,QAAR;AAAkBI,gBAAAA,IAAI,EAAE,UAAxB;AAAoCC,gBAAAA,KAAK,EAAE;AAA3C,eAJK;AAHN,aAHmB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAduB,cAAc;AAAA;AAAA;AAAA,GAApB;;;;AAeA,IAAMgH,kBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOrI,MAAP,EAAeC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACxB,mCAAY;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE;AAA9B,aAAZ,CADwB;;AAAA;AAAA,+CAGvB;AACHV,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE,2BAFH;AAGHG,cAAAA,OAAO,EAAE,CACL;AAAEH,gBAAAA,IAAI,EAAE,QAAR;AAAkBI,gBAAAA,IAAI,EAAE,UAAxB;AAAoCC,gBAAAA,KAAK,EAAE;AAA3C,eADK,EAEL;AAAEL,gBAAAA,IAAI,EAAE,GAAR;AAAa2I,gBAAAA,SAAS,EAAE,QAAxB;AAAkCvI,gBAAAA,IAAI,EAAE,OAAxC;AAAiDC,gBAAAA,KAAK,EAAE;AAAxD,eAFK,EAGL;AAAEL,gBAAAA,IAAI,EAAE,GAAR;AAAa2I,gBAAAA,SAAS,EAAE,OAAxB;AAAiCvI,gBAAAA,IAAI,EAAE,OAAvC;AAAgDC,gBAAAA,KAAK,EAAE;AAAvD,eAHK,EAIL;AAAEL,gBAAAA,IAAI,EAAE,GAAR;AAAa2I,gBAAAA,SAAS,EAAE,MAAxB;AAAgCvI,gBAAAA,IAAI,EAAE,OAAtC;AAA+CC,gBAAAA,KAAK,EAAE;AAAtD,eAJK;AAHN,aAHuB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAlBuI,kBAAkB;AAAA;AAAA;AAAA,GAAxB;;;;AAeA,IAAMC,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOtI,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AACxB;AACM0I,YAAAA,GAFkB,GAEZ1I,IAAI,CAAC2I,MAAL,CAAY3I,IAAI,CAACiF,MAAL,GAAc,CAA1B,EAA6B,CAA7B,CAFY;AAAA;AAAA,mBAIlB,mCAAY;AAAE9E,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBsI,cAAAA,GAAG,EAAHA,GAAlB;AAAuBlI,cAAAA,UAAU,EAAE,MAAnC;AAA2CoI,cAAAA,IAAI,EAAE,UAAjD;AAA6DC,cAAAA,WAAW,EAAE;AAA1E,aAAZ,CAJkB;;AAAA;AAOxB,gBAAIH,GAAG,IAAI,CAAX,EAAc;AACVlJ,cAAAA,GAAG,GAAG;AACFM,gBAAAA,IAAI,EAAE,MADJ;AAEFF,gBAAAA,IAAI,EAAE,OAAO;AAFX,eAAN;AAIH,aALD,MAKO;AACHJ,cAAAA,GAAG,GAAG;AACFM,gBAAAA,IAAI,EAAE,MADJ;AAEFF,gBAAAA,IAAI,EAAE,OAAO8I,GAAP,GAAa;AAFjB,eAAN;AAIH,aAjBuB,CAmBxB;;;AAnBwB,+CAqBjBlJ,GArBiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAZiJ,YAAY;AAAA;AAAA;AAAA,GAAlB;;;;AAwBA,IAAMK,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO3I,MAAP,EAAeC,MAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEL,uCAAgB;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBqH,cAAAA,UAAU,EAAE;AAA9B,aAAhB,CAFK;;AAAA;AAEhBC,YAAAA,EAFgB;;AAAA,iBAIlBA,EAAE,CAACpH,KAJe;AAAA;AAAA;AAAA;;AAKdyI,YAAAA,KALc,GAKN,EALM;;AAMlB,gBAAIrB,EAAE,CAACpH,KAAH,CAASoI,GAAT,KAAiB,CAArB,EAAwB;AACpBK,cAAAA,KAAK,GAAG,0BAAR;AACH,aAFD,MAEO;AACHA,cAAAA,KAAK,GAAG,oCAAoCrB,EAAE,CAACpH,KAAH,CAASuI,WAA7C,GAA2D,aAAnE;AACAE,cAAAA,KAAK,GAAGA,KAAK,GAAG,sBAAhB;AACH;;AAEKnB,YAAAA,QAbY,GAaD,EAbC;AAAA;AAAA,mBAca,0CAAiBzH,MAAjB,CAdb;;AAAA;AAcZ6I,YAAAA,gBAdY;AAAA;AAAA,mBAeE,+BAAS7I,MAAT,EAAiB6I,gBAAjB,CAfF;;AAAA;AAeZC,YAAAA,KAfY;;AAgBlB,iBAAS3C,CAAT,GAAa,CAAb,EAAgBA,CAAC,GAAG2C,KAAK,CAAChE,MAA1B,EAAkCqB,CAAC,EAAnC,EAAuC;AAC7BG,cAAAA,KAD6B,GACrB;AAAE9C,gBAAAA,EAAE,EAAEsF,KAAK,CAAC3C,CAAD,CAAL,CAAS3C,EAAf;AAAmBuF,gBAAAA,IAAI,EAAED,KAAK,CAAC3C,CAAD,CAAL,CAAS4C,IAAlC;AAAwCC,gBAAAA,KAAK,EAAEF,KAAK,CAAC3C,CAAD,CAAL,CAAS6C;AAAxD,eADqB;;AAEnCvB,cAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,gBAAAA,IAAI,EAAEqJ,KAAK,CAAC3C,CAAD,CAAL,CAAS4C,IAAjB;AAAuBlJ,gBAAAA,IAAI,EAAEyG,KAA7B;AAAoCxG,gBAAAA,KAAK,EAAE;AAA3C,eAAd;AACH;;AAEKT,YAAAA,GArBY,GAqBN;AACRM,cAAAA,IAAI,EAAE,SADE;AAERF,cAAAA,IAAI,EAAEmJ,KAFE;AAGRhJ,cAAAA,OAAO,EAAE6H;AAHD,aArBM;;AAAA,kBA0BdF,EAAE,CAACpH,KAAH,CAASoI,GAAT,KAAiB,CA1BH;AAAA;AAAA;AAAA;;AAAA;AAAA,mBA2BR,mCAAY;AAAEvI,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE;AAA9B,aAAZ,CA3BQ;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBA6BR,mCAAY;AACdL,cAAAA,MAAM,EAANA,MADc;AACNC,cAAAA,MAAM,EAANA,MADM;AACEI,cAAAA,UAAU,EAAE,MADd;AAEd4I,cAAAA,SAAS,EAAE1B,EAAE,CAACpH,KAAH,CAAS8I,SAFN;AAEiBP,cAAAA,WAAW,EAAEnB,EAAE,CAACpH,KAAH,CAASuI,WAFvC;AAEoDQ,cAAAA,UAAU,EAAE;AAFhE,aAAZ,CA7BQ;;AAAA;AAAA,+CAkCX7J,GAlCW;;AAAA;AAoCZA,YAAAA,IApCY,GAoCN;AACRM,cAAAA,IAAI,EAAE,MADE;AAERF,cAAAA,IAAI,EAAEP;AAFE,aApCM;AAAA,+CAwCXG,IAxCW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAVsJ,UAAU;AAAA;AAAA;AAAA,GAAhB;AA4CP;;;;;;;;;;;AAOO,IAAMQ,sBAAsB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOnJ,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACTyI,YAAY,CAACtI,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,CADH;;AAAA;AAC5BgG,YAAAA,UAD4B;AAAA;AAAA,mBAEP8C,UAAU,CAAC3I,MAAD,EAASC,MAAT,CAFH;;AAAA;AAE5B8F,YAAAA,YAF4B;AAIlCA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AAJkC,+CAK3BsG,YAL2B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAtBoD,sBAAsB;AAAA;AAAA;AAAA,GAA5B;;;;AASA,IAAMC,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOpJ,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA,kBAChBA,IAAI,IAAIA,IAAI,CAACmJ,KAAb,IAAsBnJ,IAAI,CAACmJ,KAAL,GAAa,CADnB;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAEV,mCAAY;AAAEhJ,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBkE,cAAAA,MAAM,EAAEtE,IAAI,CAAC2D,EAA/B;AAAmCiF,cAAAA,IAAI,EAAE,MAAzC;AAAiDpI,cAAAA,UAAU,EAAE;AAA7D,aAAZ,CAFU;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAIV,mCAAY;AAAEL,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBkE,cAAAA,MAAM,EAAEtE,IAAI,CAAC2D,EAA/B;AAAmCiF,cAAAA,IAAI,EAAE,MAAzC;AAAiDpI,cAAAA,UAAU,EAAE;AAA7D,aAAZ,CAJU;;AAAA;AAAA,+CAMb;AACHV,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE,OAAO,YAAP,GAAsBI,IAAI,CAACkJ,IAF9B,CAEoC;;AAFpC,aANa;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAARK,QAAQ;AAAA;AAAA;AAAA,GAAd;AAYP;;;;;;;;;;AAMO,IAAM9H,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOtB,MAAP,EAAeC,MAAf,EAAuBoJ,QAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACK,uCAAgB;AAAErJ,cAAAA,MAAM,EAAEA,MAAV;AAAkBC,cAAAA,MAAM,EAAEA,MAA1B;AAAkCqH,cAAAA,UAAU,EAAE;AAA9C,aAAhB,CADL;;AAAA;AAChBpH,YAAAA,YADgB;;AAAA,iBAElBA,YAAY,CAACC,KAFK;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAGQ,8BAAQH,MAAR,EAAgBE,YAAY,CAACC,KAAb,CAAmBmJ,eAAnC,CAHR;;AAAA;AAGZC,YAAAA,WAHY;;AAAA,kBAKdA,WAAW,CAACP,KAAZ,IAAqBO,WAAW,CAACP,KAAZ,GAAoB,CAL3B;AAAA;AAAA;AAAA;;AAMV1G,YAAAA,IANU,GAMH,aAAaiH,WAAW,CAACR,IAAzB,GAAgC,wBAAhC,GAA2DQ,WAAW,CAACP,KAAvE,GAA+E,aAN5E;AAOd1G,YAAAA,IAAI,GAAGA,IAAI,GAAG,oCAAd;AAEMmF,YAAAA,QATQ,GASG,EATH;;AAUd,iBAAStB,CAAT,GAAa,CAAb,EAAgBA,CAAC,IAAIoD,WAAW,CAACP,KAAjC,EAAwC7C,CAAC,EAAzC,EAA6C;AACrCc,cAAAA,UADqC,GACxBd,CAAC,KAAK,CAAN,GAAUA,CAAC,GAAG,QAAd,GAAyBA,CAAC,GAAG,UADL;;AAEzCsB,cAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,gBAAAA,IAAI,EAAEwH,UAAR;AAAoBpH,gBAAAA,IAAI,EAAEsG,CAA1B;AAA6BrG,gBAAAA,KAAK,EAAE;AAApC,eAAd;AACH;;AAba,+CAeP;AACHH,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE6C,IAFH;AAGH1C,cAAAA,OAAO,EAAE6H;AAHN,aAfO;;AAAA;AAAA;AAAA,mBAqBD+B,qBAAqB,CAACxJ,MAAD,EAASC,MAAT,EAAiBoJ,QAAjB,CArBpB;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAV/H,UAAU;AAAA;AAAA;AAAA,GAAhB;;;;AA0BA,IAAMmI,kBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOzJ,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB,EAA6BwJ,QAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACLD,QAAQ,CAACpJ,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,CADH;;AAAA;AACxBgG,YAAAA,UADwB;AAAA;AAAA,mBAEHvE,UAAU,CAACtB,MAAD,EAASC,MAAT,EAAiBoJ,QAAjB,CAFP;;AAAA;AAExBtD,YAAAA,YAFwB;AAI9BA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AAJ8B,+CAKvBsG,YALuB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAlB0D,kBAAkB;AAAA;AAAA;AAAA,GAAxB;AAQP;;;;;;;;;;AAMO,IAAMC,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO1J,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACf,mCAAY;AACdG,cAAAA,MAAM,EAANA,MADc;AACNC,cAAAA,MAAM,EAANA,MADM;AAEdkE,cAAAA,MAAM,EAAEtE,IAAI,CAAC2D,EAFC;AAGdnD,cAAAA,UAAU,EAAE,QAHE;AAIdsJ,cAAAA,aAAa,EAAE9J;AAJD,aAAZ,CADe;;AAAA;AAQjB+J,YAAAA,UARiB,GAQJ/J,IAAI,KAAK,CAAT,GAAa,OAAb,GAAuB,SARnB;AAAA,+CAUd;AACHF,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE,OAAOI,IAAP,GAAc,GAAd,GAAoB+J;AAFvB,aAVc;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAATF,SAAS;AAAA;AAAA;AAAA,GAAf;;;;AAiBA,IAAMF,qBAAqB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOxJ,MAAP,EAAeC,MAAf,EAAuBoJ,QAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAChB,uCAAgB;AAAErJ,cAAAA,MAAM,EAAEA,MAAV;AAAkBC,cAAAA,MAAM,EAAEA,MAA1B;AAAkCqH,cAAAA,UAAU,EAAE;AAA9C,aAAhB,CADgB;;AAAA;AAC3BC,YAAAA,EAD2B;;AAAA,iBAG7BA,EAAE,CAACpH,KAH0B;AAAA;AAAA;AAAA;;AAAA,kBAIzBoH,EAAE,CAACpH,KAAH,CAASwJ,aAAT,GAAyB,CAAzB,IACApC,EAAE,CAACpH,KAAH,CAASwJ,aAAT,IAA0BpC,EAAE,CAACpH,KAAH,CAAS0J,gBALV;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAMZtI,YAAY,CAACvB,MAAD,EAASC,MAAT,EAAiBoJ,QAAjB,EAA2B9B,EAA3B,CANA;;AAAA;AAAA;;AAAA;AAAA,kBAQrBA,EAAE,CAACuC,KAAH,IAAYvC,EAAE,CAACuC,KAAH,CAAShF,MARA;AAAA;AAAA;AAAA;;AASZqB,YAAAA,CATY,GASR,CATQ;;AAAA;AAAA,kBASLA,CAAC,GAAGoB,EAAE,CAACuC,KAAH,CAAShF,MATR;AAAA;AAAA;AAAA;;AAAA,kBAUbyC,EAAE,CAACuC,KAAH,CAAS3D,CAAT,EAAY4D,MAAZ,KAAuB,CAAvB,IAA4BxC,EAAE,CAACuC,KAAH,CAAS3D,CAAT,EAAY6D,QAAZ,GAAuB,CAVtC;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAWP,+CAAyBzC,EAAE,CAACuC,KAAH,CAAS3D,CAAT,EAAY8D,GAArC,EAA0C,CAA1C,CAXO;;AAAA;AAAA;AAAA,mBAYAjI,mBAAmB,CAAChC,MAAD,EAASC,MAAT,CAZnB;;AAAA;AAAA;;AAAA;AASgBkG,YAAAA,CAAC,EATjB;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAeR5E,YAAY,CAACvB,MAAD,EAASC,MAAT,EAAiBoJ,QAAjB,EAA2B9B,EAA3B,CAfJ;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAArBiC,qBAAqB;AAAA;AAAA;AAAA,GAA3B;;;;AAqBA,IAAMU,oBAAoB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOlK,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACP6J,SAAS,CAAC1J,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,CADF;;AAAA;AAC1BgG,YAAAA,UAD0B;AAAA;AAAA,mBAILtE,YAAY,CAACvB,MAAD,EAASC,MAAT,EAAiB,CAAjB,CAJP;;AAAA;AAI1B8F,YAAAA,YAJ0B;AAMhCA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AANgC,+CAOzBsG,YAPyB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAApBmE,oBAAoB;AAAA;AAAA;AAAA,GAA1B;AAWP;;;;;;;;;;AAMO,IAAM3I,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOvB,MAAP,EAAeC,MAAf,EAAuBoJ,QAAvB,EAAiCnJ,YAAjC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAEpBqH,YAAAA,EAFoB,GAEf,IAFe;;AAAA,kBAGpBrH,YAAY,IAAIA,YAAY,CAACC,KAHT;AAAA;AAAA;AAAA;;AAIpBoH,YAAAA,EAAE,GAAGrH,YAAL;AAJoB;AAAA;;AAAA;AAAA;AAAA,mBAKR,uCAAgB;AAAEF,cAAAA,MAAM,EAAEA,MAAV;AAAkBC,cAAAA,MAAM,EAAEA,MAA1B;AAAkCqH,cAAAA,UAAU,EAAE;AAA9C,aAAhB,CALQ;;AAAA;AAKnBC,YAAAA,EALmB;;AAAA;AAAA;AAAA,mBAOG9D,qBAAqB,CAACzD,MAAD,EAASuH,EAAE,CAACpH,KAAH,CAASgK,mBAAlB,EAAuC5C,EAAE,CAACpH,KAAH,CAASmJ,eAAhD,CAPxB;;AAAA;AAOlBc,YAAAA,YAPkB;AASxB;AACA;AACIC,YAAAA,gBAXoB,GAWD9C,EAAE,CAACpH,KAAH,CAASwJ,aAXR,EAaxB;AACA;AACA;;AAEA,gBAAIpC,EAAE,CAACpH,KAAH,CAASwJ,aAAT,GAAyB,CAA7B,EAAgC;AAC5B,kBAAI,CAACpC,EAAE,CAACpH,KAAH,CAAS0J,gBAAd,EAAgC;AAC5BS,gBAAAA,YAAY,GAAG,CAAf;AACH,eAFD,MAEO;AACHA,gBAAAA,YAAY,GAAG/C,EAAE,CAACpH,KAAH,CAAS0J,gBAAxB;AACH;AACJ,aAvBuB,CAyBxB;;;AACIvH,YAAAA,IA1BoB,GA0Bb,oBA1Ba;;AA2BxB,gBAAIgI,YAAJ,EAAkB;AACd;AACAhI,cAAAA,IAAI,uBAAgBgI,YAAhB,cAAJ;AACH;;AAEKC,YAAAA,eAhCkB,GAgCA,EAhCA;AAkCpBC,YAAAA,SAlCoB,GAkCR,CAACnB,QAAQ,GAAG,CAAZ,IAAiBkB,eAlCT;AAmCpBE,YAAAA,SAnCoB,GAmCRpB,QAAQ,GAAGkB,eAnCH;AAqClB9C,YAAAA,QArCkB,GAqCP,EArCO;;AAuCxB,iBAAStB,CAAT,GAAa,CAAb,EAAgBA,CAAC,GAAGiE,YAAY,CAACtF,MAAjC,EAAyCqB,CAAC,EAA1C,EAA8C;AAC1C,kBAAIiE,YAAY,CAACjE,CAAD,CAAhB,EAAqB;AACXuE,gBAAAA,GADW,GACLN,YAAY,CAACjE,CAAD,CADP;AAEXG,gBAAAA,KAFW,GAEH;AAAE9C,kBAAAA,EAAE,EAAEkH,GAAG,CAAClH,EAAV;AAAcQ,kBAAAA,MAAM,EAAE0G,GAAG,CAAC1G,MAA1B;AAAkCE,kBAAAA,KAAK,EAAEwG,GAAG,CAACxG;AAA7C,iBAFG;AAGbyG,gBAAAA,QAHa,GAGF,EAHE;AAIjB,oBAAID,GAAG,CAACtG,aAAJ,IAAqBsG,GAAG,CAACtG,aAAJ,CAAkBU,MAAlB,GAA2B,CAApD,EACI6F,QAAQ,GAAGD,GAAG,CAACtG,aAAJ,CAAkBwG,IAAlB,KAA2B,IAAtC;;AACJ,oBAAIF,GAAG,CAACxG,KAAR,EAAe;AACXyG,kBAAAA,QAAQ,GAAGA,QAAQ,CAACE,MAAT,CAAgB,IAAhB,EAAsBH,GAAG,CAACxG,KAA1B,CAAX;AACH;;AACKyC,gBAAAA,OATW,GASD;AAAElH,kBAAAA,IAAI,EAAE,OAAR;AAAiBI,kBAAAA,IAAI,EAAEyG,KAAvB;AAA8BxG,kBAAAA,KAAK,EAAE;AAArC,iBATC;AAWjB,oBAAIqG,CAAC,IAAIqE,SAAL,IAAkBrE,CAAC,GAAGsE,SAA1B,EACIhD,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,kBAAAA,IAAI,EAAEiL,GAAG,CAAC1G,MAAZ;AAAoB0C,kBAAAA,OAAO,EAAEiE,QAA7B;AAAuChE,kBAAAA,OAAO,EAAPA;AAAvC,iBAAd,EADJ,KAGIc,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,kBAAAA,IAAI,EAAEiL,GAAG,CAAC1G,MAAZ;AAAoB0C,kBAAAA,OAAO,EAAEiE,QAA7B;AAAuChE,kBAAAA,OAAO,EAAPA,OAAvC;AAAgDmE,kBAAAA,MAAM,EAAE;AAAxD,iBAAd;AACP;AACJ;;AAGD,gBAAIV,YAAY,CAACtF,MAAb,GAAsB2F,SAA1B,EAAqC;AAC3B9D,cAAAA,QAD2B,GACjB;AAAElH,gBAAAA,IAAI,EAAE,QAAR;AAAkBI,gBAAAA,IAAI,EAAEyK,YAAxB;AAAsCxK,gBAAAA,KAAK,EAAE;AAA7C,eADiB;;AAEjC2H,cAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,gBAAAA,IAAI,EAAE,qBAAR;AAA+BiH,gBAAAA,OAAO,EAAE,qBAAxC;AAA+DC,gBAAAA,OAAO,EAAPA,QAA/D;AAAwEmE,gBAAAA,MAAM,EAAE;AAAhF,eAAd;;AAEAzB,cAAAA,QAAQ;AACFzC,cAAAA,UAL2B,GAKd;AACfnH,gBAAAA,IAAI,EAAE,UADS;AAEfI,gBAAAA,IAAI,EAAE;AAAEkL,kBAAAA,MAAM,EAAE,cAAV;AAA0B1B,kBAAAA,QAAQ,EAAEA;AAApC,iBAFS;AAEuCvJ,gBAAAA,KAAK,EAAE;AAF9C,eALc;;AASjC2H,cAAAA,QAAQ,CAACjD,IAAT,CAAc;AACV/E,gBAAAA,IAAI,EAAE,eADI;AACaiH,gBAAAA,OAAO,EAAE,uBADtB;AAEVC,gBAAAA,OAAO,EAAEC,UAFC;AAEWC,gBAAAA,aAAa,EAAE;AAF1B,eAAd;AAIH,aAbD,MAaO;AACGF,cAAAA,SADH,GACa;AAAElH,gBAAAA,IAAI,EAAE,QAAR;AAAkBI,gBAAAA,IAAI,EAAEyK,YAAxB;AAAsCxK,gBAAAA,KAAK,EAAE;AAA7C,eADb;;AAEH2H,cAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,gBAAAA,IAAI,EAAE,qBAAR;AAA+BiH,gBAAAA,OAAO,EAAE,qBAAxC;AAA+DC,gBAAAA,OAAO,EAAPA;AAA/D,eAAd;AACH;;AAED,+CAAY;AACR3G,cAAAA,MAAM,EAANA,MADQ;AACAC,cAAAA,MAAM,EAANA,MADA;AACQI,cAAAA,UAAU,EAAE,QADpB;AAERwJ,cAAAA,gBAAgB,EAAES,YAFV;AAGR5B,cAAAA,WAAW,EAAEnB,EAAE,CAACpH,KAAH,CAASuI,WAHd;AAIRM,cAAAA,KAAK,EAAEqB;AAJC,aAAZ;AA7EwB,+CAoFjB;AACH1K,cAAAA,IAAI,EAAE,UADH;AAEHF,cAAAA,IAAI,EAAE6C,IAFH;AAGH1C,cAAAA,OAAO,EAAE6H;AAHN,aApFiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAZlG,YAAY;AAAA;AAAA;AAAA,GAAlB;;;;AA2FA,IAAMyJ,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOhL,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACL,uCAAgB;AAAEG,cAAAA,MAAM,EAAEA,MAAV;AAAkBC,cAAAA,MAAM,EAAEA,MAA1B;AAAkCqH,cAAAA,UAAU,EAAE;AAA9C,aAAhB,CADK;;AAAA;AAChBC,YAAAA,EADgB;AAIlB0D,YAAAA,SAJkB,GAIN1D,EAAE,CAACpH,KAAH,CAASwJ,aAJH;AAKlBuB,YAAAA,OALkB,GAKR3D,EAAE,CAACpH,KAAH,CAASqD,EALD;;AAMtB,gBAAIyH,SAAS,GAAG,CAAZ,IAAiB1D,EAAE,CAACpH,KAAH,CAAS0J,gBAAT,IAA6BoB,SAAlD,EAA6D;AACzD,kBAAI1D,EAAE,CAACpH,KAAH,CAAS0J,gBAAT,KAA8B,CAAlC,EACIsB,MAAM,GAAG5D,EAAE,CAACpH,KAAH,CAASuI,WAAT,GAAuBnB,EAAE,CAACpH,KAAH,CAASuI,WAAT,GAAuB,CAA9C,GAAkD,CAA3D,CADJ,KAGIyC,MAAM,GAAG5D,EAAE,CAACpH,KAAH,CAASuI,WAAlB;AAEJ4B,cAAAA,YAAY,GAAG/C,EAAE,CAACpH,KAAH,CAAS0J,gBAAT,GAA4B,CAA3C;AACH,aAPD,MAOO;AACHsB,cAAAA,MAAM,GAAG5D,EAAE,CAACpH,KAAH,CAASuI,WAAT,GAAuBnB,EAAE,CAACpH,KAAH,CAASuI,WAAT,GAAuB,CAA9C,GAAkD,CAA3D;AACH;;AAEG0C,YAAAA,SAjBkB,GAiBN,KAjBM;AAkBtB,gBAAIH,SAAS,GAAG,CAAZ,IAAiBX,YAAY,GAAGW,SAApC,EACIG,SAAS,GAAG,IAAZ,CADJ,KAEK,IAAI,CAAC7D,EAAE,CAACpH,KAAH,CAASwJ,aAAV,IAA2BsB,SAAS,KAAK,CAA7C,EACDG,SAAS,GAAG,IAAZ;AAGJxM,YAAAA,OAAO,CAACyM,IAAR,CAAa,uBAAb,EAAsCD,SAAtC,EACI,iBADJ,EACuB7D,EAAE,CAACpH,KAAH,CAASwJ,aADhC,EAEI,gBAFJ,EAEsBW,YAFtB,EAGI,UAHJ,EAGgBzK,IAAI,CAACqE,KAHrB;AAxBsB;AAAA,mBA6BhB,mCAAY;AACdlE,cAAAA,MAAM,EAANA,MADc;AACNC,cAAAA,MAAM,EAANA,MADM;AACE+J,cAAAA,QAAQ,EAAEnK,IAAI,CAAC2D,EADjB;AAEdU,cAAAA,KAAK,EAAErE,IAAI,CAACqE,KAFE;AAGdoH,cAAAA,YAAY,EAAEF,SAHA;AAId/K,cAAAA,UAAU,EAAE,SAJE;AAKdwJ,cAAAA,gBAAgB,EAAES,YALJ;AAMd5B,cAAAA,WAAW,EAAEyC,MANC;AAOdlH,cAAAA,UAAU,EAAEsD,EAAE,CAACpH,KAAH,CAASgK,mBAPP;AAQdoB,cAAAA,SAAS,EAAE;AARG,aAAZ,CA7BgB;;AAAA;AAwCtB,gBAAIH,SAAJ,EAAe;AACX;AACA,qDAAiBpL,MAAjB,EAAyBkL,OAAzB,EAAkCC,MAAlC;AACH;;AA3CqB,iBA6ClBb,YA7CkB;AAAA;AAAA;AAAA;;AA8CZZ,YAAAA,UA9CY,GA8CAY,YAAY,GAAG,CA9Cf;AAAA,+CA+CX;AACH3K,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE,OAAOiK,UAAP,GAAmB,YAAnB,GAAkC7J,IAAI,CAACmE;AAF1C,aA/CW;;AAAA;AAAA,+CAoDX;AACHrE,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE,OAAO,UAAP,GAAoBI,IAAI,CAACmE;AAF5B,aApDW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAVgH,UAAU;AAAA;AAAA;AAAA,GAAhB;;;;AA2DA,IAAMhJ,mBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOhC,MAAP,EAAeC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACd,uCAAgB;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBqH,cAAAA,UAAU,EAAE;AAA9B,aAAhB,CADc;;AAAA;AACzBC,YAAAA,EADyB;;AAAA,kBAG3BA,EAAE,CAACpH,KAAH,CAASwJ,aAAT,GAAyB,CAAzB,IAA8BpC,EAAE,CAACpH,KAAH,CAAS0J,gBAAT,IAA6BtC,EAAE,CAACpH,KAAH,CAASwJ,aAHzC;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAIdvI,cAAc,CAACpB,MAAD,EAASC,MAAT,EAAiBsH,EAAE,CAACpH,KAAH,CAAS0J,gBAA1B,CAJA;;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAOdpI,gBAAgB,CAACzB,MAAD,EAASC,MAAT,EAAiBsH,EAAjB,CAPF;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAnBvF,mBAAmB;AAAA;AAAA;AAAA,GAAzB;;;;AAwDA,IAAMwJ,6BAA6B;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOxL,MAAP,EAAeC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAExB,uCAAgB;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBqH,cAAAA,UAAU,EAAE;AAA9B,aAAhB,CAFwB;;AAAA;AAEnCC,YAAAA,EAFmC;;AAAA,kBAIrCA,EAAE,CAACuC,KAAH,IAAYvC,EAAE,CAACuC,KAAH,CAAShF,MAAT,GAAkB,CAJO;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAK/B,wCAAkB9E,MAAlB,EAA0BuH,EAAE,CAACpH,KAAH,CAASqD,EAAnC,CAL+B;;AAAA;AAOrC,iBAAS2C,CAAT,GAAa,CAAb,EAAgBA,CAAC,GAAGoB,EAAE,CAACuC,KAAH,CAAShF,MAA7B,EAAqCqB,CAAC,EAAtC,EAA0C;AACtC,kBAAIoB,EAAE,CAACuC,KAAH,CAAS3D,CAAT,EAAY4D,MAAZ,KAAuB,CAA3B,EAA8B;AAC1BxC,gBAAAA,EAAE,CAACuC,KAAH,CAAS2B,MAAT,CAAgBtF,CAAhB,EAAmB,CAAnB;AACH;AACJ;;AAXoC;AAAA;AAAA,mBAa5B1E,gBAAgB,CAACzB,MAAD,EAASC,MAAT,EAAiBsH,EAAjB,CAbY;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAA7BiE,6BAA6B;AAAA;AAAA;AAAA,GAAnC;;;;AAgBA,IAAM/J,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOzB,MAAP,EAAeC,MAAf,EAAuBsH,EAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,gBACvBA,EADuB;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAEb,uCAAgB;AAAEvH,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBqH,cAAAA,UAAU,EAAE;AAA9B,aAAhB,CAFa;;AAAA;AAExBC,YAAAA,EAFwB;;AAAA;AAAA;AAAA,mBAItB,mCAAY;AAAEvH,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE,sBAA9B;AAAsD6I,cAAAA,UAAU,EAAE,IAAlE;AAAwET,cAAAA,IAAI,EAAE;AAA9E,aAAZ,CAJsB;;AAAA;AAMxBiD,YAAAA,WANwB,GAMV,CANU;AAOxBpJ,YAAAA,IAPwB,GAOjB,kBAAkBiF,EAAE,CAACpH,KAAH,CAASqD,EAA3B,GAAgC,IAPf;;AAAA,kBASxB+D,EAAE,CAACuC,KAAH,IAAYvC,EAAE,CAACuC,KAAH,CAAShF,MAAT,GAAkB,CATN;AAAA;AAAA;AAAA;;AAUxBxC,YAAAA,IAAI,GAAGA,IAAI,GAAG,uCAAd;AAVwB;AAAA;AAAA;AAAA;;AAWxB,8BAAmBiF,EAAE,CAACuC,KAAtB,2HAA6B;AAAlB6B,cAAAA,IAAkB;;AACzB,kBAAIA,IAAI,CAAC3B,QAAT,EAAmB;AACX4B,gBAAAA,OADW,GACDD,IAAI,CAAC3C,KAAL,GAAa,CAAb,GAAiB2C,IAAI,CAACpD,GAAL,GAAW,GAAX,GAAiBoD,IAAI,CAAC3C,KAAvC,GAA+C2C,IAAI,CAACpD,GADnD;AAGXsD,gBAAAA,QAHW,GAGA,EAHA;AAIf,oBAAIF,IAAI,CAACxH,MAAT,EACI0H,QAAQ,GAAGF,IAAI,CAAC5C,IAAhB,CALW,CAOf;;AACAzG,gBAAAA,IAAI,GAAGA,IAAI,aAAMsJ,OAAN,cAAiBD,IAAI,CAAC3H,MAAtB,cAAgC6H,QAAhC,gBAA8C,6BAAiBF,IAAI,CAACzH,KAAtB,CAA9C,QAAX;AACH;;AACD,kBAAIyH,IAAI,CAACzH,KAAT,EACIwH,WAAW,IAAIC,IAAI,CAACzH,KAApB;AACP;;AAxBuB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAyBxB,gBAAIqD,EAAE,CAACpH,KAAH,CAAS2L,YAAT,IAAyBvE,EAAE,CAACpH,KAAH,CAAS2L,YAAT,KAA0B,UAAvD,EAAmE;AAC/D,kBAAIvE,EAAE,CAACpH,KAAH,CAAS4L,YAAT,GAAwB,CAA5B,EAA+B;AAC3BzJ,gBAAAA,IAAI,iCAA0B,6BAAiBiF,EAAE,CAACpH,KAAH,CAAS4L,YAA1B,CAA1B,OAAJ;AACAL,gBAAAA,WAAW,IAAInE,EAAE,CAACpH,KAAH,CAAS4L,YAAxB;AACH;AACJ;;AACDzJ,YAAAA,IAAI,GAAGA,IAAI,GAAG,cAAP,GAAwB,6BAAiBoJ,WAAjB,CAAxB,GAAwD,MAA/D;AA/BwB;AAAA;;AAAA;AAkCxBpJ,YAAAA,IAAI,GAAGA,IAAI,GAAG,oDAAd;;AAlCwB;AAqC5BA,YAAAA,IAAI,GAAGA,IAAI,GAAG,qBAAd;AAEMmF,YAAAA,QAvCsB,GAuCX,EAvCW;;AAwC5BA,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AACV/E,cAAAA,IAAI,oBAAa8H,EAAE,CAACuC,KAAH,IAAYvC,EAAE,CAACuC,KAAH,CAAShF,MAAT,GAAkB,CAA9B,GAAkC,MAAlC,GAA2C,EAAxD,qBADM;AAEVhF,cAAAA,KAAK,EAAE;AAFG,aAAd;;AAIA,gBAAIyH,EAAE,CAACuC,KAAH,IAAYvC,EAAE,CAACuC,KAAH,CAAShF,MAAT,GAAkB,CAAlC,EAAqC;AACjC2C,cAAAA,QAAQ,CAACjD,IAAT,CAAc;AACV/E,gBAAAA,IAAI,EAAE,sBADI;AAEVI,gBAAAA,IAAI,EAAE;AACFF,kBAAAA,IAAI,EAAE,kBADJ;AAEFqM,kBAAAA,MAAM,EAAE;AAFN,iBAFI;AAMVlM,gBAAAA,KAAK,EAAE;AANG,eAAd;;AAQA2H,cAAAA,QAAQ,CAACjD,IAAT,CAAc;AACV/E,gBAAAA,IAAI,EAAE,oBADI;AAEVI,gBAAAA,IAAI,EAAE;AACFmM,kBAAAA,MAAM,EAAE,sBADN;AAEFjB,kBAAAA,MAAM,EAAE;AAFN,iBAFI;AAMVjL,gBAAAA,KAAK,EAAE;AANG,eAAd;;AAQA2H,cAAAA,QAAQ,CAACjD,IAAT,CAAc;AACV/E,gBAAAA,IAAI,EAAE,2BADI;AAEVI,gBAAAA,IAAI,EAAE;AACFmM,kBAAAA,MAAM,EAAE,sBADN;AAEFjB,kBAAAA,MAAM,EAAE;AAFN,iBAFI;AAMVjL,gBAAAA,KAAK,EAAE;AANG,eAAd;AAQH;;AACD2H,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AACV/E,cAAAA,IAAI,EAAE,kBADI;AAEVI,cAAAA,IAAI,EAAE,gBAFI;AAGVC,cAAAA,KAAK,EAAE;AAHG,aAAd;;AAtE4B,+CA4ErB;AACHH,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE6C,IAFH;AAGH1C,cAAAA,OAAO,EAAE6H;AAHN,aA5EqB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAhBhG,gBAAgB;AAAA;AAAA;AAAA,GAAtB,C,CAoFP;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;;;;;;;;;;AAMO,IAAMwK,mBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOjM,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACNmL,UAAU,CAAChL,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,CADJ;;AAAA;AACzBgG,YAAAA,UADyB;AAAA;AAAA,mBAEJ7D,mBAAmB,CAAChC,MAAD,EAASC,MAAT,CAFf;;AAAA;AAEzB8F,YAAAA,YAFyB;AAI/BA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AAJ+B,+CAKxBsG,YALwB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAnBkG,mBAAmB;AAAA;AAAA;AAAA,GAAzB;;;;AASA,IAAMrK,iBAAiB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO5B,MAAP,EAAeC,MAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;AACvBwH,YAAAA,QADuB,GACZ,EADY;AAAA;AAAA,mBAGL,oCAAazH,MAAb,CAHK;;AAAA;AAGvB2E,YAAAA,SAHuB;;AAAA,kBAIzBA,SAAS,CAACuH,aAAV,IAA2BvH,SAAS,CAACuH,aAAV,CAAwBpH,MAAxB,GAAiC,CAJnC;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAKzB,8BAAwBH,SAAS,CAACuH,aAAlC,2HAAiD;AAAxCC,cAAAA,WAAwC;AACzC7J,cAAAA,IADyC,GAClC6J,WAAW,CAACC,YADsB;;AAE7C,kBAAID,WAAW,CAACE,iBAAZ,GAAgC,CAApC,EAAuC;AACnC/J,gBAAAA,IAAI,2BAAoB6J,WAAW,CAACE,iBAAhC,0BAAJ;AACH,eAFD,MAEO,IAAIF,WAAW,CAACG,gBAAZ,GAA+B,CAAnC,EAAsC;AACzChK,gBAAAA,IAAI,2BAAoB,6BAAiB6J,WAAW,CAACG,gBAA7B,CAApB,yBAAJ;AACH;;AAED7E,cAAAA,QAAQ,CAACjD,IAAT,CAAc;AACV/E,gBAAAA,IAAI,EAAE6C,IADI;AACEzC,gBAAAA,IAAI,EAAE;AACduM,kBAAAA,YAAY,EAAED,WAAW,CAACC,YADZ;AAEdC,kBAAAA,iBAAiB,EAAEF,WAAW,CAACE,iBAFjB;AAGdC,kBAAAA,gBAAgB,EAAEH,WAAW,CAACG;AAHhB,iBADR;AAKPxM,gBAAAA,KAAK,EAAE;AALA,eAAd;AAOH;;AApBwB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAsBzB2H,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AACV/E,cAAAA,IAAI,EAAE,UADI;AACQI,cAAAA,IAAI,EAAE;AACpBuM,gBAAAA,YAAY,EAAE,UADM;AACMC,gBAAAA,iBAAiB,EAAE,CADzB;AAC4BE,gBAAAA,gBAAgB,EAAE;AAD9C,eADd;AAGPzM,cAAAA,KAAK,EAAE;AAHA,aAAd;;AAKA2H,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AACV/E,cAAAA,IAAI,EAAE,QADI;AACMI,cAAAA,IAAI,EAAE;AAClBuM,gBAAAA,YAAY,EAAE,QADI;AACMC,gBAAAA,iBAAiB,EAAE,CADzB;AAC4BC,gBAAAA,gBAAgB,EAAE;AAD9C,eADZ;AAGPxM,cAAAA,KAAK,EAAE;AAHA,aAAd;;AA3ByB;AAAA;AAAA,mBAmCvB,mCAAY;AAAEE,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE;AAA9B,aAAZ,CAnCuB;;AAAA;AAAA,+CAqCtB;AACHV,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE,4BAFH;AAGHG,cAAAA,OAAO,EAAE6H;AAHN,aArCsB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAjB7F,iBAAiB;AAAA;AAAA;AAAA,GAAvB;;;;AA4CA,IAAM4K,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOxM,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACrB,mCAAY;AACdG,cAAAA,MAAM,EAANA,MADc;AACNC,cAAAA,MAAM,EAANA,MADM;AACEkM,cAAAA,WAAW,EAAEtM,IAAI,CAACuM,YADpB;AAEdC,cAAAA,iBAAiB,EAAExM,IAAI,CAACwM,iBAFV;AAE6BC,cAAAA,gBAAgB,EAAEzM,IAAI,CAACyM;AAFpD,aAAZ,CADqB;;AAAA;AAMvBG,YAAAA,eANuB,GAML5M,IAAI,CAACuM,YANA;AAAA,+CAQpB;AACHzM,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE,OAAO,uBAAP,GAAiCgN;AAFpC,aARoB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAfD,eAAe;AAAA;AAAA;AAAA,GAArB;;;;AAcA,IAAM3K,mBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO7B,MAAP,EAAeC,MAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;AACzBwH,YAAAA,QADyB,GACd,EADc;;AAE/BA,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAE,KAAR;AAAeI,cAAAA,IAAI,EAAE,oBAArB;AAA2CC,cAAAA,KAAK,EAAE;AAAlD,aAAd;;AACA2H,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAE,KAAR;AAAeI,cAAAA,IAAI,EAAE,mBAArB;AAA0CC,cAAAA,KAAK,EAAE;AAAjD,aAAd;;AAH+B;AAAA,mBAKzB,mCAAY;AAAEE,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE;AAA9B,aAAZ,CALyB;;AAAA;AAAA,+CAOxB;AACHV,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE,mBAFH;AAGHG,cAAAA,OAAO,EAAE6H;AAHN,aAPwB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAnB5F,mBAAmB;AAAA;AAAA;AAAA,GAAzB;AAeP;;;;;;;;;;AAMO,IAAM6K,kCAAkC;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO1M,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACrB2M,eAAe,CAACxM,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,CADM;;AAAA;AACxCgG,YAAAA,UADwC;AAAA;AAAA,mBAEnBhE,mBAAmB,CAAC7B,MAAD,EAASC,MAAT,CAFA;;AAAA;AAExC8F,YAAAA,YAFwC;AAI9CA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AAJ8C,+CAKvCsG,YALuC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAlC2G,kCAAkC;AAAA;AAAA;AAAA,GAAxC;;;;AAQA,IAAMC,iBAAiB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO3M,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACvB,mCAAY;AAAEG,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkB2M,cAAAA,aAAa,EAAE/M;AAAjC,aAAZ,CADuB;;AAAA;AAGzBgN,YAAAA,iBAHyB,GAGLhN,IAAI,KAAK,oBAAT,GAClB,mBADkB,GAElB,sBALuB;AAAA,+CAOtB;AACHF,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE,OAAOoN;AAFV,aAPsB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAjBF,iBAAiB;AAAA;AAAA;AAAA,GAAvB;;;;AAaA,IAAM7K,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO9B,MAAP,EAAeC,MAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;AACpBwH,YAAAA,QADoB,GACT,EADS;;AAE1BA,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAE,KAAR;AAAeI,cAAAA,IAAI,EAAE,cAArB;AAAqCC,cAAAA,KAAK,EAAE;AAA5C,aAAd;;AACA2H,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAE,KAAR;AAAeI,cAAAA,IAAI,EAAE,aAArB;AAAoCC,cAAAA,KAAK,EAAE;AAA3C,aAAd;;AAH0B;AAAA,mBAKpB,mCAAY;AAAEE,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE;AAA9B,aAAZ,CALoB;;AAAA;AAAA,+CAOnB;AACHV,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE,0DAFH;AAGHG,cAAAA,OAAO,EAAE6H;AAHN,aAPmB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAd3F,cAAc;AAAA;AAAA;AAAA,GAApB;;;;AAcA,IAAMgL,+BAA+B;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO9M,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAClB8M,iBAAiB,CAAC3M,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,CADC;;AAAA;AACrCgG,YAAAA,UADqC;AAAA;AAAA,mBAEhB/D,cAAc,CAAC9B,MAAD,EAASC,MAAT,CAFE;;AAAA;AAErC8F,YAAAA,YAFqC;AAI3CA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AAJ2C,+CAKpCsG,YALoC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAA/B+G,+BAA+B;AAAA;AAAA;AAAA,GAArC;;;;AASA,IAAMC,iBAAiB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOtK,MAAP,EAAesE,MAAf,EAAuB4E,IAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,iBAEzBA,IAFyB;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAGnB,mCAAY;AAAE3L,cAAAA,MAAM,EAAEyC,MAAV;AAAkBxC,cAAAA,MAAM,EAAE8G,MAA1B;AAAkC1G,cAAAA,UAAU,EAAE,qBAA9C;AAAqEE,cAAAA,cAAc,EAAEoL,IAAI,CAACnI;AAA1F,aAAZ,CAHmB;;AAAA;AAIzBlB,YAAAA,IAAI,GAAG,yEAAP;AAJyB;AAAA;;AAAA;AAAA;AAAA,mBAMnB,mCAAY;AAAEtC,cAAAA,MAAM,EAAEyC,MAAV;AAAkBxC,cAAAA,MAAM,EAAE8G,MAA1B;AAAkC1G,cAAAA,UAAU,EAAE;AAA9C,aAAZ,CANmB;;AAAA;AAOzBiC,YAAAA,IAAI,GAAG,4EAAP;;AAPyB;AAAA,+CAStB;AACH3C,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE6C;AAFH,aATsB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAjByK,iBAAiB;AAAA;AAAA;AAAA,GAAvB;;;;AAgBA,IAAMC,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOhN,MAAP,EAAeC,MAAf,EAAuBR,IAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAClB,mCAAY;AAAEO,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBgN,cAAAA,QAAQ,EAAExN;AAA5B,aAAZ,CADkB;;AAAA;AAGpByN,YAAAA,YAHoB,GAGL,sCAHK;AAIxBA,YAAAA,YAAY,IAAIzN,IAAhB;AAJwB,+CAMjB;AACHE,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE,OAAOyN;AAFV,aANiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAZF,YAAY;AAAA;AAAA;AAAA,GAAlB;;;;AAYA,IAAMjL,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO/B,MAAP,EAAeC,MAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAGR,uCAAgB;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBqH,cAAAA,UAAU,EAAE;AAA9B,aAAhB,CAHQ;;AAAA;AAGnBC,YAAAA,EAHmB;AAKrBmE,YAAAA,WALqB,GAKP,CALO;AAMrBpJ,YAAAA,IANqB,GAMd,uCANc;AAQzBA,YAAAA,IAAI,GAAGA,IAAI,GAAG,gBAAP,GAA0BiF,EAAE,CAACpH,KAAH,CAASqD,EAAnC,GAAwC,IAA/C;AARyB;AAAA;AAAA;AAAA;;AASzB,8BAAmB+D,EAAE,CAACuC,KAAtB,2HAA6B;AAAlB6B,cAAAA,IAAkB;;AACzB,kBAAIA,IAAI,CAAC3B,QAAT,EAAmB;AACX4B,gBAAAA,OADW,GACDD,IAAI,CAAC3C,KAAL,GAAa,CAAb,GAAiB2C,IAAI,CAACpD,GAAL,GAAW,GAAX,GAAiBoD,IAAI,CAAC3C,KAAvC,GAA+C2C,IAAI,CAACpD,GADnD;AAEXsD,gBAAAA,QAFW,GAEAF,IAAI,CAACxH,MAAL,GAAcwH,IAAI,CAAC5C,IAAnB,GAA0B,EAF1B,EAGf;;AACAzG,gBAAAA,IAAI,GAAGA,IAAI,aAAMsJ,OAAN,cAAiBD,IAAI,CAAC3H,MAAtB,eAAiC6H,QAAjC,OAAX;AACAH,gBAAAA,WAAW,IAAIC,IAAI,CAACzH,KAApB;AACH;AACJ;;AAjBwB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAmBzB,gBAAIqD,EAAE,CAACpH,KAAH,CAAS2L,YAAT,IAAyBvE,EAAE,CAACpH,KAAH,CAAS2L,YAAT,KAA0B,QAAvD,EAAiE;AAC7DxJ,cAAAA,IAAI,IAAI,mBAAR;AACA,kBAAIiF,EAAE,CAACpH,KAAH,CAASgN,aAAb,EACI7K,IAAI,IAAI,wBAAwBiF,EAAE,CAACpH,KAAH,CAASgN,aAAjC,GAAiD,IAAzD;AACP,aAJD,MAIO;AACH7K,cAAAA,IAAI,IAAI,4CAA4CiF,EAAE,CAACpH,KAAH,CAASiF,OAArD,GAA+D,IAAvE;;AAEA,kBAAImC,EAAE,CAACpH,KAAH,CAAS4L,YAAT,GAAwB,CAA5B,EAA+B;AAC3BzJ,gBAAAA,IAAI,8KAAqC,6BAAiBiF,EAAE,CAACpH,KAAH,CAAS4L,YAA1B,CAArC,OAAJ;AACAL,gBAAAA,WAAW,IAAInE,EAAE,CAACpH,KAAH,CAAS4L,YAAxB;AACH;AACJ;;AAEDzJ,YAAAA,IAAI,GAAGA,IAAI,GAAG,oBAAP,GAA8BiF,EAAE,CAACpH,KAAH,CAASuF,KAAvC,GAA+C,IAAtD;AACApD,YAAAA,IAAI,GAAGA,IAAI,GAAG,sCAAP,GAAgDiF,EAAE,CAACpH,KAAH,CAASiM,YAAzD,GAAwE,IAA/E;;AAEA,gBAAI7E,EAAE,CAAC6F,cAAH,KAAsB,oBAA1B,EAAgD;AAC5C9K,cAAAA,IAAI,GAAGA,IAAI,GAAG,+BAAd;AACH;;AAED,gBAAIiF,EAAE,CAACpH,KAAH,CAASkM,iBAAT,GAA6B,CAAjC,EAAoC;AAChC/J,cAAAA,IAAI,wFAAqBiF,EAAE,CAACpH,KAAH,CAASiM,YAA9B,eAA+C7E,EAAE,CAACpH,KAAH,CAASkM,iBAAT,GAA6B,GAA5E,QAAJ;AACAX,cAAAA,WAAW,IAAIA,WAAW,GAAGnE,EAAE,CAACpH,KAAH,CAASkM,iBAAtC;AACH;;AAED,gBAAI9E,EAAE,CAACpH,KAAH,CAASmM,gBAAT,GAA4B,CAAhC,EAAmC;AAC/BhK,cAAAA,IAAI,wFAAqBiF,EAAE,CAACpH,KAAH,CAASiM,YAA9B,eAA+C,6BAAiB7E,EAAE,CAACpH,KAAH,CAASmM,gBAA1B,CAA/C,OAAJ;AACAZ,cAAAA,WAAW,IAAInE,EAAE,CAACpH,KAAH,CAASmM,gBAAxB;AACH;;AAEDhK,YAAAA,IAAI,GAAGA,IAAI,GAAG,cAAP,GAAwB,6BAAiBoJ,WAAjB,CAAxB,GAAwD,IAA/D;AAEIwB,YAAAA,YAnDqB,GAmDN3F,EAAE,CAACpH,KAAH,CAAS8M,QAAT,IAAqB,iBAnDf;AAoDzB3K,YAAAA,IAAI,GAAGA,IAAI,GAAG,4BAAP,GAAsC4K,YAAtC,GAAqD,IAA5D;AApDyB,+CAsDlB;AACHvN,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE6C,IAFH,CAKP;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;AA9BO,aAtDkB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAbP,aAAa;AAAA;AAAA;AAAA,GAAnB;AAuFP;;;;;;;;;;AAMO,IAAMsL,6BAA6B;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOrN,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAChB2M,eAAe,CAACxM,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,CADC;;AAAA;AACnCgG,YAAAA,UADmC;AAAA;AAAA,mBAEd/D,cAAc,CAAC9B,MAAD,EAASC,MAAT,CAFA;;AAAA;AAEnC8F,YAAAA,YAFmC;AAIzCA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AAJyC,+CAKlCsG,YALkC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAA7BsH,6BAA6B;AAAA;AAAA;AAAA,GAAnC;AAQP;;;;;;;;;;AAMO,IAAMC,yBAAyB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOtN,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACjCA,IAAI,IAAIA,IAAI,KAAK,aADgB;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAE3BmN,YAAY,CAAChN,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,CAFe;;AAAA;AAAA;AAAA,mBAKZkC,aAAa,CAAC/B,MAAD,EAASC,MAAT,CALD;;AAAA;AAK/B4F,YAAAA,UAL+B;AAAA;AAAA,mBAMZ0H,YAAY,CAACvN,MAAD,EAASC,MAAT,CANA;;AAAA;AAM/BuN,YAAAA,UAN+B;AAQrCA,YAAAA,UAAU,CAAC/N,IAAX,GAAkBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2B+N,UAAU,CAAC/N,IAAxD;AARqC,+CAS9B+N,UAT8B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAzBF,yBAAyB;AAAA;AAAA;AAAA,GAA/B;;;;AAYA,IAAMC,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOvN,MAAP,EAAeC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAClB,mCAAY;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBsN,cAAAA,YAAY,EAAE,IAAhC;AAAsChC,cAAAA,SAAS,EAAE;AAAjD,aAAZ,CADkB;;AAAA;AAAA,+CAGjB;AACH5L,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE;AAFH,aAHiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAZ8N,YAAY;AAAA;AAAA;AAAA,GAAlB;;;;AASA,IAAM/L,iBAAiB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOxB,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAE7B,gBAAIA,IAAI,IAAIA,IAAI,CAAC4N,cAAL,CAAoB,QAApB,CAAZ,EAA2C;AACvCC,cAAAA,WAAW,GAAG7N,IAAI,CAACmM,MAAnB;AACH;;AAJ4B,iBAMzB0B,WANyB;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAOnB,mCAAY;AAAE1N,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE,cAA9B;AAA8C8H,cAAAA,kBAAkB,EAAEuF;AAAlE,aAAZ,CAPmB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBASnB,mCAAY;AAAE1N,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE;AAA9B,aAAZ,CATmB;;AAAA;AAYzBiC,YAAAA,IAZyB,GAYlB,gDAZkB;AAcvBmF,YAAAA,QAduB,GAcZ,EAdY;;AAe7BA,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAE,cAAR;AAAwBI,cAAAA,IAAI,EAAE,aAA9B;AAA6CC,cAAAA,KAAK,EAAE;AAApD,aAAd;;AACA2H,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAE,gBAAR;AAA0BI,cAAAA,IAAI,EAAE,gBAAhC;AAAkDC,cAAAA,KAAK,EAAE;AAAzD,aAAd;;AAEA,gBAAI4N,WAAJ,EAAiB;AACb;AACMC,cAAAA,IAFO,GAEAD,WAAW,KAAK,sBAAhB,GACP,0BADO,GAEP,oBAJO;;AAMbjG,cAAAA,QAAQ,CAACjD,IAAT,CAAc;AACV/E,gBAAAA,IAAI,EAAE,YADI;AAEVI,gBAAAA,IAAI,EAAE;AAAEF,kBAAAA,IAAI,EAAE,kBAAR;AAA4BqM,kBAAAA,MAAM,EAAE0B;AAApC,iBAFI;AAGV5N,gBAAAA,KAAK,EAAE6N;AAHG,eAAd;AAKH;;AA7B4B,+CA+BtB;AACHhO,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE6C,IAFH;AAGH1C,cAAAA,OAAO,EAAE6H;AAHN,aA/BsB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAjBjG,iBAAiB;AAAA;AAAA;AAAA,GAAvB;;;;AAsCA,IAAMoM,qBAAqB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO5N,MAAP,EAAeC,MAAf,EAAuB0L,IAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEzBrJ,YAAAA,IAFyB,GAElB,mCAFkB;AAIvBmF,YAAAA,QAJuB,GAIZ,EAJY;;AAK7BA,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAE,kCAAR;AAA4CI,cAAAA,IAAI,EAAE8L,IAAlD;AAAwD7L,cAAAA,KAAK,EAAE;AAA/D,aAAd;;AACA2H,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAE,kBAAR;AAA4BI,cAAAA,IAAI,EAAE8L,IAAlC;AAAwC7L,cAAAA,KAAK,EAAE;AAA/C,aAAd;;AAN6B,+CAQtB;AACHH,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE6C,IAFH;AAGH1C,cAAAA,OAAO,EAAE6H;AAHN,aARsB;;AAAA;AAAA;AAAA;AAc7B7I,YAAAA,OAAO,CAAC2D,KAAR,CAAc;AAAEsL,cAAAA,wBAAwB;AAA1B,aAAd;AAd6B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAArBD,qBAAqB;AAAA;AAAA;AAAA,GAA3B;;;;AAmBA,IAAME,kBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO9N,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACH,uCAAgB;AAAEG,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBqH,cAAAA,UAAU,EAAE;AAA9B,aAAhB,CADG;;AAAA;AACxBpH,YAAAA,YADwB;;AAAA,kBAE1BA,YAAY,CAAC4J,KAAb,IAAsB5J,YAAY,CAAC4J,KAAb,CAAmBhF,MAAnB,GAA4B,CAFxB;AAAA;AAAA;AAAA;;AAIpB2C,YAAAA,QAJoB,GAIT,EAJS;AAKtBsG,YAAAA,OALsB,GAKZ,CALY;AAAA;AAAA;AAAA;AAAA;;AAM1B,8BAAiB7N,YAAY,CAAC4J,KAA9B,2HAAqC;AAA5B6B,cAAAA,IAA4B;;AACjC,kBAAIA,IAAI,CAACR,MAAL,KAAgB4C,OAApB,EAA6B;AACrBzL,gBAAAA,IADqB;;AAEzB,oBAAIqJ,IAAI,CAAC5C,IAAL,IAAa4C,IAAI,CAAC3H,MAAtB,EAA8B;AACtBgK,kBAAAA,UADsB,aACNrC,IAAI,CAAC5C,IADC;;AAE1B,sBAAI4C,IAAI,CAAC3C,KAAL,IAAc2C,IAAI,CAAC3C,KAAL,GAAa,CAA/B,EAAkC;AAC9B,wBAAI2C,IAAI,CAACsC,QAAL,CAAcC,WAAd,GAA4BC,OAA5B,CAAoC,OAApC,IAA+C,CAAC,CAApD,EACIH,UAAU,GAAG,WAAWA,UAAxB;AACJA,oBAAAA,UAAU,GAAGA,UAAU,cAAOrC,IAAI,CAAC3C,KAAZ,aAAvB;AACH,mBAJD,MAKIgF,UAAU,GAAGrC,IAAI,CAAC3H,MAAL,GAAc,GAAd,GAAoBgK,UAAjC;;AAEJ1L,kBAAAA,IAAI,aAAM0L,UAAN,CAAJ;AACH,iBAVD,MAUO;AACH1L,kBAAAA,IAAI,GAAGqJ,IAAI,CAAC3H,MAAZ;AACH;;AAED,oBAAI1B,IAAJ,EAAU;AACN,sBAAIzC,IAAI,IAAIA,IAAI,CAACkL,MAAL,KAAgB,aAA5B,EAA2C;AACvCtD,oBAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,sBAAAA,IAAI,EAAE6C,IAAR;AAAczC,sBAAAA,IAAI,EAAE8L,IAApB;AAA0B7L,sBAAAA,KAAK,EAAE;AAAjC,qBAAd;AACH,mBAFD,MAEO;AACH2H,oBAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,sBAAAA,IAAI,EAAE6C,IAAR;AAAczC,sBAAAA,IAAI,EAAE8L,IAApB;AAA0B7L,sBAAAA,KAAK,EAAE;AAAjC,qBAAd;AACH;AACJ;;AAEDiO,gBAAAA,OAAO,GAAGpC,IAAI,CAACR,MAAf;AACH;AACJ;;AAjCyB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAmCtBiD,YAAAA,QAnCsB,GAmCX,gCAnCW;AAoC1B,gBAAIvO,IAAI,IAAIA,IAAI,CAACkL,MAAL,KAAgB,aAA5B,EACIqD,QAAQ,GAAGA,QAAQ,GAAG,UAAtB,CADJ,KAGIA,QAAQ,GAAGA,QAAQ,GAAG,UAAtB;AAvCsB,+CA0CnB;AACHzO,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE2O,QAFH;AAGHxO,cAAAA,OAAO,EAAE6H;AAHN,aA1CmB;;AAAA;AAAA;AAAA,mBAgDpB,mCAAY;AAAEzH,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBqL,cAAAA,YAAY,EAAE;AAAhC,aAAZ,CAhDoB;;AAAA;AAAA;AAAA,mBAiDbsC,qBAAqB,CAAC5N,MAAD,EAASC,MAAT,EAAiBC,YAAY,CAAC4J,KAAb,CAAmB,CAAnB,CAAjB,CAjDR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAlBgE,kBAAkB;AAAA;AAAA;AAAA,GAAxB;AAqDP;;;;;;;;;AAKO,IAAMpM,kBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO1B,MAAP,EAAeC,MAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;AAC9B,+CAAY;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE;AAA9B,aAAZ;AAD8B;AAAA,mBAGH,uCAAgB;AAAEL,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBqH,cAAAA,UAAU,EAAE;AAA9B,aAAhB,CAHG;;AAAA;AAGxBpH,YAAAA,YAHwB;AAKxBmO,YAAAA,UALwB,GAKXnO,YAAY,CAACC,KAAb,CAAmBmO,WALR;;AAAA,kBAO1B,OAAOD,UAAP,KAAsB,WAPI;AAAA;AAAA;AAAA;;AAStB/L,YAAAA,IATsB,GASf,8BATe;AAWpBmF,YAAAA,QAXoB,GAWT,EAXS;;AAY1BA,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAE,KAAR;AAAeI,cAAAA,IAAI,EAAE,cAArB;AAAqCC,cAAAA,KAAK,EAAE;AAA5C,aAAd;;AACA2H,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAE,KAAR;AAAeI,cAAAA,IAAI,EAAE,aAArB;AAAoCC,cAAAA,KAAK,EAAE;AAA3C,aAAd;;AAb0B,+CAcnB;AACHH,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAE6C,IAFH;AAGH1C,cAAAA,OAAO,EAAE6H;AAHN,aAdmB;;AAAA;AAAA,+CAoBnB1F,aAAa,CAAC/B,MAAD,EAASC,MAAT,CApBM;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAlByB,kBAAkB;AAAA;AAAA;AAAA,GAAxB;AAuBP;;;;;;;;;;AAMO,IAAMC,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO3B,MAAP,EAAeC,MAAf,EAAuBoJ,QAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACrB,mCAAY;AAAErJ,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE,UAA9B;AAA0CgO,cAAAA,UAAU,EAAE;AAAtD,aAAZ,CADqB;;AAAA;AAAA;AAAA,mBAGA,uCAAarO,MAAb,CAHA;;AAAA;AAGrBuO,YAAAA,YAHqB;AAIvB/D,YAAAA,SAJuB,GAIX,CAACnB,QAAQ,GAAG,CAAZ,IAAiB,CAJN;AAKvBoB,YAAAA,SALuB,GAKXpB,QAAQ,GAAG,CALA;AAOrB5B,YAAAA,QAPqB,GAOV,EAPU;;AAQ3B,iBAAStB,CAAT,GAAaqE,SAAb,EAAwBrE,CAAC,GAAGsE,SAA5B,EAAuCtE,CAAC,EAAxC,EAA4C;AACxC,kBAAIoI,YAAY,CAACpI,CAAD,CAAhB,EAAqB;AACXqI,gBAAAA,IADW,GACJD,YAAY,CAACpI,CAAD,CADR;AAEXG,gBAAAA,KAFW,GAEH;AAAE9C,kBAAAA,EAAE,EAAEgL,IAAI,CAAChL,EAAX;AAAeiL,kBAAAA,QAAQ,EAAED,IAAI,CAACE,IAA9B;AAAoCxK,kBAAAA,KAAK,EAAEsK,IAAI,CAACtK;AAAhD,iBAFG;AAGXyC,gBAAAA,OAHW,GAGD;AAAElH,kBAAAA,IAAI,EAAE,OAAR;AAAiBI,kBAAAA,IAAI,EAAEyG,KAAvB;AAA8BxG,kBAAAA,KAAK,EAAE;AAArC,iBAHC;AAKb6K,gBAAAA,QALa,GAKF6D,IAAI,CAACG,IALH;;AAMjB,oBAAIH,IAAI,CAACtK,KAAT,EAAgB;AACZyG,kBAAAA,QAAQ,GAAGA,QAAQ,CAACE,MAAT,CAAgB,OAAhB,EAAyB2D,IAAI,CAACtK,KAA9B,CAAX;AACH;;AACDuD,gBAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,kBAAAA,IAAI,EAAE+O,IAAI,CAACE,IAAb;AAAmBhI,kBAAAA,OAAO,EAAEiE,QAA5B;AAAsChE,kBAAAA,OAAO,EAAPA;AAAtC,iBAAd;AACH;AACJ;;AACD,gBAAK4H,YAAY,CAACzJ,MAAb,GAAsB,CAAvB,GAA4B2F,SAAhC,EAA2C;AACvCpB,cAAAA,QAAQ;AACFzC,cAAAA,UAFiC,GAEpB;AACfnH,gBAAAA,IAAI,EAAE,UADS;AAEfI,gBAAAA,IAAI,EAAE;AAAEkL,kBAAAA,MAAM,EAAE,gBAAV;AAA4B1B,kBAAAA,QAAQ,EAAEA;AAAtC,iBAFS;AAGfvJ,gBAAAA,KAAK,EAAE;AAHQ,eAFoB;;AAOvC2H,cAAAA,QAAQ,CAACjD,IAAT,CAAc;AACV/E,gBAAAA,IAAI,EAAE,6BADI;AAEVkH,gBAAAA,OAAO,EAAEC,UAFC;AAGVC,gBAAAA,aAAa,EAAE;AAHL,eAAd;AAKH,aAZD,MAYO;AACGP,cAAAA,MADH,GACW;AAAEyE,gBAAAA,MAAM,EAAE;AAAV,eADX;AAEGpE,cAAAA,SAFH,GAEa;AAAElH,gBAAAA,IAAI,EAAE,YAAR;AAAsBI,gBAAAA,IAAI,EAAEyG,MAA5B;AAAmCxG,gBAAAA,KAAK,EAAE;AAA1C,eAFb;AAGC6K,cAAAA,SAHD,GAGY,0CAHZ;;AAIHlD,cAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,gBAAAA,IAAI,EAAE,YAAR;AAAsBiH,gBAAAA,OAAO,EAAEiE,SAA/B;AAAyChE,gBAAAA,OAAO,EAAPA;AAAzC,eAAd;AACH;;AAtC0B,+CAwCpB;AACHhH,cAAAA,IAAI,EAAE,UADH;AAEHF,cAAAA,IAAI,EAAE,uBAFH;AAGHG,cAAAA,OAAO,EAAE6H;AAHN,aAxCoB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAf9F,eAAe;AAAA;AAAA;AAAA,GAArB;AA+CP;;;;;;;;;;AAMO,IAAMiN,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO5O,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACpB,mCAAY;AAAEG,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBoO,cAAAA,UAAU,EAAE,IAA9B;AAAoChO,cAAAA,UAAU,EAAE;AAAhD,aAAZ,CADoB;;AAAA;AAAA,+CAGnB;AAAEV,cAAAA,IAAI,EAAE,MAAR;AAAgBF,cAAAA,IAAI,EAAE,OAAO;AAA7B,aAHmB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAdmP,cAAc;AAAA;AAAA;AAAA,GAApB;AAMP;;;;;;;;;;AAMO,IAAMC,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO7O,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAClB,mCAAY;AAAEG,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkB6O,cAAAA,UAAU,EAAEjP,IAAI,CAAC2D,EAAnC;AAAuCuL,cAAAA,aAAa,EAAElP,IAAI,CAACqE,KAA3D;AAAkEoH,cAAAA,YAAY,EAAE,IAAhF;AAAsF+C,cAAAA,UAAU,EAAE,KAAlG;AAAyGhO,cAAAA,UAAU,EAAE,mBAArH;AAA0IkL,cAAAA,SAAS,EAAE;AAArJ,aAAZ,CADkB;;AAAA;AAAA,+CAGjB;AACH5L,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE,OAAO,YAAP,GAAsBI,IAAI,CAAC4O;AAF9B,aAHiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAZI,YAAY;AAAA;AAAA;AAAA,GAAlB;AASP;;;;;;;;;;AAMO,IAAMG,6BAA6B;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOhP,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAChBgP,YAAY,CAAC7O,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,CADI;;AAAA;AACnCgG,YAAAA,UADmC;AAAA;AAAA,mBAEdjE,iBAAiB,CAAC5B,MAAD,EAASC,MAAT,CAFH;;AAAA;AAEnC8F,YAAAA,YAFmC;AAIzCA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AAJyC,+CAKlCsG,YALkC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAA7BiJ,6BAA6B;AAAA;AAAA;AAAA,GAAnC;AAQP;;;;;;;;;;AAMO,IAAMC,+BAA+B;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOjP,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAClB+O,cAAc,CAAC5O,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,CADI;;AAAA;AACrCgG,YAAAA,UADqC;AAAA;AAAA,mBAEhBjE,iBAAiB,CAAC5B,MAAD,EAASC,MAAT,CAFD;;AAAA;AAErC8F,YAAAA,YAFqC;AAI3CA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AAJ2C,+CAKpCsG,YALoC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAA/BkJ,+BAA+B;AAAA;AAAA;AAAA,GAArC;AAQP;;;;;;;;;;AAMO,IAAMC,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOlP,MAAP,EAAeC,MAAf,EAAuB0L,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA,+CACfoB,iBAAiB,CAAC/M,MAAD,EAASC,MAAT,EAAiB0L,IAAjB,CADF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAVuD,UAAU;AAAA;AAAA;AAAA,GAAhB;;;;AAIA,IAAMC,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOnP,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACX,uCAAgB;AAAEG,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBqH,cAAAA,UAAU,EAAE;AAA9B,aAAhB,CADW;;AAAA;AACtBC,YAAAA,EADsB;;AAG5B,gBAAIA,EAAE,IAAIA,EAAE,CAACpH,KAAT,IAAkBoH,EAAE,CAACpH,KAAH,CAASE,UAAT,KAAwB,qBAA9C,EAAqE;AACjE;AACA,qDAAiBL,MAAjB,EAAyBuH,EAAE,CAACpH,KAAH,CAASqD,EAAlC,EAAsC+D,EAAE,CAACpH,KAAH,CAASI,cAA/C,EAA+DV,IAA/D;AACH;;AAN2B;AAAA,mBAQf4B,gBAAgB,CAACzB,MAAD,EAASC,MAAT,CARD;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAhBkP,gBAAgB;AAAA;AAAA;AAAA,GAAtB;;;;AAYA,IAAMC,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOpP,MAAP,EAAeC,MAAf,EAAuB0L,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACL,uCAAgB;AAAE3L,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBqH,cAAAA,UAAU,EAAE;AAA9B,aAAhB,CADK;;AAAA;AAChBC,YAAAA,EADgB;AAAA;AAAA,mBAEA,iCAAWvH,MAAX,EAAmBuH,EAAE,CAACpH,KAAH,CAASqD,EAA5B,EAAgCmI,IAAI,CAACR,MAArC,CAFA;;AAAA;AAEhBkE,YAAAA,OAFgB;AAGtBzQ,YAAAA,OAAO,CAACyM,IAAR,CAAa,aAAb,EAA4BgE,OAA5B,EAHsB,CAItB;;AAJsB,kBAKlB9H,EAAE,CAACpH,KAAH,CAASgI,kBAAT,KAAgC,mBALd;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAMLpG,aAAa,CAAC/B,MAAD,EAASC,MAAT,CANR;;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAQLwB,gBAAgB,CAACzB,MAAD,EAASC,MAAT,CARX;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAVmP,UAAU;AAAA;AAAA;AAAA,GAAhB;;;;AAaA,IAAME,oBAAoB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOtP,MAAP,EAAeC,MAAf,EAAuB0L,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEnBiC,qBAAqB,CAAC5N,MAAD,EAASC,MAAT,EAAiB0L,IAAjB,CAFF;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAApB2D,oBAAoB;AAAA;AAAA;AAAA,GAA1B;;;;AAKA,IAAMC,wBAAwB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOvP,MAAP,EAAeC,MAAf,EAAuBiL,OAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACN,sCAAgBlL,MAAhB,CADM;;AAAA;AAAA;AAC5BwP,YAAAA,WAD4B,UAC5BA,WAD4B;AAG9BlN,YAAAA,IAH8B,GAGvB,yBAAyB4I,OAAzB,GAAmC,4CAHZ;AAK9B7L,YAAAA,GAL8B,GAKxB,IAAIC,8BAAJ,EALwB;AAMpCD,YAAAA,GAAG,CAACG,GAAJ,CAAQ;AAAEC,cAAAA,IAAI,EAAE6C;AAAR,aAAR;AANoC;AAAA,mBAO9BmN,0BAAIC,gBAAJ,CAAqBF,WAArB,EAAkCvP,MAAlC,EAA0CZ,GAA1C,CAP8B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAxBkQ,wBAAwB;AAAA;AAAA;AAAA,GAA9B;;;;AAUA,IAAMI,yBAAyB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO3P,MAAP,EAAeC,MAAf,EAAuBiL,OAAvB,EAAgC0E,oBAAhC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACP,sCAAgB5P,MAAhB,CADO;;AAAA;AAAA;AAC7BwP,YAAAA,WAD6B,UAC7BA,WAD6B;AAG/BlN,YAAAA,IAH+B,GAGxB,4DACP4I,OADO,GAEP,oBAFO,GAGP0E,oBAN+B;AAQ/BvQ,YAAAA,GAR+B,GAQzB,IAAIC,8BAAJ,EARyB;AASrCD,YAAAA,GAAG,CAACG,GAAJ,CAAQ;AAAEC,cAAAA,IAAI,EAAE6C;AAAR,aAAR;AATqC;AAAA,mBAU/BmN,0BAAIC,gBAAJ,CAAqBF,WAArB,EAAkCvP,MAAlC,EAA0CZ,GAA1C,CAV+B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAzBsQ,yBAAyB;AAAA;AAAA;AAAA,GAA/B;AAaP;;;;;;;;;AAKO,IAAME,kBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO7P,MAAP,EAAeC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACxB,mCAAY;AAAED,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA;AAAV,aAAZ,CADwB;;AAAA;AAAA;AAAA,mBAGZgC,YAAY,EAHA;;AAAA;AAGxB5C,YAAAA,GAHwB;AAI9BA,YAAAA,GAAG,CAACI,IAAJ,GAAW,wBAAwB,MAAxB,GAAiCJ,GAAG,CAACI,IAAhD;AAJ8B,+CAMvBJ,GANuB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAlBwQ,kBAAkB;AAAA;AAAA;AAAA,GAAxB;;;;AASA,IAAMC,yBAAyB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO9P,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB,EAA6BwC,IAA7B,EAAmCD,MAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACZiD,WAAW,CAACrF,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,EAAuBwC,IAAvB,EAA6BD,MAA7B,CADC;;AAAA;AAC/ByD,YAAAA,UAD+B;AAAA;AAAA,mBAEVzE,cAAc,CAACpB,MAAD,EAASC,MAAT,CAFJ;;AAAA;AAE/B8F,YAAAA,YAF+B;AAIrCA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AAJqC,+CAK9BsG,YAL8B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAzB+J,yBAAyB;AAAA;AAAA;AAAA,GAA/B;;;;AASA,IAAMC,yBAAyB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAO/P,MAAP,EAAeC,MAAf,EAAuBO,QAAvB,EAAiC4B,MAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACZ+E,WAAW,CAACnH,MAAD,EAASC,MAAT,EAAiBO,QAAjB,EAA2B4B,MAA3B,CADC;;AAAA;AAC/ByD,YAAAA,UAD+B;AAAA;AAAA,mBAEVzE,cAAc,CAACpB,MAAD,EAASC,MAAT,CAFJ;;AAAA;AAE/B8F,YAAAA,YAF+B;AAIrCA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AAJqC,+CAK9BsG,YAL8B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAzBgK,yBAAyB;AAAA;AAAA;AAAA,GAA/B;AAQP;;;;;;;;;;;AAOO,IAAM3O,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOpB,MAAP,EAAeC,MAAf,EAAuB+I,KAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACpB,mCAAY;AAAEhJ,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE,UAA9B;AAA0CE,cAAAA,cAAc,EAAEyI;AAA1D,aAAZ,CADoB;;AAAA;AAAA;AAAA,mBAGD,yCAAchJ,MAAd,CAHC;;AAAA;AAGpBgQ,YAAAA,UAHoB;AAKtB1N,YAAAA,IALsB,GAKf,EALe;;AAM1B,gBAAI0G,KAAJ,EAAW;AACP1G,cAAAA,IAAI,6BAAsB0G,KAAtB,qCAAJ;AACH,aAFD,MAEO;AACH1G,cAAAA,IAAI,GAAG,0BAAP;AACH;;AAEKmF,YAAAA,QAZoB,GAYT,EAZS;AAAA;AAAA;AAAA;AAAA;AAAA,0BAaTuI,UAbS;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAajBrE,YAAAA,IAbiB;;AAAA,kBAclB3C,KAAK,IAAI,CAAC2C,IAAI,CAACsE,QAdG;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAiBhB3J,YAAAA,KAjBgB,GAiBR;AAAE9C,cAAAA,EAAE,EAAEmI,IAAI,CAACnI,EAAX;AAAekL,cAAAA,IAAI,EAAE/C,IAAI,CAAC+C;AAA1B,aAjBQ;AAkBhB/H,YAAAA,SAlBgB,GAkBN;AAAElH,cAAAA,IAAI,EAAE,OAAR;AAAiBI,cAAAA,IAAI,EAAEyG,KAAvB;AAA8BxG,cAAAA,KAAK,EAAE;AAArC,aAlBM;;AAoBtB2H,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAEkM,IAAI,CAAC+C,IAAb;AAAmBhI,cAAAA,OAAO,EAAEiF,IAAI,CAAC+C,IAAjC;AAAuC/H,cAAAA,OAAO,EAAPA;AAAvC,aAAd;;AApBsB;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAuBpBA,YAAAA,OAvBoB,GAuBV;AAAElH,cAAAA,IAAI,EAAE,QAAR;AAAkBI,cAAAA,IAAI,EAAE,sBAAxB;AAAgDC,cAAAA,KAAK,EAAE;AAAvD,aAvBU;;AAwB1B2H,YAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,cAAAA,IAAI,EAAE,sBAAR;AAAgCiH,cAAAA,OAAO,EAAE,sBAAzC;AAAiEC,cAAAA,OAAO,EAAPA;AAAjE,aAAd;;AAxB0B,+CA0BnB;AACHhH,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE6C,IAFH;AAGH1C,cAAAA,OAAO,EAAE6H;AAHN,aA1BmB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAdrG,cAAc;AAAA;AAAA;AAAA,GAApB;;;;AAiCA,IAAM8O,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOlQ,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAClB,mCAAY;AAAEG,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBgE,cAAAA,UAAU,EAAEpE,IAAI,CAAC2D,EAAnC;AAAuC2M,cAAAA,SAAS,EAAE;AAAlD,aAAZ,CADkB;;AAAA;AAAA,+CAGjB;AACHxQ,cAAAA,IAAI,EAAE,MADH;AAEHF,cAAAA,IAAI,EAAE,OAAO,aAAP,GAAuBI,IAAI,CAAC6O;AAF/B,aAHiB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAZwB,YAAY;AAAA;AAAA;AAAA,GAAlB;;;;AAUA,IAAME,sBAAsB;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOpQ,MAAP,EAAeC,MAAf,EAAuBJ,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACTqQ,YAAY,CAAClQ,MAAD,EAASC,MAAT,EAAiBJ,IAAjB,CADH;;AAAA;AAC5BgG,YAAAA,UAD4B;AAAA;AAAA,mBAEP3E,aAAa,CAAClB,MAAD,EAASC,MAAT,EAAiBJ,IAAI,CAAC2D,EAAtB,CAFN;;AAAA;AAE5BuC,YAAAA,YAF4B;AAIlCA,YAAAA,YAAY,CAACtG,IAAb,GAAoBoG,UAAU,CAACpG,IAAX,GAAkB,MAAlB,GAA2BsG,YAAY,CAACtG,IAA5D;AAJkC,+CAK3BsG,YAL2B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAtBqK,sBAAsB;AAAA;AAAA;AAAA,GAA5B;;;;AAQA,IAAMlP,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,mBAAOlB,MAAP,EAAeC,MAAf,EAAuBgE,UAAvB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACR,uCAAgB;AAAEjE,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBqH,cAAAA,UAAU,EAAE;AAA9B,aAAhB,CADQ;;AAAA;AACnBC,YAAAA,EADmB;AAGzB,gBAAI,CAACtD,UAAL,EACIA,UAAU,GAAGsD,EAAE,CAACpH,KAAH,CAASgK,mBAAtB,CAJqB,CAMzB;;AANyB,kBAOrB5C,EAAE,CAACpH,KAAH,CAASwJ,aAAT,GAAyB,CAAzB,IAA8BpC,EAAE,CAACpH,KAAH,CAAS0J,gBAAT,IAA6BtC,EAAE,CAACpH,KAAH,CAASwJ,aAP/C;AAAA;AAAA;AAAA;;AAAA,+CAQdpI,YAAY,CAACvB,MAAD,EAASC,MAAT,EAAiB,CAAjB,EAAoBsH,EAApB,CARE;;AAAA;AAAA;AAAA,mBAWE,uCAAYvH,MAAZ,EAAoBiE,UAApB,CAXF;;AAAA;AAWfgK,YAAAA,QAXe;;AAAA,iBAajBA,QAAQ,CAACoC,aAbQ;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAcc,0CAAiBrQ,MAAjB,EAAyBiE,UAAzB,CAdd;;AAAA;AAcX4E,YAAAA,gBAdW;;AAAA,kBAiBbA,gBAAgB,CAAC/D,MAAjB,KAA4B,CAjBf;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAkBM,8BAAQ9E,MAAR,EAAgB6I,gBAAgB,CAAC,CAAD,CAAhC,CAlBN;;AAAA;AAkBPE,YAAAA,IAlBO;AAmBPuH,YAAAA,QAnBO,GAmBI;AACb9M,cAAAA,EAAE,EAAEuF,IAAI,CAACvF,EADI;AAEbuF,cAAAA,IAAI,EAAEA,IAAI,CAACA,IAFE,CAIjB;;AAJiB,aAnBJ;AAAA,+CAwBNU,kBAAkB,CAACzJ,MAAD,EAASC,MAAT,EAAiBqQ,QAAjB,CAxBZ;;AAAA;AA0Bb;AACA,+CAAY;AAAEtQ,cAAAA,MAAM,EAANA,MAAF;AAAUC,cAAAA,MAAM,EAANA,MAAV;AAAkBI,cAAAA,UAAU,EAAE;AAA9B,aAAZ;AAEMuI,YAAAA,KA7BO,GA6BC,sBA7BD;AA+BPnB,YAAAA,QA/BO,GA+BI,EA/BJ;AAAA;AAAA,mBAgCO,+BAASzH,MAAT,EAAiB6I,gBAAjB,CAhCP;;AAAA;AAgCPC,YAAAA,KAhCO;;AAkCb,iBAAS3C,CAAT,GAAa,CAAb,EAAgBA,CAAC,GAAG2C,KAAK,CAAChE,MAA1B,EAAkCqB,CAAC,EAAnC,EAAuC;AAC7BG,cAAAA,KAD6B,GACrB;AAAE9C,gBAAAA,EAAE,EAAEsF,KAAK,CAAC3C,CAAD,CAAL,CAAS3C,EAAf;AAAmBuF,gBAAAA,IAAI,EAAED,KAAK,CAAC3C,CAAD,CAAL,CAAS4C,IAAlC;AAAwCC,gBAAAA,KAAK,EAAEF,KAAK,CAAC3C,CAAD,CAAL,CAAS6C;AAAxD,eADqB;;AAEnCvB,cAAAA,QAAQ,CAACjD,IAAT,CAAc;AAAE/E,gBAAAA,IAAI,EAAEqJ,KAAK,CAAC3C,CAAD,CAAL,CAAS4C,IAAjB;AAAuBlJ,gBAAAA,IAAI,EAAEyG,KAA7B;AAAoCxG,gBAAAA,KAAK,EAAE;AAA3C,eAAd;AACH;;AArCY,+CAuCN;AACHH,cAAAA,IAAI,EAAE,SADH;AAEHF,cAAAA,IAAI,EAAEmJ,KAFH;AAGHhJ,cAAAA,OAAO,EAAE6H;AAHN,aAvCM;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBA8CJlG,YAAY,CAACvB,MAAD,EAASC,MAAT,EAAiB,CAAjB,CA9CR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAbiB,aAAa;AAAA;AAAA;AAAA,GAAnB","sourcesContent":["import util from 'util';\nimport fs from 'fs';\nimport { Bot, Elements, QuickReplies } from 'facebook-messenger-bot';\nimport {\n    getOnePageToken,\n    getOnePageData, sendPassThreadControl,\n} from '../controllers/pagesController';\nimport { getPricingSizing, getPricings } from '../controllers/pricingsController';\nimport { getFlavors } from '../controllers/flavorsController';\nimport { getToppingsFull } from '../controllers/toppingsController';\nimport { getCardapio } from './show_cardapio';\nimport { getSizes, getSize } from '../controllers/sizesController';\nimport { getBeverages } from '../controllers/beveragesController';\nimport { getTodayOpeningTime, getStoreData } from '../controllers/storesController';\nimport { updateOrder, getOrderPending, cancelOrder } from '../controllers/ordersController';\nimport {\n    getAddressLocation,\n    getCustomerAddress, formatAddrData, notifyUserStopAuto,\n} from '../controllers/customersController';\nimport {\n    updateStatusSpecificItem, deleteItem,\n    updateItemDirect, deletePendingItem, updateItemStatus,\n} from '../controllers/itemsController';\nimport { formatWhatsappNumber, formatAsCurrency } from '../util/util';\nimport { getCategories, getCategory } from '../controllers/categoriesController';\n\n// TODO: create a debugger with json format\nvar log_file = fs.createWriteStream(__dirname + '/debug.log', { flags: 'w' });\nvar log_stdout = process.stdout;\n\nconsole.log = function (d) { //\n    log_file.write(util.format(d) + '\\n');\n    log_stdout.write(util.format(d) + '\\n');\n};\n\nconst MSG_GENERAL_ERROR = 'Ops, estamos com um probleminha técnico: ';\n\n// // create a custom timestamp format for log statements\n// const SimpleNodeLogger = require('simple-node-logger'),\n//     opts = {\n//         logFilePath: 'logs/bot.log',\n//         timestampFormat: 'YYYY-MM-DD HH:mm:ss.SSS'\n//     },\n//     log = SimpleNodeLogger.createSimpleLogger(opts);\n\nexport const sendErrorMsg = async (_errorMsg) => {\n    const out = new Elements();\n    let _showErrorMsg = _errorMsg || 'ERRO DESCONHECIDO';\n    out.add({ text: MSG_GENERAL_ERROR + _showErrorMsg });\n    return out;\n}\n\n/**\n * Send Yes or No to the user asking if he wants to place an order right now.\n * @param {*} pageId\n * @param {*} userId\n */\nexport const askForContinue = async () => {\n    return {\n        type: 'replies',\n        text: 'Não entendi o que você quis dizer. 😞.\\n Vamos continuar com o pedido?',\n        options: [\n            { text: 'Sim', data: 'continueorder_yes', event: 'ORDER_CONTINUE_ORDER' },\n            { text: 'Não', data: 'continueorder_no', event: 'ORDER_CONTINUE_ORDER' },\n        ],\n    }\n}\n\nexport const checkLastAction = async (pageId, userId) => {\n    const pendingOrder = await getOrderPending({ pageId, userId });\n\n    if (pendingOrder.order) {\n        const wf = pendingOrder.order.waitingFor;\n        const wfd = pendingOrder.order.waitingForData;\n\n        if (wf === 'confirm_address') {\n            const addrData = await getCustomerAddress(pageId, userId);\n            return await confirmAddress(pageId, userId, addrData);\n        } else if (wf === 'location')\n            return await askForLocation(pageId, userId);\n        else if (wf === 'location_address') {\n            const location = {\n                lat: pendingOrder.order.location_lat,\n                long: pendingOrder.order.location_long,\n                url: pendingOrder.order.location_url,\n            }\n            return await confirmLocationAddress(pageId, userId, location);\n        } else if (wf === 'size')\n            return await askForSizeCat(pageId, userId)\n        else if (wf === 'deliver')\n            return await askForDeliver(pageId, userId);\n        else if (wf === 'category')\n            return await askForCategory(pageId, userId, wfd);\n        else if (wf === 'quantity')\n            return await askForQuantity(pageId, userId);\n        else if (wf === 'split')\n            return checkSplit(pageId, userId, 1);\n        else if (wf === 'flavor')\n            return await askForFlavor(pageId, userId, 1);\n        else if (wf === 'change_order')\n            return await askForChangeOrder(pageId, userId);\n        else if (wf === 'partial_confirmation')\n            return await showPartialOrder(pageId, userId);\n        else if (wf === 'want_beverage')\n            return await askForWantBeverage(pageId, userId);\n        else if (wf === 'beverage')\n            return await askForBeverages(pageId, userId, 1);\n        else if (wf === 'payment_type')\n            return await askForPaymentType(pageId, userId);\n        else if (wf === 'payment_change')\n            return await askForPaymentChange(pageId, userId);\n        else if (wf === 'comments')\n            return await askForComments(pageId, userId);\n        else if (wf === 'full_confirmation')\n            return await showFullOrder(pageId, userId);\n        else if (wf === 'nothing')\n            return await showOrderOrNextItem(pageId, userId);\n        else\n            return await sendMainMenu();\n    } else\n        return await sendMainMenu();\n}\n\nexport const optionsStopOrder = async () => {\n    return {\n        type: 'replies',\n        text: 'Muito bem, aqui estão as opções:',\n        options: [\n            { text: 'Voltar p/ Início', data: 'stoporder_init', event: 'STOP_ORDER_OPTIONS' },\n            { text: 'Falar c/ Atendente', data: 'stoporder_human', event: 'STOP_ORDER_OPTIONS' },\n        ],\n    }\n}\n\nexport const passThreadControl = async (pageId, userId, source, user) => {\n    let _txt = 'Ok, a partir de agora você está nas mãos do nosso atendente.';\n    _txt += ' O que você escrever a partir de agora será respondido por uma pessoa,'\n    _txt += 'o mais rápido possível!';\n\n    if (source === 'whatsapp') {\n        notifyUserStopAuto(pageId, userId, user);\n    }\n    try {\n        await sendPassThreadControl(pageId, userId, source);\n        return { type: 'text', text: _txt };\n    } catch (err) {\n        console.error(err);\n        return { type: 'text', text: _txt };\n    }\n}\n\n/**\n *\n * @param {*} sender\n * @param {*} pageID\n */\nexport const sendWelcomeMessage = async (pageID, sender) => {\n    let _nameToReplace = '';\n    if (sender && typeof sender !== 'string') {\n        // This only works on Facebook\n        await sender.fetch('first_name');\n        _nameToReplace = sender.first_name;\n    } else if (sender && typeof sender === 'string')\n        _nameToReplace = sender;\n\n    const page = await getOnePageData(pageID);\n    const replyMsg = page.firstResponseText.replace('$NAME', _nameToReplace);\n\n    return { type: 'text', text: replyMsg };\n}\n\nexport const sendMainMenu = async () => {\n    return {\n        type: 'buttons',\n        text: 'Por favor escolha uma das opções',\n        options: [\n            { text: '🍕 Cardápio', data: 'CARDAPIO_PAYLOAD', event: 'MAIN-MENU' },\n            { text: '🕒 Horários', data: 'HORARIO_PAYLOAD', event: 'MAIN-MENU' },\n            { text: '📨 Fazer Pedido', data: 'PEDIDO_PAYLOAD', event: 'MAIN-MENU' },\n            { text: '🗣 Falar c/ Atendente', data: 'stoporder_human', event: 'MAIN-MENU' },\n        ],\n    };\n\n    // const buttons = new Buttons();\n    // buttons.add({ text: '🍕 Cardápio', data: 'CARDAPIO_PAYLOAD', event: 'MAIN-MENU' });\n    // buttons.add({ text: '🕒 Horários', data: 'HORARIO_PAYLOAD', event: 'MAIN-MENU' });\n    // buttons.add({ text: '📨 Fazer Pedido', data: 'PEDIDO_PAYLOAD', event: 'MAIN-MENU' });\n\n    // const out = new Elements();\n    // out.add({ text: 'Por favor escolha uma das opções', buttons });\n\n    // return out;\n}\n\nexport const sendHorario = async (pageID, source) => {\n    const { todayIsOpen, todayOpenAt, todayCloseAt } = await getTodayOpeningTime(pageID);\n\n    let replyMsg = '';\n    if (todayIsOpen === true) {\n        replyMsg = 'Estamos abertos hoje, a partir das ' + todayOpenAt + ' horas, até às ' + todayCloseAt + ' horas.';\n    } else {\n        replyMsg = 'Infelizmente hoje não estamos abertos, mas você pode consultar nosso cardápio no menu principal.';\n    }\n\n    if (source && source === 'whatsapp') {\n        const reply = await sendMainMenu();\n        reply.text = replyMsg + '\\n\\n' + reply.text;\n        return reply;\n    } else\n        return { type: 'text', text: replyMsg };\n}\n\n/**\n * Returns only the formatted text to be sent to the user\n * @param {*} pageID\n */\nexport const sendCardapio = async (pageID, data, source) => {\n    const replyMsg = await getCardapio(pageID, data.id);\n\n    if (source && source === 'whatsapp') {\n        const reply = await sendMainMenu();\n        reply.text = replyMsg + '\\n\\n' + reply.text;\n        return reply;\n    } else\n        return { type: 'text', text: replyMsg };\n}\n\n\n/**\n * Returns array of flavors. If sizeID was passed, only returns flavors with price.\n * @param {*} pageID\n * @param {*} sizeID\n */\nexport const getFlavorsAndToppings = async (pageID, categoryID, sizeID) => {\n    try {\n        const flavorArray = await getFlavors(pageID);\n        const allToppings = await getToppingsFull(pageID);\n        const pricings = await getPricings(pageID);\n        const flavorsWithPrice = [];\n        for (let flavor of flavorArray) {\n            if (categoryID && flavor.categoryId === categoryID) {\n                if (sizeID) {\n                    for (let price of pricings) {\n                        if (price.categoryId === flavor.categoryId && price.sizeId === sizeID) {\n                            flavor.price = price.price;\n                            break;\n                        }\n                    }\n                }\n                if (flavor.price) {\n                    flavor.toppingsNames = [];\n                    for (let tId of flavor.toppings) {\n                        for (let topping of allToppings) {\n                            if (topping.id === tId) {\n                                flavor.toppingsNames.push(topping.topping);\n                            }\n                        }\n                    }\n                    flavorsWithPrice.push(flavor);\n                }\n            }\n        }\n        return flavorsWithPrice;\n    } catch (flavorsAndToppingsErr) {\n        console.error({ flavorsAndToppingsErr });\n    }\n}\n\n\n/**\n * Send Yes or No to the user asking if he wants to place an order right now.\n */\nexport const askForWantOrder = async () => {\n    return {\n        type: 'replies',\n        text: 'Agora que você viu nosso cardápio, você está pronto para fazer o pedido?',\n        options: [\n            { text: 'Sim', data: 'wantorder_yes', event: 'ORDER_WANT_ORDER' },\n            { text: 'Não', data: 'wantorder_no', event: 'ORDER_WANT_ORDER' },\n        ],\n    };\n\n    // const out = new Elements();\n    // let _txt = 'Agora que você viu nosso cardápio, você está pronto para fazer o pedido?';\n    // out.add({ text: _txt });\n\n    // const replies = new QuickReplies();\n    // // replies.add({ text: \"Quantidade\", data: \"change_quantity\", event: 'ORDER_CHANGE' });\n    // replies.add({ text: \"Sim\", data: \"wantorder_yes\", event: 'ORDER_WANT_ORDER' });\n    // replies.add({ text: \"Não\", data: \"wantorder_no\", event: 'ORDER_WANT_ORDER' });\n    // out.setQuickReplies(replies);\n    // return out;\n}\n\nexport const askForDeliver = async (pageId, userId) => {\n    await updateOrder({ pageId, userId, waitingFor: 'deliver' });\n\n    const storeData = await getStoreData(pageId);\n    let _txt = '';\n\n    if (storeData.delivery_time) {\n        _txt += `👉 Tempo de entrega: ⏱ *${storeData.delivery_time}* minutos\\n`;\n    }\n    if (storeData.delivery_fees && storeData.delivery_fees.length > 0) {\n        _txt += 'Taxa de Entrega: ';\n        for (let delivFee of storeData.delivery_fees) {\n            _txt += `${formatAsCurrency(delivFee.fee)} (até ${delivFee.to} km) `\n        }\n        _txt += '\\n';\n    }\n    if (storeData.pickup_time) {\n        _txt += `👉 Para retirar aqui: ⏱ *${storeData.pickup_time}* minutos\\n`;\n    }\n\n    _txt += 'O pedido é para entregar ou você vem retirar aqui?'\n\n    return {\n        type: 'replies',\n        text: _txt,\n        options: [\n            {\n                text: 'Entregar',\n                data: { type: 'delivery', time: storeData.delivery_time },\n                event: 'ORDER_DELIVER',\n            },\n            {\n                text: 'Retirar',\n                data: { type: 'pickup', time: storeData.pickup_time, address: storeData.address },\n                event: 'ORDER_DELIVER',\n            },\n        ],\n    }\n}\n\nexport const showDeliver = async (pageId, userId, data, user, source) => {\n    let _phone = null;\n    if (source && source === 'whatsapp') {\n        _phone = formatWhatsappNumber(userId);\n    }\n\n    await updateOrder({\n        pageId, userId,\n        deliverType: data.type, deliverTime: data.time, storeAddress: data.address,\n        user: user,\n        phone: _phone, source: source,\n    });\n\n    let _txtReply;\n    if (data && data.type === 'delivery')\n        _txtReply = 'Entregaremos o seu pedido.';\n    else {\n        _txtReply = 'Retirar o pedido conosco.\\n';\n        if (data.address)\n            _txtReply += '📌 Nosso endereço: ' + data.address;\n    }\n\n    return {\n        type: 'text',\n        text: '✅ ' + _txtReply,\n    };\n}\n\nexport const showDeliverCheckAddress = async (pageId, userId, data, user, source) => {\n    const prevAnswer = await showDeliver(pageId, userId, data, user, source);\n    const nextQuestion = await confirmAddressOrAskLocation(pageId, userId, user, source)\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\n/**\n * Question No.01\n * If the user doesnt have an address in the database, this will be the first question.\n */\nexport const askForLocation = async (pageId, userId, user, source) => {\n\n    let _phone = null;\n    if (source && source === 'whatsapp') {\n        _phone = formatWhatsappNumber(userId);\n    }\n\n    await updateOrder({ pageId, userId, user, waitingFor: 'location', phone: _phone, source: source });\n\n    if (!source || source === 'messenger') {\n        return {\n            type: 'replies',\n            text: 'Para começar, preciso saber aonde você está. Por favor clique no botão abaixo para me mandá-la.',\n            options: [\n                { text: 'Localização', isLocation: true, data: 'location_location', event: 'LOCATION' },\n            ],\n        }\n    } else if (source === 'whatsapp') {\n        return {\n            type: 'text',\n            text: 'Para começar, preciso saber aonde você está. Favor enviar a sua localização.',\n            options: [\n                { text: 'Localização', data: 'location_location', event: 'LOCATION' },\n            ],\n        }\n    }\n}\n\n\nexport const confirmLocationAddress = async (pageId, userId, location, user) => {\n    if (location) {\n        await updateOrder({ pageId, userId, location, user, waitingFor: 'location_address' });\n\n        const addresses = await getAddressLocation(location);\n\n        if (addresses && addresses.length && addresses.length > 0) {\n\n            let foundAnyCompleteAddress = false;\n            const options = [];\n            for (let i = 0; i < 4; i++) {\n                const element = addresses[i];\n                if (element.address_components && element.address_components.length >= 6) {\n                    foundAnyCompleteAddress = true;\n                    const _data = { formatted_address: element.formatted_address, address_components: element.address_components };\n                    const button = { text: 'Esse!', data: _data, event: 'LOCATION_ADDRESS' };\n                    let addressNumber = i + 1;\n                    options.push({ text: 'Endereço ' + addressNumber, subtext: element.formatted_address, buttons: button });\n                }\n            }\n\n            if (foundAnyCompleteAddress) {\n                const buttonsOpt = { data: 'incorrect_address', event: 'LOCATION_ADDRESS' };\n                options.push({\n                    text: 'Não é meu endereço..',\n                    subtext: 'Selecione essa opção se seu endereço não aparece',\n                    buttons: buttonsOpt,\n                    isOnlyButtons: true,\n                });\n                return {\n                    type: 'list',\n                    text: 'Encontrei esses endereços, selecione o correto:',\n                    options: options,\n                };\n            } else {\n                return await askToTypeAddress(pageId, userId);\n            }\n        } else {\n            return await askToTypeAddress(pageId, userId);\n        }\n    } else {\n        return await askToTypeAddress(pageId, userId);\n    }\n}\n\nexport const confirmAddressOrAskLocation = async (pageId, userId, user, source) => {\n\n    // TODO: check if the location is in the neighborhood.\n    // TODO: check if the location is the same as stored in db.\n    const addrData = await getCustomerAddress(pageId, userId);\n\n    if (addrData) {\n        return confirmAddress(pageId, userId, addrData, user, source);\n    } else {\n        return await askForLocation(pageId, userId, user, source);\n    }\n}\n\nexport const askToTypeAddress = async (pageID, userID) => {\n    await updateOrder({ pageId: pageID, userId: userID, waitingForAddress: true, waitingFor: 'typed_address' });\n\n    return {\n        type: 'text',\n        text: 'Não foi possível localizar um endereço válido. Digite o seu endereço completo por favor.',\n    }\n}\n\nexport const confirmAddress = async (pageId, userId, addrData, user, source) => {\n    let _phone = null;\n    if (source && source === 'whatsapp') {\n        _phone = formatWhatsappNumber(userId);\n    }\n\n    if (user)\n        await updateOrder({\n            pageId, userId, user, waitingForAddress: false,\n            waitingFor: 'confirm_address', phone: _phone,\n        });\n    else\n        await updateOrder({\n            pageId, userId, waitingForAddress: false,\n            waitingFor: 'confirm_address', phone: _phone,\n        });\n\n    let _replyText = 'A entrega será para esse endereço?\\n';\n    _replyText = _replyText + addrData.formattedAddress;\n\n    return {\n        type: 'replies',\n        text: _replyText,\n        options: [\n            { text: 'Sim', data: addrData, event: 'CORRECT_SAVED_ADDRESS' },\n            { text: 'Não', data: addrData, event: 'WRONG_SAVED_ADDRESS' },\n        ],\n    }\n}\n\nexport const showAddress = async (pageId, userId, addrData, source) => {\n    let _phone = null;\n    if (source && source === 'whatsapp') {\n        _phone = formatWhatsappNumber(userId);\n    }\n\n    if (addrData && addrData.address_components) {\n        const formattedAddrData = await formatAddrData(addrData);\n        await updateOrder({ pageId, userId, addrData: formattedAddrData, phone: _phone });\n    } else {\n        await updateOrder({ pageId, userId, addrData, phone: _phone });\n    }\n\n    return {\n        type: 'text',\n        text: 'Ok, entregaremos nesse endereço.',\n    }\n}\n\n\nexport const showOrderOrAskForPhone = async (pageId, userId) => {\n    const po = await getOrderPending({ pageId, userId, isComplete: false });\n\n    if (po.order && po.order.waitingFor === 'partial_confirmation')\n        return await showOrderOrNextItem(pageId, userId);\n    else\n        return await askForPhone(pageId, userId);\n}\n\nexport const askForPhone = async (pageId, userId) => {\n    await updateOrder({ pageId, userId, waitingFor: 'phone' });\n\n    const _txt = 'Pode nos enviar o seu telefone para confirmar o seu pedido? Se não aparecer o seu telefone (ou estiver errado), use a opção digitar.';\n\n    const _options = []\n    _options.push({ text: 'Telefone', isPhoneNumber: true, data: 'phone_number', event: 'PHONE_NUMBER' });\n    _options.push({ text: 'Digitar o telefone', data: 'change_phone', event: 'PHONE_CONFIRMED' });\n\n    return {\n        type: 'replies',\n        text: _txt,\n        options: _options,\n    };\n}\n\nexport const askToTypePhone = async (pageId, userId) => {\n\n    await updateOrder({ pageId, userId, waitingFor: 'phone' });\n\n    const out = new Elements();\n    out.add({ text: 'Por favor, digite o número do telefone válido para que possamos confirmar o pedido. Pode digitar o 📞:' });\n    return out;\n}\n\nexport const confirmTypedPhone = async (pageId, userId, phone) => {\n    const out = new Elements();\n\n    await updateOrder({ pageId, userId, waitingFor: 'phone' });\n\n    let _txt = 'O telefone ' + phone + ' está coreto?';\n    out.add({ text: _txt });\n\n    const replies = new QuickReplies();\n    replies.add({ text: 'Sim', data: phone, event: 'PHONE_CONFIRMED' });\n    replies.add({ text: 'Não, usar outro', data: 'change_phone', event: 'PHONE_CONFIRMED' });\n    out.setQuickReplies(replies);\n\n    return out;\n}\n\n\nexport const showPhone = async (pageId, userId, phone) => {\n    await updateOrder({ pageId, userId, phone, waitingFor: 'nothing' });\n\n    const out = new Elements();\n    out.add({ text: 'Usaremos o número ' + phone + ' para confirmar o pedido. Agora vou pegar as informações do pedido.' });\n    return out;\n}\n\nexport const showDeliverAskForQuantity = async (pageId, userId, data, user, source) => {\n    const prevAnswer = await showDeliver(pageId, userId, data, user, source);\n    const nextQuestion = await askForQuantity(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\n/**\n * Show Address only stores the addres in database. Ignoring the return.\n * The user is gonna see the AskForQuantity.\n * Used on Whatsapp.\n * @param {*} pageId\n * @param {*} userId\n * @param {*} addrData\n */\nexport const showAddressAskForQuantity = async (pageId, userId, addrData, source) => {\n    const prevAnswer = await showAddress(pageId, userId, addrData, source);\n    let nextQuestion;\n\n    // Show Address can be called from the creation order flow or from\n    // the update order flow. Below, if it was called from the update order\n    // flow, I am gonna return the flow to the showOrder or showFullOrder\n    const po = await getOrderPending({ pageId, userId, isComplete: false });\n    if (po && po.order && po.order.backToConfirmation) {\n        if (po.order.backToConfirmation === 'full_confirmation') {\n            nextQuestion = await showFullOrder(pageId, userId);\n        } else if (po.order.backToConfirmation === 'partial_confirmation') {\n            nextQuestion = await showOrderOrNextItem(pageId, userId);\n        } else {\n            nextQuestion = await askForQuantity(pageId, userId);\n        }\n    } else {\n        nextQuestion = await askForQuantity(pageId, userId);\n    }\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\nexport const askForQuantity = async (pageId, userId) => {\n    await updateOrder({ pageId, userId, waitingFor: 'quantity' });\n\n    return {\n        type: 'replies',\n        text: 'Quantas pizzas você quer?',\n        options: [\n            { text: '1', whatsText: 'Uma', data: 'qty_1', event: 'ORDER_QTY' },\n            { text: '2', whatsText: 'Duas', data: 'qty_2', event: 'ORDER_QTY' },\n            { text: '3', whatsText: 'Três', data: 'qty_3', event: 'ORDER_QTY' },\n            { text: '+ de 3', data: 'qty_more', event: 'ORDER_QTY' },\n        ],\n    }\n}\n\nexport const askForQuantityMore = async (pageId, userId) => {\n    await updateOrder({ pageId, userId, waitingFor: 'quantity' });\n\n    return {\n        type: 'replies',\n        text: 'Quantas pizzas você quer?',\n        options: [\n            { text: '- de 4', data: 'qty_less', event: 'ORDER_QTY' },\n            { text: '4', whatsText: 'Quatro', data: 'qty_4', event: 'ORDER_QTY' },\n            { text: '5', whatsText: 'Cinco', data: 'qty_5', event: 'ORDER_QTY' },\n            { text: '6', whatsText: 'Seis', data: 'qty_6', event: 'ORDER_QTY' },\n        ],\n    }\n}\n\nexport const showQuantity = async (pageId, userId, data) => {\n    // data is 'qty_1', 'qty_2', 'qty_3'...\n    const qty = data.substr(data.length - 1, 1);\n\n    await updateOrder({ pageId, userId, qty, waitingFor: 'size', undo: 'quantity', currentItem: 1 });\n\n    let out;\n    if (qty == 1) {\n        out = {\n            type: 'text',\n            text: '✅ ' + ' 1 pizza.',\n        };\n    } else {\n        out = {\n            type: 'text',\n            text: '✅ ' + qty + ' pizzas.',\n        };\n    }\n\n    // out.text = out.text + '(digite 0 p/ desfazer)'\n\n    return out;\n}\n\nexport const askForSize = async (pageId, userId) => {\n\n    const po = await getOrderPending({ pageId, userId, isComplete: false });\n\n    if (po.order) {\n        let _text = '';\n        if (po.order.qty === 1) {\n            _text = 'Qual o tamanho da pizza?';\n        } else {\n            _text = 'Agora vou pegar os detalhes da ' + po.order.currentItem + 'a. pizza.\\n';\n            _text = _text + 'Qual o tamanho dela?';\n        }\n\n        const _options = [];\n        const sizesWithPricing = await getPricingSizing(pageId); // only sizes with pricing\n        const sizes = await getSizes(pageId, sizesWithPricing);\n        for (let i = 0; i < sizes.length; i++) {\n            const _data = { id: sizes[i].id, size: sizes[i].size, split: sizes[i].split };\n            _options.push({ text: sizes[i].size, data: _data, event: 'ORDER_SIZE' });\n        }\n\n        const out = {\n            type: 'replies',\n            text: _text,\n            options: _options,\n        }\n        if (po.order.qty === 1)\n            await updateOrder({ pageId, userId, waitingFor: 'size' });\n        else\n            await updateOrder({\n                pageId, userId, waitingFor: 'size',\n                qty_total: po.order.qty_total, currentItem: po.order.currentItem, eraseSplit: true,\n            });\n\n        return out;\n    } else {\n        const out = {\n            type: 'text',\n            text: MSG_GENERAL_ERROR,\n        };\n        return out;\n    }\n}\n\n/**\n * Calls ShowQuantity and AskForSize\n * Used on Whatsapp.\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showQuantityAskForSize = async (pageId, userId, data) => {\n    const prevAnswer = await showQuantity(pageId, userId, data);\n    const nextQuestion = await askForSize(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\nexport const showSize = async (pageId, userId, data) => {\n    if (data && data.split && data.split > 1)\n        await updateOrder({ pageId, userId, sizeId: data.id, undo: 'size', waitingFor: 'split' });\n    else\n        await updateOrder({ pageId, userId, sizeId: data.id, undo: 'size', waitingFor: 'flavor' });\n\n    return {\n        type: 'text',\n        text: '✅ ' + ' Tamanho: ' + data.size, // + ' (digite 0 p/ desfazer)',\n    };\n}\n\n/**\n * Triggered by action CHECK_SPLIT\n * @param {*} pageId\n * @param {*} userId\n * @param {*} multiple\n */\nexport const checkSplit = async (pageId, userId, multiple) => {\n    const pendingOrder = await getOrderPending({ pageId: pageId, userId: userId, isComplete: true });\n    if (pendingOrder.order) {\n        const currentSize = await getSize(pageId, pendingOrder.order.currentItemSize);\n        // if split is gt than 1, ask user if he wants to split in more than one flavor.\n        if (currentSize.split && currentSize.split > 1) {\n            let _txt = 'A pizza ' + currentSize.size + ' pode ser dividida em ' + currentSize.split + ' sabores.\\n';\n            _txt = _txt + 'Escolha quantos sabores você quer:';\n\n            const _options = [];\n            for (let i = 1; i <= currentSize.split; i++) {\n                let _replyText = i === 1 ? i + ' Sabor' : i + ' Sabores';\n                _options.push({ text: _replyText, data: i, event: 'ORDER_SPLIT' });\n            }\n\n            return {\n                type: 'replies',\n                text: _txt,\n                options: _options,\n            };\n        } else {\n            return await askForFlavorOrConfirm(pageId, userId, multiple);\n        }\n    }\n}\n\nexport const showSizeCheckSplit = async (pageId, userId, data, multiple) => {\n    const prevAnswer = await showSize(pageId, userId, data);\n    const nextQuestion = await checkSplit(pageId, userId, multiple);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n/**\n * After user answer if he wants to split the pizza, show the chosen option.\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n **/\nexport const showSplit = async (pageId, userId, data) => {\n    await updateOrder({\n        pageId, userId,\n        sizeId: data.id,\n        waitingFor: 'flavor',\n        originalSplit: data,\n    });\n\n    let _txtFlavor = data === 1 ? 'Sabor' : 'Sabores';\n\n    return {\n        type: 'text',\n        text: '✅ ' + data + ' ' + _txtFlavor,\n    };\n}\n\n\nexport const askForFlavorOrConfirm = async (pageId, userId, multiple) => {\n    const po = await getOrderPending({ pageId: pageId, userId: userId, isComplete: true });\n\n    if (po.order) {\n        if (po.order.originalSplit > 1 &&\n            po.order.originalSplit >= po.order.currentItemSplit) {\n            return await askForFlavor(pageId, userId, multiple, po);\n        } else {\n            if (po.items && po.items.length) {\n                for (let i = 0; i < po.items.length; i++) {\n                    if (po.items[i].status === 0 && po.items[i].flavorId > 0) {\n                        await updateStatusSpecificItem(po.items[i]._id, 1);\n                        return await showOrderOrNextItem(pageId, userId);\n                    }\n                }\n                return await askForFlavor(pageId, userId, multiple, po);\n            }\n        }\n    }\n}\n\nexport const showSplitCheckFlavor = async (pageId, userId, data) => {\n    const prevAnswer = await showSplit(pageId, userId, data);\n    // Changing based on categories\n    // const nextQuestion = await askForFlavorOrConfirm(pageId, userId, 1);\n    const nextQuestion = await askForFlavor(pageId, userId, 1);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\n/**\n *\n * @param {*} pageId\n * @param {*} userId\n * @param {*} multiple: if are the first 4 flavors, multiple=1, if are the next, multiple=2 and so on.\n */\nexport const askForFlavor = async (pageId, userId, multiple, pendingOrder) => {\n\n    let po = null;\n    if (pendingOrder && pendingOrder.order)\n        po = pendingOrder;\n    else po = await getOrderPending({ pageId: pageId, userId: userId, isComplete: false });\n\n    const flavorsArray = await getFlavorsAndToppings(pageId, po.order.currentItemCategory, po.order.currentItemSize);\n\n    // This variable will be passed as split parameter to updateOrder, so,\n    // updateOrder can update the item properly, with the value of originalSplit.\n    let _splitForTheItem = po.order.originalSplit;\n\n    // In case where the user typed an option wrongly, the bot invokes askForFlavor\n    // without the split parameter. So, because of this situation, I am retrieving\n    // the split from the order.\n    let currentSplit;\n    if (po.order.originalSplit > 1) {\n        if (!po.order.currentItemSplit) {\n            currentSplit = 1;\n        } else {\n            currentSplit = po.order.currentItemSplit;\n        }\n    }\n\n    // Rule to show 'Escolha o 1o. sabor', 'Escolha o 2o. sabor'\n    let _txt = 'Escolha o produto:'\n    if (currentSplit) {\n        // First time currentItemSplit is undefined, so, I am gonna use the originalSplit itself.\n        _txt = `Escolha o ${currentSplit}o. sabor:`\n    }\n\n    const NUMBER_OF_ITEMS = 10;\n\n    let _rangeIni = (multiple - 1) * NUMBER_OF_ITEMS;\n    let _rangeEnd = multiple * NUMBER_OF_ITEMS;\n\n    const _options = [];\n\n    for (let i = 0; i < flavorsArray.length; i++) {\n        if (flavorsArray[i]) {\n            const _fl = flavorsArray[i];\n            const _data = { id: _fl.id, flavor: _fl.flavor, price: _fl.price }\n            let _subtext = '';\n            if (_fl.toppingsNames && _fl.toppingsNames.length > 0)\n                _subtext = _fl.toppingsNames.join() + '\\n';\n            if (_fl.price) {\n                _subtext = _subtext.concat('R$', _fl.price);\n            }\n            const buttons = { text: 'Quero', data: _data, event: 'ORDER_FLAVOR' };\n\n            if (i >= _rangeIni && i < _rangeEnd)\n                _options.push({ text: _fl.flavor, subtext: _subtext, buttons });\n            else\n                _options.push({ text: _fl.flavor, subtext: _subtext, buttons, hidden: true });\n        }\n    }\n\n\n    if (flavorsArray.length > _rangeEnd) {\n        const buttons = { text: 'Voltar', data: currentSplit, event: 'ORDER_ASK_CATEGORY' };\n        _options.push({ text: 'Ver outra categoria', subtext: 'Ver outra categoria', buttons, hidden: true });\n\n        multiple++;\n        const buttonsOpt = {\n            text: '+ Opções',\n            data: { option: 'flavors_more', multiple: multiple }, event: 'ORDER_FLAVOR',\n        };\n        _options.push({\n            text: 'Ver + sabores', subtext: '+ sabores do cardápio',\n            buttons: buttonsOpt, isOnlyButtons: true,\n        });\n    } else {\n        const buttons = { text: 'Voltar', data: currentSplit, event: 'ORDER_ASK_CATEGORY' };\n        _options.push({ text: 'Ver outra categoria', subtext: 'Ver outra categoria', buttons });\n    }\n\n    updateOrder({\n        pageId, userId, waitingFor: 'flavor',\n        currentItemSplit: currentSplit,\n        currentItem: po.order.currentItem,\n        split: _splitForTheItem,\n    });\n\n    return {\n        type: 'fulllist',\n        text: _txt,\n        options: _options,\n    };\n}\n\nexport const showFlavor = async (pageId, userId, data) => {\n    const po = await getOrderPending({ pageId: pageId, userId: userId, isComplete: false });\n    let currentSplit;\n    let itemId;\n    let origSplit = po.order.originalSplit;\n    let orderId = po.order.id;\n    if (origSplit > 1 && po.order.currentItemSplit <= origSplit) {\n        if (po.order.currentItemSplit === 1)\n            itemId = po.order.currentItem ? po.order.currentItem + 1 : 1;\n        else\n            itemId = po.order.currentItem;\n\n        currentSplit = po.order.currentItemSplit + 1;\n    } else {\n        itemId = po.order.currentItem ? po.order.currentItem + 1 : 1;\n    }\n\n    let _complete = false;\n    if (origSplit > 1 && currentSplit > origSplit)\n        _complete = true;\n    else if (!po.order.originalSplit || origSplit === 1)\n        _complete = true;\n\n\n    console.info('showFlavor _complete:', _complete,\n        ' originalSplit:', po.order.originalSplit,\n        'currentSplit: ', currentSplit,\n        ' price: ', data.price);\n\n    await updateOrder({\n        pageId, userId, flavorId: data.id,\n        price: data.price,\n        completeItem: _complete,\n        waitingFor: 'nothing',\n        currentItemSplit: currentSplit,\n        currentItem: itemId,\n        categoryId: po.order.currentItemCategory,\n        calcTotal: true,\n    });\n\n    if (_complete) {\n        // without await, so, it can run later\n        updateItemStatus(pageId, orderId, itemId);\n    }\n\n    if (currentSplit) {\n        const showSplit = currentSplit - 1;\n        return {\n            type: 'text',\n            text: '✅ ' + showSplit + 'o. Sabor: ' + data.flavor,\n        };\n    } else {\n        return {\n            type: 'text',\n            text: '✅ ' + ' Sabor: ' + data.flavor,\n        };\n    }\n}\n\nexport const showOrderOrNextItem = async (pageId, userId) => {\n    const po = await getOrderPending({ pageId, userId, isComplete: true });\n\n    if (po.order.originalSplit > 1 && po.order.currentItemSplit <= po.order.originalSplit) {\n        return await askForCategory(pageId, userId, po.order.currentItemSplit);\n        // return await askForFlavor(pageId, userId, 1, po);\n    } else {\n        return await showPartialOrder(pageId, userId, po);\n        // await updateOrder({ pageId, userId, waitingFor: 'partial_confirmation', eraseSplit: true });\n\n        // let total_price = 0;\n        // _txt = _txt + '𝗣𝗲𝗱𝗶𝗱𝗼:' + po.order.id + '\\n';\n        // let _txt = 'Seguem os detalhes do seu pedido:\\n';\n        // for (let i = 0; i < po.items.length; i++) {\n        //     const _item = po.items[i];\n        //     if (_item.flavorId) {\n        //         let _txtQty = _item.split > 1 ? _item.qty + '/' + _item.split : _item.qty;\n\n        //         let _txtSize = '';\n        //         if (_item.sizeId)\n        //             _txtSize = _item.size;\n\n        //         _txt = _txt + `${_item.category}: ${_txtQty} ${_item.flavor} ${_txtSize} \\n`;\n        //     }\n        //     total_price += _item.price;\n        // }\n        // _txt = _txt + '𝗧𝗼𝘁𝗮𝗹: ' + formatAsCurrency(total_price) + '\\n\\n';\n\n        // _txt = _txt + 'Deseja incluir mais itens?';\n\n        // const _options = [];\n        // _options.push({\n        //     text: 'Sim, mostre-me as opções',\n        //     data: {\n        //         type: 'confirmation_yes',\n        //         backTo: 'partial_confirmation',\n        //     },\n        //     event: 'ORDER_ASK_CATEGORY',\n        // });\n        // _options.push({\n        //     text: 'Não, confirmar o pedido',\n        //     data: {\n        //         type: 'confirmation_yes',\n        //         backTo: 'partial_confirmation',\n        //     },\n        //     event: 'ORDER_PIZZA_CONFIRMATION',\n        // });\n\n        // return {\n        //     type: 'replies',\n        //     text: _txt,\n        //     options: _options,\n        // };\n    }\n}\n\nexport const cancelPendingShowPartialOrder = async (pageId, userId) => {\n    // TODO: delete items with status 0;\n    const po = await getOrderPending({ pageId, userId, isComplete: true });\n\n    if (po.items && po.items.length > 0) {\n        await deletePendingItem(pageId, po.order.id);\n\n        for (let i = 0; i < po.items.length; i++) {\n            if (po.items[i].status === 0) {\n                po.items.splice(i, 1);\n            }\n        }\n    }\n    return await showPartialOrder(pageId, userId, po);\n}\n\nexport const showPartialOrder = async (pageId, userId, po) => {\n    if (!po)\n        po = await getOrderPending({ pageId, userId, isComplete: true });\n\n    await updateOrder({ pageId, userId, waitingFor: 'partial_confirmation', eraseSplit: true, undo: '' });\n\n    let total_price = 0;\n    let _txt = '𝗣𝗲𝗱𝗶𝗱𝗼:' + po.order.id + '\\n';\n\n    if (po.items && po.items.length > 0) {\n        _txt = _txt + 'Seguem os detalhes do seu pedido:\\n\\n';\n        for (const item of po.items) {\n            if (item.flavorId) {\n                let _txtQty = item.split > 1 ? item.qty + '/' + item.split : item.qty;\n\n                let _txtSize = '';\n                if (item.sizeId)\n                    _txtSize = item.size;\n\n                // _txt = _txt + `${item.category}: ${_txtQty} ${item.flavor} ${_txtSize} - ${formatAsCurrency(item.price)} \\n`;\n                _txt = _txt + `${_txtQty} ${item.flavor} ${_txtSize} - ${formatAsCurrency(item.price)} \\n`;\n            }\n            if (item.price)\n                total_price += item.price;\n        }\n        if (po.order.deliver_type && po.order.deliver_type === 'delivery') {\n            if (po.order.delivery_fee > 0) {\n                _txt += `*Taxa de Entrega:* ${formatAsCurrency(po.order.delivery_fee)}\\n`\n                total_price += po.order.delivery_fee;\n            }\n        }\n        _txt = _txt + '𝗧𝗼𝘁𝗮𝗹: ' + formatAsCurrency(total_price) + '\\n\\n';\n\n    } else {\n        _txt = _txt + 'Ainda não foram incluídos itens no seu pedido.\\n\\n';\n    }\n\n    _txt = _txt + 'O que deseja fazer?';\n\n    const _options = [];\n    _options.push({\n        text: `Incluir ${po.items && po.items.length > 0 ? 'mais' : ''} itens no pedido`,\n        event: 'ORDER_ASK_CATEGORY',\n    });\n    if (po.items && po.items.length > 0) {\n        _options.push({\n            text: '*Confirmar o pedido*',\n            data: {\n                type: 'confirmation_yes',\n                backTo: 'partial_confirmation',\n            },\n            event: 'ORDER_PIZZA_CONFIRMATION',\n        });\n        _options.push({\n            text: 'Remover algum item',\n            data: {\n                backTo: 'partial_confirmation',\n                option: 'remove_item',\n            },\n            event: 'ORDER_WANT_CHANGE',\n        });\n        _options.push({\n            text: 'Observações em algum item',\n            data: {\n                backTo: 'partial_confirmation',\n                option: 'change_item',\n            },\n            event: 'ORDER_WANT_CHANGE',\n        });\n    }\n    _options.push({\n        text: 'Voltar p/ Início',\n        data: 'stoporder_init',\n        event: 'STOP_ORDER_OPTIONS',\n    });\n\n    return {\n        type: 'replies',\n        text: _txt,\n        options: _options,\n    };\n}\n\n\n// export const showOrderOrNextItem = async (pageId, userId) => {\n//     const po = await getOrderPending({ pageId, userId, isComplete: true });\n\n//     if (po.order.originalSplit > 1 && po.order.currentItemSplit <= po.order.originalSplit) {\n//         return await askForFlavor(pageId, userId, 1, po);\n//     } else if (po.order.qty > 1 && po.order.currentItem < po.order.qty) {\n//         const nextItem = po.order.currentItem + 1;\n//         await updateOrder({ pageId, userId, waitingFor: 'size', currentItem: nextItem });\n//         return await askForSize(pageId, userId);\n//     } else {\n//         await updateOrder({ pageId, userId, waitingFor: 'partial_confirmation', backToConfirmation: null });\n\n//         let total_price = 0;\n//         let _txt = 'Seguem os detalhes do seu pedido:\\n';\n//         _txt = _txt + '𝗣𝗲𝗱𝗶𝗱𝗼:' + po.order.id + '\\n';\n//         for (let i = 0; i < po.items.length; i++) {\n//             const _item = po.items[i];\n//             if (_item.flavorId && _item.sizeId) {\n//                 let _txtQty = _item.split > 1 ? _item.qty + '/' + _item.split : _item.qty;\n//                 _txt = _txt + `${_txtQty} pizza ${_item.size} de ${_item.flavor}\\n`;\n//             } else if (_item.beverageId && _item.beverage) {\n//                 _txt = _txt + `1 ${_item.beverage}\\n`;\n//             }\n//             total_price += _item.price;\n//         }\n//         if (po.order.deliver_type && po.order.deliver_type === 'pickup')\n//             _txt += 'Cliente vem retirar.'\n//         else\n//             _txt = _txt + '𝗘𝗻𝗱𝗲𝗿𝗲𝗰̧𝗼 𝗱𝗲 𝗘𝗻𝘁𝗿𝗲𝗴𝗮: ' + po.order.address + '\\n';\n//         _txt = _txt + '𝗧𝗲𝗹𝗲𝗳𝗼𝗻𝗲: ' + po.order.phone + '\\n';\n//         _txt = _txt + '𝗧𝗼𝘁𝗮𝗹: ' + formatAsCurrency(total_price) + '\\n';\n//         _txt = _txt + 'O pedido está correto?';\n\n//         const _options = [];\n//         _options.push({\n//             text: 'Sim',\n//             data: {\n//                 type: 'confirmation_yes',\n//                 backTo: 'partial_confirmation',\n//             },\n//             event: 'ORDER_PIZZA_CONFIRMATION',\n//         });\n//         _options.push({\n//             text: 'Não',\n//             data: {\n//                 type: 'confirmation_no',\n//                 backTo: 'partial_confirmation',\n//             },\n//             event: 'ORDER_PIZZA_CONFIRMATION',\n//         });\n\n//         return {\n//             type: 'replies',\n//             text: _txt,\n//             options: _options,\n//         };\n//     }\n// }\n\n\n/**\n * Used on Whatsapp\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showFlavorCheckItem = async (pageId, userId, data) => {\n    const prevAnswer = await showFlavor(pageId, userId, data);\n    const nextQuestion = await showOrderOrNextItem(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\nexport const askForPaymentType = async (pageId, userId) => {\n    const _options = [];\n\n    const storeData = await getStoreData(pageId);\n    if (storeData.payment_types && storeData.payment_types.length > 0) {\n        for (let paymentType of storeData.payment_types) {\n            let _txt = paymentType.payment_type;\n            if (paymentType.surcharge_percent > 0) {\n                _txt += ` (Cobramos + ${paymentType.surcharge_percent}% no valor do pedido)`;\n            } else if (paymentType.surcharge_amount > 0) {\n                _txt += ` (Cobramos + ${formatAsCurrency(paymentType.surcharge_amount)} no valor do pedido)`;\n            }\n\n            _options.push({\n                text: _txt, data: {\n                    payment_type: paymentType.payment_type,\n                    surcharge_percent: paymentType.surcharge_percent,\n                    surcharge_amount: paymentType.surcharge_amount,\n                }, event: 'ORDER_PAYMENT_TYPE',\n            });\n        }\n    } else {\n        _options.push({\n            text: 'Dinheiro', data: {\n                payment_type: 'Dinheiro', surcharge_percent: 0, surcharge_amonut: 0,\n            }, event: 'ORDER_PAYMENT_TYPE',\n        });\n        _options.push({\n            text: 'Cartão', data: {\n                payment_type: 'Cartão', surcharge_percent: 0, surcharge_amount: 0,\n            }, event: 'ORDER_PAYMENT_TYPE',\n        });\n    }\n\n\n    await updateOrder({ pageId, userId, waitingFor: 'payment_type' });\n\n    return {\n        type: 'replies',\n        text: 'Qual a forma de pagamento?',\n        options: _options,\n    };\n}\n\nexport const showPaymentType = async (pageId, userId, data) => {\n    await updateOrder({\n        pageId, userId, paymentType: data.payment_type,\n        surcharge_percent: data.surcharge_percent, surcharge_amount: data.surcharge_amount,\n    });\n\n    let _txtPaymentType = data.payment_type;\n\n    return {\n        type: 'text',\n        text: '✅ ' + ' Forma de pagamento: ' + _txtPaymentType,\n    };\n}\n\nexport const askForPaymentChange = async (pageId, userId) => {\n    const _options = [];\n    _options.push({ text: 'Sim', data: 'payment_change_yes', event: 'ORDER_PAYMENT_CHANGE' });\n    _options.push({ text: 'Não', data: 'payment_change_no', event: 'ORDER_PAYMENT_CHANGE' });\n\n    await updateOrder({ pageId, userId, waitingFor: 'payment_change' });\n\n    return {\n        type: 'replies',\n        text: 'Precisa de troco?',\n        options: _options,\n    };\n}\n\n\n/**\n * Used on Whatsapp\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showPaymentTypeAskForPaymentChange = async (pageId, userId, data) => {\n    const prevAnswer = await showPaymentType(pageId, userId, data);\n    const nextQuestion = await askForPaymentChange(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\nexport const showPaymentChange = async (pageId, userId, data) => {\n    await updateOrder({ pageId, userId, paymentChange: data });\n\n    let _txtPaymentChange = data === 'payment_change_yes'\n        ? 'Levaremos trocado'\n        : 'Não precisa de troco';\n\n    return {\n        type: 'text',\n        text: '✅ ' + _txtPaymentChange,\n    };\n}\n\nexport const askForComments = async (pageId, userId) => {\n    const _options = [];\n    _options.push({ text: 'Sim', data: 'comments_yes', event: 'ORDER_COMMENTS' });\n    _options.push({ text: 'Não', data: 'comments_no', event: 'ORDER_COMMENTS' });\n\n    await updateOrder({ pageId, userId, waitingFor: 'comments' });\n\n    return {\n        type: 'replies',\n        text: 'Quer enviar alguma observação sobre o pedido ou entrega?',\n        options: _options,\n    };\n}\n\nexport const showPaymentChangeAskForComments = async (pageId, userId, data) => {\n    const prevAnswer = await showPaymentChange(pageId, userId, data);\n    const nextQuestion = await askForComments(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\nexport const askToTypeComments = async (pageID, userID, item) => {\n    let _txt;\n    if (item) {\n        await updateOrder({ pageId: pageID, userId: userID, waitingFor: 'typed_comments_item', waitingForData: item.id });\n        _txt = 'Diga o que gostaria de pedir: por ex. sem cebola ou ovos. Pode digitar:';\n    } else {\n        await updateOrder({ pageId: pageID, userId: userID, waitingFor: 'typed_comments' });\n        _txt = 'Digite as observações que você tem para a entrega ou pedido. Pode digitar!';\n    }\n    return {\n        type: 'text',\n        text: _txt,\n    }\n}\n\n\nexport const showComments = async (pageId, userId, text) => {\n    await updateOrder({ pageId, userId, comments: text });\n\n    let _txtComments = 'Observações para o pedido/entrega:\\n';\n    _txtComments += text;\n\n    return {\n        type: 'text',\n        text: '✅ ' + _txtComments,\n    };\n}\n\nexport const showFullOrder = async (pageId, userId) => {\n    // await updateOrder({ pageId, userId, waitingFor: 'full_confirmation', backToConfirmation: null });\n\n    const po = await getOrderPending({ pageId, userId, isComplete: true });\n\n    let total_price = 0;\n    let _txt = 'Seguem os detalhes do seu pedido:\\n\\n';\n\n    _txt = _txt + '𝗣𝗲𝗱𝗶𝗱𝗼: ' + po.order.id + '\\n';\n    for (const item of po.items) {\n        if (item.flavorId) {\n            let _txtQty = item.split > 1 ? item.qty + '/' + item.split : item.qty;\n            let _txtSize = item.sizeId ? item.size : '';\n            // _txt = _txt + `_${item.category}_: ${_txtQty} ${item.flavor}  ${_txtSize}\\n`;\n            _txt = _txt + `${_txtQty} ${item.flavor}  ${_txtSize}\\n`;\n            total_price += item.price;\n        }\n    }\n\n    if (po.order.deliver_type && po.order.deliver_type === 'pickup') {\n        _txt += 'Cliente retira.\\n'\n        if (po.order.store_address)\n            _txt += '📌 Nosso endereço: ' + po.order.store_address + '\\n';\n    } else {\n        _txt += '𝗘𝗻𝗱𝗲𝗿𝗲𝗰̧𝗼 𝗱𝗲 𝗘𝗻𝘁𝗿𝗲𝗴𝗮: ' + po.order.address + '\\n';\n\n        if (po.order.delivery_fee > 0) {\n            _txt += `𝗧𝗮𝘅𝗮 𝗱𝗲 𝗘𝗻𝘁𝗿𝗲𝗴𝗮: ${formatAsCurrency(po.order.delivery_fee)}\\n`\n            total_price += po.order.delivery_fee;\n        }\n    }\n\n    _txt = _txt + '𝗧𝗲𝗹𝗲𝗳𝗼𝗻𝗲: ' + po.order.phone + '\\n';\n    _txt = _txt + '𝗙𝗼𝗿𝗺𝗮 𝗱𝗲 𝗣𝗮𝗴𝗮𝗺𝗲𝗻𝘁𝗼: ' + po.order.payment_type + '\\n';\n\n    if (po.payment_change === 'payment_change_yes') {\n        _txt = _txt + '𝗟𝗲𝘃𝗮𝗿 𝗧𝗿𝗼𝗰𝗼? Sim \\n';\n    }\n\n    if (po.order.surcharge_percent > 0) {\n        _txt += `𝗧𝗮𝘅𝗮 𝗱𝗲 ${po.order.payment_type}: ${po.order.surcharge_percent * 100}%\\n`\n        total_price += total_price * po.order.surcharge_percent;\n    }\n\n    if (po.order.surcharge_amount > 0) {\n        _txt += `𝗧𝗮𝘅𝗮 𝗱𝗲 ${po.order.payment_type}: ${formatAsCurrency(po.order.surcharge_amount)}\\n`\n        total_price += po.order.surcharge_amount;\n    }\n\n    _txt = _txt + '𝗧𝗼𝘁𝗮𝗹: ' + formatAsCurrency(total_price) + '\\n';\n\n    let _txtComments = po.order.comments || 'Sem observações';\n    _txt = _txt + '𝗢𝗯𝘀𝗲𝗿𝘃𝗮𝗰̧𝗼̃𝗲𝘀: ' + _txtComments + '\\n';\n\n    return {\n        type: 'text',\n        text: _txt,\n    }\n\n    // the code below was used to ask for a final confirmation.\n    // _txt = _txt + 'Posso confirmar o pedido?';\n\n    // const _options = [];\n    // _options.push({\n    //     text: 'Sim',\n    //     data: {\n    //         type: 'confirmation_yes',\n    //         backTo: 'full_confirmation',\n    //     },\n    //     event: 'ORDER_CONFIRMATION',\n    // });\n    // _options.push({\n    //     text: 'Não',\n    //     data: {\n    //         type: 'confirmation_no',\n    //         backTo: 'full_confirmation',\n    //     },\n    //     event: 'ORDER_CONFIRMATION',\n    // });\n\n    // return {\n    //     type: 'replies',\n    //     text: _txt,\n    //     options: _options,\n    // };\n}\n\n/**\n * Used on Whatsapp\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showPaymentTypeAskForComments = async (pageId, userId, data) => {\n    const prevAnswer = await showPaymentType(pageId, userId, data);\n    const nextQuestion = await askForComments(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n/**\n * Used on Whatsapp\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showFullOrderConfirmOrder = async (pageId, userId, data) => {\n    if (data && data !== 'comments_no')\n        await showComments(pageId, userId, data);\n    // const nextQuestion = await showFullOrder(pageId, userId);\n\n    const prevAnswer = await showFullOrder(pageId, userId);\n    const nextAnswer = await confirmOrder(pageId, userId);\n\n    nextAnswer.text = prevAnswer.text + '\\n\\n' + nextAnswer.text;\n    return nextAnswer;\n}\n\nexport const confirmOrder = async (pageId, userId) => {\n    await updateOrder({ pageId, userId, confirmOrder: true, calcTotal: true });\n\n    return {\n        type: 'text',\n        text: '✅ Pedido Confirmado!',\n    };\n}\n\nexport const askForChangeOrder = async (pageId, userId, data) => {\n    let confirmStep;\n    if (data && data.hasOwnProperty('backTo')) {\n        confirmStep = data.backTo;\n    }\n\n    if (confirmStep) {\n        await updateOrder({ pageId, userId, waitingFor: 'change_order', backToConfirmation: confirmStep });\n    } else {\n        await updateOrder({ pageId, userId, waitingFor: 'change_order' });\n    }\n\n    let _txt = 'O que você gostaria de fazer com o seu pedido?';\n\n    const _options = [];\n    _options.push({ text: 'Mudar pedido', data: 'changeOrder', event: 'ORDER_WANT_CHANGE' });\n    _options.push({ text: 'Mudar endereço', data: 'change_address', event: 'ORDER_CHANGE' });\n\n    if (confirmStep) {\n        // confirmStep can be 'partial_confirmation' or 'full_confirmation'\n        const _evt = confirmStep === 'partial_confirmation'\n            ? 'ORDER_PIZZA_CONFIRMATION'\n            : 'ORDER_CONFIRMATION';\n\n        _options.push({\n            text: 'Confirmar.',\n            data: { type: 'confirmation_yes', backTo: confirmStep },\n            event: _evt,\n        });\n    }\n\n    return {\n        type: 'replies',\n        text: _txt,\n        options: _options,\n    };\n}\n\nexport const askForOptionsToChange = async (pageId, userId, item) => {\n    try {\n        let _txt = 'Ok, o que você gostaria de fazer?';\n\n        const _options = [];\n        _options.push({ text: 'Mandar observação para esse item', data: item, event: 'ORDER_CHANGE_ITEM' });\n        _options.push({ text: 'Cancelar/Remover', data: item, event: 'ORDER_CANCEL_ITEM' });\n\n        return {\n            type: 'replies',\n            text: _txt,\n            options: _options,\n        };\n    } catch (askForOptionsToChangeErr) {\n        console.error({ askForOptionsToChangeErr });\n        throw askForOptionsToChangeErr;\n    }\n}\n\nexport const askForSpecificItem = async (pageId, userId, data) => {\n    const pendingOrder = await getOrderPending({ pageId, userId, isComplete: true });\n    if (pendingOrder.items && pendingOrder.items.length > 1) {\n\n        const _options = [];\n        let _itemId = 0;\n        for (let item of pendingOrder.items) {\n            if (item.itemId !== _itemId) {\n                let _txt;\n                if (item.size && item.flavor) {\n                    let _sizeSplit = `${item.size}`;\n                    if (item.split && item.split > 1) {\n                        if (item.category.toUpperCase().indexOf('PIZZA') > -1)\n                            _sizeSplit = 'Pizza ' + _sizeSplit;\n                        _sizeSplit = _sizeSplit + ` ${item.split} Sabores`;\n                    } else\n                        _sizeSplit = item.flavor + ' ' + _sizeSplit;\n\n                    _txt = `${_sizeSplit}`;\n                } else {\n                    _txt = item.flavor;\n                }\n\n                if (_txt) {\n                    if (data && data.option === 'change_item') {\n                        _options.push({ text: _txt, data: item, event: 'ORDER_CHANGE_ITEM' });\n                    } else {\n                        _options.push({ text: _txt, data: item, event: 'ORDER_CANCEL_ITEM' });\n                    }\n                }\n\n                _itemId = item.itemId;\n            }\n        }\n\n        let _txtHead = 'Escolha qual dos itens deseja ';\n        if (data && data.option === 'change_item')\n            _txtHead = _txtHead + 'alterar:';\n        else\n            _txtHead = _txtHead + 'remover:';\n\n\n        return {\n            type: 'replies',\n            text: _txtHead,\n            options: _options,\n        };\n    } else {\n        await updateOrder({ pageId, userId, completeItem: false });\n        return await askForOptionsToChange(pageId, userId, pendingOrder.items[0]);\n    }\n}\n\n/**\n *\n * @param {*} pageId\n * @param {*} userId\n */\nexport const askForWantBeverage = async (pageId, userId) => {\n    updateOrder({ pageId, userId, waitingFor: 'want_beverage' });\n\n    const pendingOrder = await getOrderPending({ pageId, userId, isComplete: false });\n\n    const noBeverage = pendingOrder.order.no_beverage;\n\n    if (typeof noBeverage === 'undefined') {\n\n        let _txt = 'Gostaria de algo para beber?';\n\n        const _options = [];\n        _options.push({ text: 'Sim', data: 'beverage_yes', event: 'ORDER_CONFIRM_BEVERAGE' });\n        _options.push({ text: 'Não', data: 'beverage_no', event: 'ORDER_CONFIRM_BEVERAGE' });\n        return {\n            type: 'replies',\n            text: _txt,\n            options: _options,\n        };\n    } else {\n        return showFullOrder(pageId, userId);\n    }\n}\n/**\n *\n * @param {*} pageId\n * @param {*} userId\n * @param {*} multiple\n */\nexport const askForBeverages = async (pageId, userId, multiple) => {\n    await updateOrder({ pageId, userId, waitingFor: 'beverage', noBeverage: false });\n\n    const beveragesArr = await getBeverages(pageId);\n    let _rangeIni = (multiple - 1) * 4;\n    let _rangeEnd = multiple * 4;\n\n    const _options = [];\n    for (let i = _rangeIni; i < _rangeEnd; i++) {\n        if (beveragesArr[i]) {\n            const _bev = beveragesArr[i];\n            const _data = { id: _bev.id, beverage: _bev.name, price: _bev.price }\n            const buttons = { text: 'Quero', data: _data, event: 'ORDER_BEVERAGE' };\n\n            let _subtext = _bev.kind;\n            if (_bev.price) {\n                _subtext = _subtext.concat('\\n R$', _bev.price);\n            }\n            _options.push({ text: _bev.name, subtext: _subtext, buttons });\n        }\n    }\n    if ((beveragesArr.length + 1) > _rangeEnd) {\n        multiple++;\n        const buttonsOpt = {\n            text: '+ Opções',\n            data: { option: 'beverages_more', multiple: multiple },\n            event: 'ORDER_BEVERAGE',\n        };\n        _options.push({\n            text: 'Clique aqui p/ ver + opções',\n            buttons: buttonsOpt,\n            isOnlyButtons: true,\n        });\n    } else {\n        const _data = { option: 'beverages_cancel' }\n        const buttons = { text: 'Sem bebida', data: _data, event: 'ORDER_BEVERAGE' };\n        let _subtext = 'Se não encontrou, selecione \"Sem bebida\"';\n        _options.push({ text: 'Sem bebida', subtext: _subtext, buttons });\n    }\n\n    return {\n        type: 'fulllist',\n        text: 'Selecione uma bebida:',\n        options: _options,\n    };\n}\n\n/**\n * Show that user did not want beverage and update order with this info.\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showNoBeverage = async (pageId, userId, data) => {\n    await updateOrder({ pageId, userId, noBeverage: true, waitingFor: 'confirm' });\n\n    return { type: 'text', text: '❌ ' + ' Sem bebida para o seu pedido. ' };\n}\n\n/**\n * Show the chosen beverage.\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showBeverage = async (pageId, userId, data) => {\n    await updateOrder({ pageId, userId, beverageId: data.id, beveragePrice: data.price, completeItem: true, noBeverage: false, waitingFor: 'full_confirmation', calcTotal: true });\n\n    return {\n        type: 'text',\n        text: '✅ ' + '1 Bebida: ' + data.beverage,\n    }\n}\n\n/**\n * Used on Whatsapp\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showBeverageAskForPaymentType = async (pageId, userId, data) => {\n    const prevAnswer = await showBeverage(pageId, userId, data);\n    const nextQuestion = await askForPaymentType(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n/**\n * Used on Whatsapp\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showNoBeverageAskForPaymentType = async (pageId, userId, data) => {\n    const prevAnswer = await showNoBeverage(pageId, userId, data);\n    const nextQuestion = await askForPaymentType(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n/**\n * Cancel the selected item, reorder the itemIds and askForSize\n * @param {*} pageId\n * @param {*} userId\n * @param {*} itemId\n */\nexport const changeItem = async (pageId, userId, item) => {\n    return askToTypeComments(pageId, userId, item);\n}\n\nexport const showCommentsItem = async (pageId, userId, data) => {\n    const po = await getOrderPending({ pageId, userId, isComplete: false });\n\n    if (po && po.order && po.order.waitingFor === 'typed_comments_item') {\n        // without await to run later.\n        updateItemDirect(pageId, po.order.id, po.order.waitingForData, data);\n    }\n\n    return await showPartialOrder(pageId, userId);\n}\n\n\nexport const cancelItem = async (pageId, userId, item) => {\n    const po = await getOrderPending({ pageId, userId, isComplete: false });\n    const result1 = await deleteItem(pageId, po.order.id, item.itemId);\n    console.info('cancelItem:', result1);\n    // if (result1) {\n    if (po.order.backToConfirmation === 'full_confirmation') {\n        return await showFullOrder(pageId, userId);\n    } else\n        return await showPartialOrder(pageId, userId);\n    // }\n}\n\n\nexport const updateItemAskOptions = async (pageId, userId, item) => {\n    // const item = await updateStatusSpecificItem(objectId, 0);\n    return await askForOptionsToChange(pageId, userId, item);\n}\n\nexport const sendShippingNotification = async (pageId, userId, orderId) => {\n    const { accessToken } = await getOnePageToken(pageId);\n\n    const _txt = 'O seu pedido número ' + orderId + ' acabou de sair para entrega. Bom apetite!';\n\n    const out = new Elements();\n    out.add({ text: _txt });\n    await Bot.send_message_tag(accessToken, userId, out);\n}\n\nexport const sendRejectionNotification = async (pageId, userId, orderId, rejectionExplanation) => {\n    const { accessToken } = await getOnePageToken(pageId);\n\n    const _txt = 'Infelizmente não poderemos atender o seu pedido número '\n        + orderId\n        + '. Segue o motivo: '\n        + rejectionExplanation;\n\n    const out = new Elements();\n    out.add({ text: _txt });\n    await Bot.send_message_tag(accessToken, userId, out);\n}\n\n/**\n * Delete the pending order and shows the Main Menu.\n * @param {*} pageId\n * @param {*} userId\n */\nexport const cancelPendingOrder = async (pageId, userId) => {\n    await cancelOrder({ pageId, userId });\n\n    const out = await sendMainMenu();\n    out.text = '❌ Pedido Cancelado!' + '\\n\\n' + out.text;\n\n    return out;\n}\n\nexport const showDeliverAskForCategory = async (pageId, userId, data, user, source) => {\n    const prevAnswer = await showDeliver(pageId, userId, data, user, source);\n    const nextQuestion = await askForCategory(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\nexport const showAddressAskForCategory = async (pageId, userId, addrData, source) => {\n    const prevAnswer = await showAddress(pageId, userId, addrData, source);\n    const nextQuestion = await askForCategory(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n/**\n * \n * @param {*} pageId\n * @param {*} userId\n * @param {*} split: if true, only show categories that are marked 'is_pizza'.\n * Show only categories with split to allow user mix categories in same pizza.\n */\nexport const askForCategory = async (pageId, userId, split) => {\n    await updateOrder({ pageId, userId, waitingFor: 'category', waitingForData: split });\n\n    const categories = await getCategories(pageId);\n\n    let _txt = '';\n    if (split) {\n        _txt = `Para escolher o ${split}o. sabor, escolha a categoria:\\n`\n    } else {\n        _txt = 'Selecione uma categoria:';\n    }\n\n    const _options = [];\n    for (let item of categories) {\n        if (split && !item.is_pizza)\n            continue;\n\n        const _data = { id: item.id, name: item.name }\n        const buttons = { text: 'Quero', data: _data, event: 'ORDER_CATEGORY' };\n\n        _options.push({ text: item.name, subtext: item.name, buttons });\n    }\n\n    const buttons = { text: 'Voltar', data: 'partial_confirmation', event: 'ORDER_PARTIAL_CONFIRMATION' };\n    _options.push({ text: 'Voltar para o pedido', subtext: 'Voltar para o pedido', buttons });\n\n    return {\n        type: 'list',\n        text: _txt,\n        options: _options,\n    }\n}\n\nexport const showCategory = async (pageId, userId, data) => {\n    await updateOrder({ pageId, userId, categoryId: data.id, eraseSize: true });\n\n    return {\n        type: 'text',\n        text: '✅ ' + 'Categoria: ' + data.name,\n    }\n}\n\n\nexport const showCategoryAskForSize = async (pageId, userId, data) => {\n    const prevAnswer = await showCategory(pageId, userId, data);\n    const nextQuestion = await askForSizeCat(pageId, userId, data.id);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\nexport const askForSizeCat = async (pageId, userId, categoryId) => {\n    const po = await getOrderPending({ pageId, userId, isComplete: false });\n\n    if (!categoryId)\n        categoryId = po.order.currentItemCategory;\n\n    // User is spliting the pizza into more than one category\n    if (po.order.originalSplit > 1 && po.order.currentItemSplit <= po.order.originalSplit) {\n        return askForFlavor(pageId, userId, 1, po);\n    } else {\n\n        const category = await getCategory(pageId, categoryId);\n\n        if (category.price_by_size) {\n            const sizesWithPricing = await getPricingSizing(pageId, categoryId); // only sizes with pricing\n\n            // only 1 size priced, bot IS NOT ASKS FOR THAT.\n            if (sizesWithPricing.length === 1) {\n                const size = await getSize(pageId, sizesWithPricing[0]);\n                const sizeData = {\n                    id: size.id,\n                    size: size.size,\n                }\n                // Update the order with the unique size and checkSplit\n                return showSizeCheckSplit(pageId, userId, sizeData);\n            } else {\n                // Without await, to run later\n                updateOrder({ pageId, userId, waitingFor: 'size' });\n\n                const _text = 'Selecione o tamanho:';\n\n                const _options = [];\n                const sizes = await getSizes(pageId, sizesWithPricing);\n\n                for (let i = 0; i < sizes.length; i++) {\n                    const _data = { id: sizes[i].id, size: sizes[i].size, split: sizes[i].split };\n                    _options.push({ text: sizes[i].size, data: _data, event: 'ORDER_SIZE' });\n                }\n\n                return {\n                    type: 'replies',\n                    text: _text,\n                    options: _options,\n                }\n            }\n        } else {\n            return await askForFlavor(pageId, userId, 1);\n        }\n    }\n}\n"],"file":"botController.js"}