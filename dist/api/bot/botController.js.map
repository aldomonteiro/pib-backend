{"version":3,"sources":["../../../src/api/bot/botController.js"],"names":["log_file","fs","createWriteStream","__dirname","flags","log_stdout","process","stdout","console","log","d","write","util","format","MSG_GENERAL_ERROR","sendErrorMsg","_errorMsg","out","Elements","_showErrorMsg","add","text","basicReply","pageId","userId","replyText","user","waitingFor","type","basicOption","optionText","_options","push","hidden","options","basicComments","comments","askForContinue","data","event","checkLastAction","pendingOrder","order","wf","wfd","waitingForData","addrData","confirmAddress","askForLocation","location","lat","location_lat","location_long","url","location_url","confirmLocationAddress","askForSizeCat","askForDeliver","askForCategory","askForQuantity","checkSplit","askForFlavor","askForChangeOrder","showPartialOrder","askForWantBeverage","askForBeverages","askForPaymentType","askForPaymentChange","askForComments","showFullOrder","showOrderOrNextItem","sendMainMenu","optionsStopOrder","passThreadControl","source","_txt","error","sendWelcomeMessage","pageID","sender","_nameToReplace","fetch","first_name","page","replyMsg","firstResponseText","replace","sendHorario","todayIsOpen","todayOpenAt","todayCloseAt","reply","sendCardapio","id","getFlavorsAndToppings","categoryID","sizeID","flavorArray","allToppings","pricings","flavorsWithPrice","flavor","categoryId","price","sizeId","toppingsNames","toppings","tId","topping","flavorsAndToppingsErr","askForWantOrder","storeData","delivery_time","delivery_fees","length","delivFee","fee","to","pickup_time","time","address","showDeliver","_phone","deliverType","deliverTime","storeAddress","phone","_txtReply","showDeliverCheckAddress","prevAnswer","confirmAddressOrAskLocation","nextQuestion","isLocation","addresses","foundAnyCompleteAddress","i","element","address_components","_data","formatted_address","button","addressNumber","subtext","buttons","buttonsOpt","isOnlyButtons","askToTypeAddress","userID","waitingForAddress","_replyText","formattedAddress","showAddress","formattedAddrData","showOrderOrAskForPhone","isComplete","po","askForPhone","isPhoneNumber","askToTypePhone","confirmTypedPhone","replies","QuickReplies","setQuickReplies","showPhone","showDeliverAskForQuantity","showAddressAskForQuantity","backToConfirmation","whatsText","askForQuantityMore","showQuantity","qty","substr","undo","currentItem","askForSize","_text","sizesWithPricing","sizes","size","split","qty_total","eraseSplit","showQuantityAskForSize","showSize","multiple","currentItemSize","currentSize","askForFlavorOrConfirm","showSizeCheckSplit","showSplit","originalSplit","_txtFlavor","currentItemSplit","items","status","flavorId","_id","showSplitCheckFlavor","currentItemCategory","flavorsArray","_splitForTheItem","currentSplit","NUMBER_OF_ITEMS","_rangeIni","_rangeEnd","_fl","_subtext","join","concat","option","showFlavor","origSplit","orderId","itemId","_complete","info","completeItem","calcTotal","cancelPendingShowPartialOrder","splice","total_price","item","_txtQty","_txtSize","deliver_type","delivery_fee","backTo","showFlavorCheckItem","payment_types","paymentType","payment_type","surcharge_percent","surcharge_amount","surcharge_amonut","showPaymentType","_txtPaymentType","showPaymentTypeAskForPaymentChange","showPaymentChange","paymentChange","_txtPaymentChange","showPaymentChangeAskForComments","askToTypeComments","showComments","_txtComments","store_address","payment_change","showPaymentTypeAskForComments","showFullOrderConfirmOrder","confirmOrder","nextAnswer","hasOwnProperty","confirmStep","_evt","askForOptionsToChange","askForOptionsToChangeErr","askForSpecificItem","_itemId","_sizeSplit","category","toUpperCase","indexOf","_txtHead","noBeverage","no_beverage","beveragesArr","_bev","beverage","name","kind","showNoBeverage","showBeverage","beverageId","beveragePrice","showBeverageAskForPaymentType","showNoBeverageAskForPaymentType","changeItem","showCommentsItem","cancelItem","result1","updateItemAskOptions","sendShippingNotification","accessToken","Bot","send_message_tag","sendRejectionNotification","rejectionExplanation","cancelPendingOrder","showDeliverAskForCategory","showAddressAskForCategory","categories","is_pizza","showCategory","eraseSize","showCategoryAskForSize","price_by_size","sizeData"],"mappings":"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","sourcesContent":["import util from 'util';\nimport fs from 'fs';\nimport { Bot, Elements, QuickReplies } from 'facebook-messenger-bot';\nimport {\n    getOnePageToken,\n    getOnePageData, sendPassThreadControl,\n} from '../controllers/pagesController';\nimport { getPricingSizing, getPricings } from '../controllers/pricingsController';\nimport { getFlavors } from '../controllers/flavorsController';\nimport { getToppingsFull } from '../controllers/toppingsController';\nimport { getCardapio } from './show_cardapio';\nimport { getSizes, getSize } from '../controllers/sizesController';\nimport { getBeverages } from '../controllers/beveragesController';\nimport { getTodayOpeningTime, getStoreData } from '../controllers/storesController';\nimport { updateOrder, getOrderPending, cancelOrder } from '../controllers/ordersController';\nimport {\n    getAddressLocation,\n    getCustomerAddress, formatAddrData, notifyUserStopAuto,\n} from '../controllers/customersController';\nimport {\n    updateStatusSpecificItem, deleteItem,\n    updateItemDirect, deletePendingItem, updateItemStatus,\n} from '../controllers/itemsController';\nimport { formatWhatsappNumber, formatAsCurrency } from '../util/util';\nimport { getCategories, getCategory } from '../controllers/categoriesController';\n\n// TODO: create a debugger with json format\nvar log_file = fs.createWriteStream(__dirname + '/debug.log', { flags: 'w' });\nvar log_stdout = process.stdout;\n\nconsole.log = function (d) { //\n    log_file.write(util.format(d) + '\\n');\n    log_stdout.write(util.format(d) + '\\n');\n};\n\nconst MSG_GENERAL_ERROR = 'Ops, estamos com um probleminha tcnico: ';\n\n// // create a custom timestamp format for log statements\n// const SimpleNodeLogger = require('simple-node-logger'),\n//     opts = {\n//         logFilePath: 'logs/bot.log',\n//         timestampFormat: 'YYYY-MM-DD HH:mm:ss.SSS'\n//     },\n//     log = SimpleNodeLogger.createSimpleLogger(opts);\n\nexport const sendErrorMsg = async (_errorMsg) => {\n    const out = new Elements();\n    let _showErrorMsg = _errorMsg || 'ERRO DESCONHECIDO';\n    out.add({ text: MSG_GENERAL_ERROR + _showErrorMsg });\n    return out;\n}\n\n/**\n * Used in whatSimpleController\n * @param {*} pageId\n * @param {*} userId\n * @param {*} replyText\n */\nexport const basicReply = async (pageId, userId, replyText, user) => {\n    await updateOrder({ pageId, userId, waitingFor: 'typed_comments', user: user });\n\n    return { type: 'text', text: replyText };\n}\n\nexport const basicOption = async (pageId, userId, text, optionText, user) => {\n    await updateOrder({ pageId, userId, waitingFor: 'typed_comments', user: user });\n\n    const _options = [];\n    _options.push({ text: optionText, hidden: true });\n\n    return {\n        type: 'list',\n        text: text,\n        options: _options,\n    };\n}\n\n/**\n * Just update the comments, do not return nothing.\n * @param {*} pageId\n * @param {*} userId\n * @param {*} text\n */\nexport const basicComments = async (pageId, userId, text, user) => {\n    await updateOrder({ pageId, userId, waitingFor: 'typed_comments', comments: text, user: user });\n    return true;\n}\n\n\n/**\n * Send Yes or No to the user asking if he wants to place an order right now.\n * @param {*} pageId\n * @param {*} userId\n */\nexport const askForContinue = async () => {\n    return {\n        type: 'replies',\n        text: 'No entendi o que voc quis dizer. .\\n Vamos continuar com o pedido?',\n        options: [\n            { text: 'Sim', data: 'continueorder_yes', event: 'ORDER_CONTINUE_ORDER' },\n            { text: 'No', data: 'continueorder_no', event: 'ORDER_CONTINUE_ORDER' },\n        ],\n    }\n}\n\nexport const checkLastAction = async (pageId, userId) => {\n    const pendingOrder = await getOrderPending({ pageId, userId });\n\n    if (pendingOrder.order) {\n        const wf = pendingOrder.order.waitingFor;\n        const wfd = pendingOrder.order.waitingForData;\n\n        if (wf === 'confirm_address') {\n            const addrData = await getCustomerAddress(pageId, userId);\n            return await confirmAddress(pageId, userId, addrData);\n        } else if (wf === 'location')\n            return await askForLocation(pageId, userId);\n        else if (wf === 'location_address') {\n            const location = {\n                lat: pendingOrder.order.location_lat,\n                long: pendingOrder.order.location_long,\n                url: pendingOrder.order.location_url,\n            }\n            return await confirmLocationAddress(pageId, userId, location);\n        } else if (wf === 'size')\n            return await askForSizeCat(pageId, userId)\n        else if (wf === 'deliver')\n            return await askForDeliver(pageId, userId);\n        else if (wf === 'category')\n            return await askForCategory(pageId, userId, wfd);\n        else if (wf === 'quantity')\n            return await askForQuantity(pageId, userId);\n        else if (wf === 'split')\n            return checkSplit(pageId, userId, 1);\n        else if (wf === 'flavor')\n            return await askForFlavor(pageId, userId, 1);\n        else if (wf === 'change_order')\n            return await askForChangeOrder(pageId, userId);\n        else if (wf === 'partial_confirmation')\n            return await showPartialOrder(pageId, userId);\n        else if (wf === 'want_beverage')\n            return await askForWantBeverage(pageId, userId);\n        else if (wf === 'beverage')\n            return await askForBeverages(pageId, userId, 1);\n        else if (wf === 'payment_type')\n            return await askForPaymentType(pageId, userId);\n        else if (wf === 'payment_change')\n            return await askForPaymentChange(pageId, userId);\n        else if (wf === 'comments')\n            return await askForComments(pageId, userId);\n        else if (wf === 'full_confirmation')\n            return await showFullOrder(pageId, userId);\n        else if (wf === 'nothing')\n            return await showOrderOrNextItem(pageId, userId);\n        else\n            return await sendMainMenu();\n    } else\n        return await sendMainMenu();\n}\n\nexport const optionsStopOrder = async () => {\n    return {\n        type: 'replies',\n        text: 'Muito bem, aqui esto as opes:',\n        options: [\n            { text: 'Voltar p/ Incio', data: 'stoporder_init', event: 'STOP_ORDER_OPTIONS' },\n            { text: 'Falar c/ Atendente', data: 'stoporder_human', event: 'STOP_ORDER_OPTIONS' },\n        ],\n    }\n}\n\nexport const passThreadControl = async (pageId, userId, source, user) => {\n    let _txt = 'Ok, a partir de agora voc est nas mos do nosso atendente.';\n    _txt += ' O que voc escrever a partir de agora ser respondido por uma pessoa,'\n    _txt += 'o mais rpido possvel!';\n\n    if (source === 'whatsapp') {\n        notifyUserStopAuto(pageId, userId, user);\n    }\n    try {\n        await sendPassThreadControl(pageId, userId, source);\n        return { type: 'text', text: _txt };\n    } catch (err) {\n        console.error(err);\n        return { type: 'text', text: _txt };\n    }\n}\n\n/**\n *\n * @param {*} sender\n * @param {*} pageID\n */\nexport const sendWelcomeMessage = async (pageID, sender) => {\n    let _nameToReplace = '';\n    if (sender && typeof sender !== 'string') {\n        // This only works on Facebook\n        await sender.fetch('first_name');\n        _nameToReplace = sender.first_name;\n    } else if (sender && typeof sender === 'string')\n        _nameToReplace = sender;\n\n    const page = await getOnePageData(pageID);\n    const replyMsg = page.firstResponseText.replace('$NAME', _nameToReplace);\n\n    return { type: 'text', text: replyMsg };\n}\n\nexport const sendMainMenu = async () => {\n    return {\n        type: 'buttons',\n        text: 'Por favor escolha uma das opes',\n        options: [\n            { text: ' Cardpio', data: 'CARDAPIO_PAYLOAD', event: 'MAIN-MENU' },\n            { text: ' Horrios', data: 'HORARIO_PAYLOAD', event: 'MAIN-MENU' },\n            { text: ' Fazer Pedido', data: 'PEDIDO_PAYLOAD', event: 'MAIN-MENU' },\n            { text: ' Falar c/ Atendente', data: 'stoporder_human', event: 'MAIN-MENU' },\n        ],\n    };\n\n    // const buttons = new Buttons();\n    // buttons.add({ text: ' Cardpio', data: 'CARDAPIO_PAYLOAD', event: 'MAIN-MENU' });\n    // buttons.add({ text: ' Horrios', data: 'HORARIO_PAYLOAD', event: 'MAIN-MENU' });\n    // buttons.add({ text: ' Fazer Pedido', data: 'PEDIDO_PAYLOAD', event: 'MAIN-MENU' });\n\n    // const out = new Elements();\n    // out.add({ text: 'Por favor escolha uma das opes', buttons });\n\n    // return out;\n}\n\nexport const sendHorario = async (pageID, source) => {\n    const { todayIsOpen, todayOpenAt, todayCloseAt } = await getTodayOpeningTime(pageID);\n\n    let replyMsg = '';\n    if (todayIsOpen === true) {\n        replyMsg = 'Estamos abertos hoje, a partir das ' + todayOpenAt + ' horas, at s ' + todayCloseAt + ' horas.';\n    } else {\n        replyMsg = 'Infelizmente hoje no estamos abertos, mas voc pode consultar nosso cardpio no menu principal.';\n    }\n\n    if (source && source === 'whatsapp') {\n        const reply = await sendMainMenu();\n        reply.text = replyMsg + '\\n\\n' + reply.text;\n        return reply;\n    } else\n        return { type: 'text', text: replyMsg };\n}\n\n/**\n * Returns only the formatted text to be sent to the user\n * @param {*} pageID\n */\nexport const sendCardapio = async (pageID, data, source) => {\n    const replyMsg = await getCardapio(pageID, data.id);\n\n    if (source && source === 'whatsapp') {\n        const reply = await sendMainMenu();\n        reply.text = replyMsg + '\\n\\n' + reply.text;\n        return reply;\n    } else\n        return { type: 'text', text: replyMsg };\n}\n\n\n/**\n * Returns array of flavors. If sizeID was passed, only returns flavors with price.\n * @param {*} pageID\n * @param {*} sizeID\n */\nexport const getFlavorsAndToppings = async (pageID, categoryID, sizeID) => {\n    try {\n        const flavorArray = await getFlavors(pageID);\n        const allToppings = await getToppingsFull(pageID);\n        const pricings = await getPricings(pageID);\n        const flavorsWithPrice = [];\n        for (let flavor of flavorArray) {\n            if (categoryID && flavor.categoryId === categoryID) {\n                if (sizeID) {\n                    for (let price of pricings) {\n                        if (price.categoryId === flavor.categoryId && price.sizeId === sizeID) {\n                            flavor.price = price.price;\n                            break;\n                        }\n                    }\n                }\n                if (flavor.price) {\n                    flavor.toppingsNames = [];\n                    for (let tId of flavor.toppings) {\n                        for (let topping of allToppings) {\n                            if (topping.id === tId) {\n                                flavor.toppingsNames.push(topping.topping);\n                            }\n                        }\n                    }\n                    flavorsWithPrice.push(flavor);\n                }\n            }\n        }\n        return flavorsWithPrice;\n    } catch (flavorsAndToppingsErr) {\n        console.error({ flavorsAndToppingsErr });\n    }\n}\n\n\n/**\n * Send Yes or No to the user asking if he wants to place an order right now.\n */\nexport const askForWantOrder = async () => {\n    return {\n        type: 'replies',\n        text: 'Agora que voc viu nosso cardpio, voc est pronto para fazer o pedido?',\n        options: [\n            { text: 'Sim', data: 'wantorder_yes', event: 'ORDER_WANT_ORDER' },\n            { text: 'No', data: 'wantorder_no', event: 'ORDER_WANT_ORDER' },\n        ],\n    };\n\n    // const out = new Elements();\n    // let _txt = 'Agora que voc viu nosso cardpio, voc est pronto para fazer o pedido?';\n    // out.add({ text: _txt });\n\n    // const replies = new QuickReplies();\n    // // replies.add({ text: \"Quantidade\", data: \"change_quantity\", event: 'ORDER_CHANGE' });\n    // replies.add({ text: \"Sim\", data: \"wantorder_yes\", event: 'ORDER_WANT_ORDER' });\n    // replies.add({ text: \"No\", data: \"wantorder_no\", event: 'ORDER_WANT_ORDER' });\n    // out.setQuickReplies(replies);\n    // return out;\n}\n\nexport const askForDeliver = async (pageId, userId) => {\n    await updateOrder({ pageId, userId, waitingFor: 'deliver' });\n\n    const storeData = await getStoreData(pageId);\n    let _txt = '';\n\n    if (storeData.delivery_time) {\n        _txt += ` Tempo de entrega:  *${storeData.delivery_time}* minutos\\n`;\n    }\n    if (storeData.delivery_fees && storeData.delivery_fees.length > 0) {\n        _txt += 'Taxa de Entrega: ';\n        for (let delivFee of storeData.delivery_fees) {\n            _txt += `${formatAsCurrency(delivFee.fee)} (at ${delivFee.to} km) `\n        }\n        _txt += '\\n';\n    }\n    if (storeData.pickup_time) {\n        _txt += ` Para retirar aqui:  *${storeData.pickup_time}* minutos\\n`;\n    }\n\n    _txt += 'O pedido  para entregar ou voc vem retirar aqui?'\n\n    return {\n        type: 'replies',\n        text: _txt,\n        options: [\n            {\n                text: 'Entregar',\n                data: { type: 'delivery', time: storeData.delivery_time },\n                event: 'ORDER_DELIVER',\n            },\n            {\n                text: 'Retirar',\n                data: { type: 'pickup', time: storeData.pickup_time, address: storeData.address },\n                event: 'ORDER_DELIVER',\n            },\n        ],\n    }\n}\n\nexport const showDeliver = async (pageId, userId, data, user, source) => {\n    let _phone = null;\n    if (source && source === 'whatsapp') {\n        _phone = formatWhatsappNumber(userId);\n    }\n\n    await updateOrder({\n        pageId, userId,\n        deliverType: data.type, deliverTime: data.time, storeAddress: data.address,\n        user: user,\n        phone: _phone, source: source,\n    });\n\n    let _txtReply;\n    if (data && data.type === 'delivery')\n        _txtReply = 'Entregaremos o seu pedido.';\n    else {\n        _txtReply = 'Retirar o pedido conosco.\\n';\n        if (data.address)\n            _txtReply += ' Nosso endereo: ' + data.address;\n    }\n\n    return {\n        type: 'text',\n        text: ' ' + _txtReply,\n    };\n}\n\nexport const showDeliverCheckAddress = async (pageId, userId, data, user, source) => {\n    const prevAnswer = await showDeliver(pageId, userId, data, user, source);\n    const nextQuestion = await confirmAddressOrAskLocation(pageId, userId, user, source)\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\n/**\n * Question No.01\n * If the user doesnt have an address in the database, this will be the first question.\n */\nexport const askForLocation = async (pageId, userId, user, source) => {\n\n    let _phone = null;\n    if (source && source === 'whatsapp') {\n        _phone = formatWhatsappNumber(userId);\n    }\n\n    await updateOrder({ pageId, userId, user, waitingFor: 'location', phone: _phone, source: source });\n\n    if (!source || source === 'messenger') {\n        return {\n            type: 'replies',\n            text: 'Para comear, preciso saber aonde voc est. Por favor clique no boto abaixo para me mand-la.',\n            options: [\n                { text: 'Localizao', isLocation: true, data: 'location_location', event: 'LOCATION' },\n            ],\n        }\n    } else if (source === 'whatsapp') {\n        return {\n            type: 'text',\n            text: 'Para comear, preciso saber aonde voc est. Favor enviar a sua localizao.',\n            options: [\n                { text: 'Localizao', data: 'location_location', event: 'LOCATION' },\n            ],\n        }\n    }\n}\n\n\nexport const confirmLocationAddress = async (pageId, userId, location, user) => {\n    if (location) {\n        await updateOrder({ pageId, userId, location, user, waitingFor: 'location_address' });\n\n        const addresses = await getAddressLocation(location);\n\n        if (addresses && addresses.length && addresses.length > 0) {\n\n            let foundAnyCompleteAddress = false;\n            const options = [];\n            for (let i = 0; i < 4; i++) {\n                const element = addresses[i];\n                if (element.address_components && element.address_components.length >= 6) {\n                    foundAnyCompleteAddress = true;\n                    const _data = { formatted_address: element.formatted_address, address_components: element.address_components };\n                    const button = { text: 'Esse!', data: _data, event: 'LOCATION_ADDRESS' };\n                    let addressNumber = i + 1;\n                    options.push({ text: 'Endereo ' + addressNumber, subtext: element.formatted_address, buttons: button });\n                }\n            }\n\n            if (foundAnyCompleteAddress) {\n                const buttonsOpt = { data: 'incorrect_address', event: 'LOCATION_ADDRESS' };\n                options.push({\n                    text: 'No  meu endereo..',\n                    subtext: 'Selecione essa opo se seu endereo no aparece',\n                    buttons: buttonsOpt,\n                    isOnlyButtons: true,\n                });\n                return {\n                    type: 'list',\n                    text: 'Encontrei esses endereos, selecione o correto:',\n                    options: options,\n                };\n            } else {\n                return await askToTypeAddress(pageId, userId);\n            }\n        } else {\n            return await askToTypeAddress(pageId, userId);\n        }\n    } else {\n        return await askToTypeAddress(pageId, userId);\n    }\n}\n\nexport const confirmAddressOrAskLocation = async (pageId, userId, user, source) => {\n\n    // TODO: check if the location is in the neighborhood.\n    // TODO: check if the location is the same as stored in db.\n    const addrData = await getCustomerAddress(pageId, userId);\n\n    if (addrData) {\n        return confirmAddress(pageId, userId, addrData, user, source);\n    } else {\n        return await askForLocation(pageId, userId, user, source);\n    }\n}\n\nexport const askToTypeAddress = async (pageID, userID) => {\n    await updateOrder({ pageId: pageID, userId: userID, waitingForAddress: true, waitingFor: 'typed_address' });\n\n    return {\n        type: 'text',\n        text: 'No foi possvel localizar um endereo vlido. Digite o seu endereo completo por favor.',\n    }\n}\n\nexport const confirmAddress = async (pageId, userId, addrData, user, source) => {\n    let _phone = null;\n    if (source && source === 'whatsapp') {\n        _phone = formatWhatsappNumber(userId);\n    }\n\n    if (user)\n        await updateOrder({\n            pageId, userId, user, waitingForAddress: false,\n            waitingFor: 'confirm_address', phone: _phone,\n        });\n    else\n        await updateOrder({\n            pageId, userId, waitingForAddress: false,\n            waitingFor: 'confirm_address', phone: _phone,\n        });\n\n    let _replyText = 'A entrega ser para esse endereo?\\n';\n    _replyText = _replyText + addrData.formattedAddress;\n\n    return {\n        type: 'replies',\n        text: _replyText,\n        options: [\n            { text: 'Sim', data: addrData, event: 'CORRECT_SAVED_ADDRESS' },\n            { text: 'No', data: addrData, event: 'WRONG_SAVED_ADDRESS' },\n        ],\n    }\n}\n\nexport const showAddress = async (pageId, userId, addrData, source) => {\n    let _phone = null;\n    if (source && source === 'whatsapp') {\n        _phone = formatWhatsappNumber(userId);\n    }\n\n    if (addrData && addrData.address_components) {\n        const formattedAddrData = await formatAddrData(addrData);\n        await updateOrder({ pageId, userId, addrData: formattedAddrData, phone: _phone });\n    } else {\n        await updateOrder({ pageId, userId, addrData, phone: _phone });\n    }\n\n    return {\n        type: 'text',\n        text: 'Ok, entregaremos nesse endereo.',\n    }\n}\n\n\nexport const showOrderOrAskForPhone = async (pageId, userId) => {\n    const po = await getOrderPending({ pageId, userId, isComplete: false });\n\n    if (po.order && po.order.waitingFor === 'partial_confirmation')\n        return await showOrderOrNextItem(pageId, userId);\n    else\n        return await askForPhone(pageId, userId);\n}\n\nexport const askForPhone = async (pageId, userId) => {\n    await updateOrder({ pageId, userId, waitingFor: 'phone' });\n\n    const _txt = 'Pode nos enviar o seu telefone para confirmar o seu pedido? Se no aparecer o seu telefone (ou estiver errado), use a opo digitar.';\n\n    const _options = []\n    _options.push({ text: 'Telefone', isPhoneNumber: true, data: 'phone_number', event: 'PHONE_NUMBER' });\n    _options.push({ text: 'Digitar o telefone', data: 'change_phone', event: 'PHONE_CONFIRMED' });\n\n    return {\n        type: 'replies',\n        text: _txt,\n        options: _options,\n    };\n}\n\nexport const askToTypePhone = async (pageId, userId) => {\n\n    await updateOrder({ pageId, userId, waitingFor: 'phone' });\n\n    const out = new Elements();\n    out.add({ text: 'Por favor, digite o nmero do telefone vlido para que possamos confirmar o pedido. Pode digitar o :' });\n    return out;\n}\n\nexport const confirmTypedPhone = async (pageId, userId, phone) => {\n    const out = new Elements();\n\n    await updateOrder({ pageId, userId, waitingFor: 'phone' });\n\n    let _txt = 'O telefone ' + phone + ' est coreto?';\n    out.add({ text: _txt });\n\n    const replies = new QuickReplies();\n    replies.add({ text: 'Sim', data: phone, event: 'PHONE_CONFIRMED' });\n    replies.add({ text: 'No, usar outro', data: 'change_phone', event: 'PHONE_CONFIRMED' });\n    out.setQuickReplies(replies);\n\n    return out;\n}\n\n\nexport const showPhone = async (pageId, userId, phone) => {\n    await updateOrder({ pageId, userId, phone, waitingFor: 'nothing' });\n\n    const out = new Elements();\n    out.add({ text: 'Usaremos o nmero ' + phone + ' para confirmar o pedido. Agora vou pegar as informaes do pedido.' });\n    return out;\n}\n\nexport const showDeliverAskForQuantity = async (pageId, userId, data, user, source) => {\n    const prevAnswer = await showDeliver(pageId, userId, data, user, source);\n    const nextQuestion = await askForQuantity(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\n/**\n * Show Address only stores the addres in database. Ignoring the return.\n * The user is gonna see the AskForQuantity.\n * Used on Whatsapp.\n * @param {*} pageId\n * @param {*} userId\n * @param {*} addrData\n */\nexport const showAddressAskForQuantity = async (pageId, userId, addrData, source) => {\n    const prevAnswer = await showAddress(pageId, userId, addrData, source);\n    let nextQuestion;\n\n    // Show Address can be called from the creation order flow or from\n    // the update order flow. Below, if it was called from the update order\n    // flow, I am gonna return the flow to the showOrder or showFullOrder\n    const po = await getOrderPending({ pageId, userId, isComplete: false });\n    if (po && po.order && po.order.backToConfirmation) {\n        if (po.order.backToConfirmation === 'full_confirmation') {\n            nextQuestion = await showFullOrder(pageId, userId);\n        } else if (po.order.backToConfirmation === 'partial_confirmation') {\n            nextQuestion = await showOrderOrNextItem(pageId, userId);\n        } else {\n            nextQuestion = await askForQuantity(pageId, userId);\n        }\n    } else {\n        nextQuestion = await askForQuantity(pageId, userId);\n    }\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\nexport const askForQuantity = async (pageId, userId) => {\n    await updateOrder({ pageId, userId, waitingFor: 'quantity' });\n\n    return {\n        type: 'replies',\n        text: 'Quantas pizzas voc quer?',\n        options: [\n            { text: '1', whatsText: 'Uma', data: 'qty_1', event: 'ORDER_QTY' },\n            { text: '2', whatsText: 'Duas', data: 'qty_2', event: 'ORDER_QTY' },\n            { text: '3', whatsText: 'Trs', data: 'qty_3', event: 'ORDER_QTY' },\n            { text: '+ de 3', data: 'qty_more', event: 'ORDER_QTY' },\n        ],\n    }\n}\n\nexport const askForQuantityMore = async (pageId, userId) => {\n    await updateOrder({ pageId, userId, waitingFor: 'quantity' });\n\n    return {\n        type: 'replies',\n        text: 'Quantas pizzas voc quer?',\n        options: [\n            { text: '- de 4', data: 'qty_less', event: 'ORDER_QTY' },\n            { text: '4', whatsText: 'Quatro', data: 'qty_4', event: 'ORDER_QTY' },\n            { text: '5', whatsText: 'Cinco', data: 'qty_5', event: 'ORDER_QTY' },\n            { text: '6', whatsText: 'Seis', data: 'qty_6', event: 'ORDER_QTY' },\n        ],\n    }\n}\n\nexport const showQuantity = async (pageId, userId, data) => {\n    // data is 'qty_1', 'qty_2', 'qty_3'...\n    const qty = data.substr(data.length - 1, 1);\n\n    await updateOrder({ pageId, userId, qty, waitingFor: 'size', undo: 'quantity', currentItem: 1 });\n\n    let out;\n    if (qty == 1) {\n        out = {\n            type: 'text',\n            text: ' ' + ' 1 pizza.',\n        };\n    } else {\n        out = {\n            type: 'text',\n            text: ' ' + qty + ' pizzas.',\n        };\n    }\n\n    // out.text = out.text + '(digite 0 p/ desfazer)'\n\n    return out;\n}\n\nexport const askForSize = async (pageId, userId) => {\n\n    const po = await getOrderPending({ pageId, userId, isComplete: false });\n\n    if (po.order) {\n        let _text = '';\n        if (po.order.qty === 1) {\n            _text = 'Qual o tamanho da pizza?';\n        } else {\n            _text = 'Agora vou pegar os detalhes da ' + po.order.currentItem + 'a. pizza.\\n';\n            _text = _text + 'Qual o tamanho dela?';\n        }\n\n        const _options = [];\n        const sizesWithPricing = await getPricingSizing(pageId); // only sizes with pricing\n        const sizes = await getSizes(pageId, sizesWithPricing);\n        for (let i = 0; i < sizes.length; i++) {\n            const _data = { id: sizes[i].id, size: sizes[i].size, split: sizes[i].split };\n            _options.push({ text: sizes[i].size, data: _data, event: 'ORDER_SIZE' });\n        }\n\n        const out = {\n            type: 'replies',\n            text: _text,\n            options: _options,\n        }\n        if (po.order.qty === 1)\n            await updateOrder({ pageId, userId, waitingFor: 'size' });\n        else\n            await updateOrder({\n                pageId, userId, waitingFor: 'size',\n                qty_total: po.order.qty_total, currentItem: po.order.currentItem, eraseSplit: true,\n            });\n\n        return out;\n    } else {\n        const out = {\n            type: 'text',\n            text: MSG_GENERAL_ERROR,\n        };\n        return out;\n    }\n}\n\n/**\n * Calls ShowQuantity and AskForSize\n * Used on Whatsapp.\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showQuantityAskForSize = async (pageId, userId, data) => {\n    const prevAnswer = await showQuantity(pageId, userId, data);\n    const nextQuestion = await askForSize(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\nexport const showSize = async (pageId, userId, data) => {\n    if (data && data.split && data.split > 1)\n        await updateOrder({ pageId, userId, sizeId: data.id, undo: 'size', waitingFor: 'split' });\n    else\n        await updateOrder({ pageId, userId, sizeId: data.id, undo: 'size', waitingFor: 'flavor' });\n\n    return {\n        type: 'text',\n        text: ' ' + ' Tamanho: ' + data.size, // + ' (digite 0 p/ desfazer)',\n    };\n}\n\n/**\n * Triggered by action CHECK_SPLIT\n * @param {*} pageId\n * @param {*} userId\n * @param {*} multiple\n */\nexport const checkSplit = async (pageId, userId, multiple) => {\n    const pendingOrder = await getOrderPending({ pageId: pageId, userId: userId, isComplete: true });\n    if (pendingOrder.order) {\n        const currentSize = await getSize(pageId, pendingOrder.order.currentItemSize);\n        // if split is gt than 1, ask user if he wants to split in more than one flavor.\n        if (currentSize.split && currentSize.split > 1) {\n            let _txt = 'A pizza ' + currentSize.size + ' pode ser dividida em ' + currentSize.split + ' sabores.\\n';\n            _txt = _txt + 'Escolha quantos sabores voc quer:';\n\n            const _options = [];\n            for (let i = 1; i <= currentSize.split; i++) {\n                let _replyText = i === 1 ? i + ' Sabor' : i + ' Sabores';\n                _options.push({ text: _replyText, data: i, event: 'ORDER_SPLIT' });\n            }\n\n            return {\n                type: 'replies',\n                text: _txt,\n                options: _options,\n            };\n        } else {\n            return await askForFlavorOrConfirm(pageId, userId, multiple);\n        }\n    }\n}\n\nexport const showSizeCheckSplit = async (pageId, userId, data, multiple) => {\n    const prevAnswer = await showSize(pageId, userId, data);\n    const nextQuestion = await checkSplit(pageId, userId, multiple);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n/**\n * After user answer if he wants to split the pizza, show the chosen option.\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n **/\nexport const showSplit = async (pageId, userId, data) => {\n    await updateOrder({\n        pageId, userId,\n        sizeId: data.id,\n        waitingFor: 'flavor',\n        originalSplit: data,\n    });\n\n    let _txtFlavor = data === 1 ? 'Sabor' : 'Sabores';\n\n    return {\n        type: 'text',\n        text: ' ' + data + ' ' + _txtFlavor,\n    };\n}\n\n\nexport const askForFlavorOrConfirm = async (pageId, userId, multiple) => {\n    const po = await getOrderPending({ pageId: pageId, userId: userId, isComplete: true });\n\n    if (po.order) {\n        if (po.order.originalSplit > 1 &&\n            po.order.originalSplit >= po.order.currentItemSplit) {\n            return await askForFlavor(pageId, userId, multiple, po);\n        } else {\n            if (po.items && po.items.length) {\n                for (let i = 0; i < po.items.length; i++) {\n                    if (po.items[i].status === 0 && po.items[i].flavorId > 0) {\n                        await updateStatusSpecificItem(po.items[i]._id, 1);\n                        return await showOrderOrNextItem(pageId, userId);\n                    }\n                }\n                return await askForFlavor(pageId, userId, multiple, po);\n            }\n        }\n    }\n}\n\nexport const showSplitCheckFlavor = async (pageId, userId, data) => {\n    const prevAnswer = await showSplit(pageId, userId, data);\n    // Changing based on categories\n    // const nextQuestion = await askForFlavorOrConfirm(pageId, userId, 1);\n    const nextQuestion = await askForFlavor(pageId, userId, 1);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\n/**\n *\n * @param {*} pageId\n * @param {*} userId\n * @param {*} multiple: if are the first 4 flavors, multiple=1, if are the next, multiple=2 and so on.\n */\nexport const askForFlavor = async (pageId, userId, multiple, pendingOrder) => {\n\n    let po = null;\n    if (pendingOrder && pendingOrder.order)\n        po = pendingOrder;\n    else po = await getOrderPending({ pageId: pageId, userId: userId, isComplete: false });\n\n    const flavorsArray = await getFlavorsAndToppings(pageId, po.order.currentItemCategory, po.order.currentItemSize);\n\n    // This variable will be passed as split parameter to updateOrder, so,\n    // updateOrder can update the item properly, with the value of originalSplit.\n    let _splitForTheItem = po.order.originalSplit;\n\n    // In case where the user typed an option wrongly, the bot invokes askForFlavor\n    // without the split parameter. So, because of this situation, I am retrieving\n    // the split from the order.\n    let currentSplit;\n    if (po.order.originalSplit > 1) {\n        if (!po.order.currentItemSplit) {\n            currentSplit = 1;\n        } else {\n            currentSplit = po.order.currentItemSplit;\n        }\n    }\n\n    // Rule to show 'Escolha o 1o. sabor', 'Escolha o 2o. sabor'\n    let _txt = 'Escolha o produto:'\n    if (currentSplit) {\n        // First time currentItemSplit is undefined, so, I am gonna use the originalSplit itself.\n        _txt = `Escolha o ${currentSplit}o. sabor:`\n    }\n\n    const NUMBER_OF_ITEMS = 10;\n\n    let _rangeIni = (multiple - 1) * NUMBER_OF_ITEMS;\n    let _rangeEnd = multiple * NUMBER_OF_ITEMS;\n\n    const _options = [];\n\n    for (let i = 0; i < flavorsArray.length; i++) {\n        if (flavorsArray[i]) {\n            const _fl = flavorsArray[i];\n            const _data = { id: _fl.id, flavor: _fl.flavor, price: _fl.price }\n            let _subtext = '';\n            if (_fl.toppingsNames && _fl.toppingsNames.length > 0)\n                _subtext = _fl.toppingsNames.join() + '\\n';\n            if (_fl.price) {\n                _subtext = _subtext.concat('R$', _fl.price);\n            }\n            const buttons = { text: 'Quero', data: _data, event: 'ORDER_FLAVOR' };\n\n            if (i >= _rangeIni && i < _rangeEnd)\n                _options.push({ text: _fl.flavor, subtext: _subtext, buttons });\n            else\n                _options.push({ text: _fl.flavor, subtext: _subtext, buttons, hidden: true });\n        }\n    }\n\n\n    if (flavorsArray.length > _rangeEnd) {\n        const buttons = { text: 'Voltar', data: currentSplit, event: 'ORDER_ASK_CATEGORY' };\n        _options.push({ text: 'Ver outra categoria', subtext: 'Ver outra categoria', buttons, hidden: true });\n\n        multiple++;\n        const buttonsOpt = {\n            text: '+ Opes',\n            data: { option: 'flavors_more', multiple: multiple }, event: 'ORDER_FLAVOR',\n        };\n        _options.push({\n            text: 'Ver + sabores', subtext: '+ sabores do cardpio',\n            buttons: buttonsOpt, isOnlyButtons: true,\n        });\n    } else {\n        const buttons = { text: 'Voltar', data: currentSplit, event: 'ORDER_ASK_CATEGORY' };\n        _options.push({ text: 'Ver outra categoria', subtext: 'Ver outra categoria', buttons });\n    }\n\n    updateOrder({\n        pageId, userId, waitingFor: 'flavor',\n        currentItemSplit: currentSplit,\n        currentItem: po.order.currentItem,\n        split: _splitForTheItem,\n    });\n\n    return {\n        type: 'fulllist',\n        text: _txt,\n        options: _options,\n    };\n}\n\nexport const showFlavor = async (pageId, userId, data) => {\n    const po = await getOrderPending({ pageId: pageId, userId: userId, isComplete: false });\n    let currentSplit;\n    let itemId;\n    let origSplit = po.order.originalSplit;\n    let orderId = po.order.id;\n    if (origSplit > 1 && po.order.currentItemSplit <= origSplit) {\n        if (po.order.currentItemSplit === 1)\n            itemId = po.order.currentItem ? po.order.currentItem + 1 : 1;\n        else\n            itemId = po.order.currentItem;\n\n        currentSplit = po.order.currentItemSplit + 1;\n    } else {\n        itemId = po.order.currentItem ? po.order.currentItem + 1 : 1;\n    }\n\n    let _complete = false;\n    if (origSplit > 1 && currentSplit > origSplit)\n        _complete = true;\n    else if (!po.order.originalSplit || origSplit === 1)\n        _complete = true;\n\n\n    console.info('showFlavor _complete:', _complete,\n        ' originalSplit:', po.order.originalSplit,\n        'currentSplit: ', currentSplit,\n        ' price: ', data.price);\n\n    await updateOrder({\n        pageId, userId, flavorId: data.id,\n        price: data.price,\n        completeItem: _complete,\n        waitingFor: 'nothing',\n        currentItemSplit: currentSplit,\n        currentItem: itemId,\n        categoryId: po.order.currentItemCategory,\n        calcTotal: true,\n    });\n\n    if (_complete) {\n        // without await, so, it can run later\n        updateItemStatus(pageId, orderId, itemId);\n    }\n\n    if (currentSplit) {\n        const showSplit = currentSplit - 1;\n        return {\n            type: 'text',\n            text: ' ' + showSplit + 'o. Sabor: ' + data.flavor,\n        };\n    } else {\n        return {\n            type: 'text',\n            text: ' ' + ' Sabor: ' + data.flavor,\n        };\n    }\n}\n\nexport const showOrderOrNextItem = async (pageId, userId) => {\n    const po = await getOrderPending({ pageId, userId, isComplete: true });\n\n    if (po.order.originalSplit > 1 && po.order.currentItemSplit <= po.order.originalSplit) {\n        return await askForCategory(pageId, userId, po.order.currentItemSplit);\n        // return await askForFlavor(pageId, userId, 1, po);\n    } else {\n        return await showPartialOrder(pageId, userId, po);\n        // await updateOrder({ pageId, userId, waitingFor: 'partial_confirmation', eraseSplit: true });\n\n        // let total_price = 0;\n        // _txt = _txt + ':' + po.order.id + '\\n';\n        // let _txt = 'Seguem os detalhes do seu pedido:\\n';\n        // for (let i = 0; i < po.items.length; i++) {\n        //     const _item = po.items[i];\n        //     if (_item.flavorId) {\n        //         let _txtQty = _item.split > 1 ? _item.qty + '/' + _item.split : _item.qty;\n\n        //         let _txtSize = '';\n        //         if (_item.sizeId)\n        //             _txtSize = _item.size;\n\n        //         _txt = _txt + `${_item.category}: ${_txtQty} ${_item.flavor} ${_txtSize} \\n`;\n        //     }\n        //     total_price += _item.price;\n        // }\n        // _txt = _txt + ': ' + formatAsCurrency(total_price) + '\\n\\n';\n\n        // _txt = _txt + 'Deseja incluir mais itens?';\n\n        // const _options = [];\n        // _options.push({\n        //     text: 'Sim, mostre-me as opes',\n        //     data: {\n        //         type: 'confirmation_yes',\n        //         backTo: 'partial_confirmation',\n        //     },\n        //     event: 'ORDER_ASK_CATEGORY',\n        // });\n        // _options.push({\n        //     text: 'No, confirmar o pedido',\n        //     data: {\n        //         type: 'confirmation_yes',\n        //         backTo: 'partial_confirmation',\n        //     },\n        //     event: 'ORDER_PIZZA_CONFIRMATION',\n        // });\n\n        // return {\n        //     type: 'replies',\n        //     text: _txt,\n        //     options: _options,\n        // };\n    }\n}\n\nexport const cancelPendingShowPartialOrder = async (pageId, userId) => {\n    // TODO: delete items with status 0;\n    const po = await getOrderPending({ pageId, userId, isComplete: true });\n\n    if (po.items && po.items.length > 0) {\n        await deletePendingItem(pageId, po.order.id);\n\n        for (let i = 0; i < po.items.length; i++) {\n            if (po.items[i].status === 0) {\n                po.items.splice(i, 1);\n            }\n        }\n    }\n    return await showPartialOrder(pageId, userId, po);\n}\n\nexport const showPartialOrder = async (pageId, userId, po) => {\n    if (!po)\n        po = await getOrderPending({ pageId, userId, isComplete: true });\n\n    await updateOrder({ pageId, userId, waitingFor: 'partial_confirmation', eraseSplit: true, undo: '' });\n\n    let total_price = 0;\n    let _txt = ':' + po.order.id + '\\n';\n\n    if (po.items && po.items.length > 0) {\n        _txt = _txt + 'Seguem os detalhes do seu pedido:\\n\\n';\n        for (const item of po.items) {\n            if (item.flavorId) {\n                let _txtQty = item.split > 1 ? item.qty + '/' + item.split : item.qty;\n\n                let _txtSize = '';\n                if (item.sizeId)\n                    _txtSize = item.size;\n\n                // _txt = _txt + `${item.category}: ${_txtQty} ${item.flavor} ${_txtSize} - ${formatAsCurrency(item.price)} \\n`;\n                _txt = _txt + `${_txtQty} ${item.flavor} ${_txtSize} - ${formatAsCurrency(item.price)} \\n`;\n            }\n            if (item.price)\n                total_price += item.price;\n        }\n        if (po.order.deliver_type && po.order.deliver_type === 'delivery') {\n            if (po.order.delivery_fee > 0) {\n                _txt += `*Taxa de Entrega:* ${formatAsCurrency(po.order.delivery_fee)}\\n`\n                total_price += po.order.delivery_fee;\n            }\n        }\n        _txt = _txt + ': ' + formatAsCurrency(total_price) + '\\n\\n';\n\n    } else {\n        _txt = _txt + 'Ainda no foram includos itens no seu pedido.\\n\\n';\n    }\n\n    _txt = _txt + 'O que deseja fazer?';\n\n    const _options = [];\n    _options.push({\n        text: `Incluir ${po.items && po.items.length > 0 ? 'mais' : ''} itens no pedido`,\n        event: 'ORDER_ASK_CATEGORY',\n    });\n    if (po.items && po.items.length > 0) {\n        _options.push({\n            text: '*Confirmar o pedido*',\n            data: {\n                type: 'confirmation_yes',\n                backTo: 'partial_confirmation',\n            },\n            event: 'ORDER_PIZZA_CONFIRMATION',\n        });\n        _options.push({\n            text: 'Remover algum item',\n            data: {\n                backTo: 'partial_confirmation',\n                option: 'remove_item',\n            },\n            event: 'ORDER_WANT_CHANGE',\n        });\n        _options.push({\n            text: 'Observaes em algum item',\n            data: {\n                backTo: 'partial_confirmation',\n                option: 'change_item',\n            },\n            event: 'ORDER_WANT_CHANGE',\n        });\n    }\n    _options.push({\n        text: 'Voltar p/ Incio',\n        data: 'stoporder_init',\n        event: 'STOP_ORDER_OPTIONS',\n    });\n\n    return {\n        type: 'replies',\n        text: _txt,\n        options: _options,\n    };\n}\n\n\n// export const showOrderOrNextItem = async (pageId, userId) => {\n//     const po = await getOrderPending({ pageId, userId, isComplete: true });\n\n//     if (po.order.originalSplit > 1 && po.order.currentItemSplit <= po.order.originalSplit) {\n//         return await askForFlavor(pageId, userId, 1, po);\n//     } else if (po.order.qty > 1 && po.order.currentItem < po.order.qty) {\n//         const nextItem = po.order.currentItem + 1;\n//         await updateOrder({ pageId, userId, waitingFor: 'size', currentItem: nextItem });\n//         return await askForSize(pageId, userId);\n//     } else {\n//         await updateOrder({ pageId, userId, waitingFor: 'partial_confirmation', backToConfirmation: null });\n\n//         let total_price = 0;\n//         let _txt = 'Seguem os detalhes do seu pedido:\\n';\n//         _txt = _txt + ':' + po.order.id + '\\n';\n//         for (let i = 0; i < po.items.length; i++) {\n//             const _item = po.items[i];\n//             if (_item.flavorId && _item.sizeId) {\n//                 let _txtQty = _item.split > 1 ? _item.qty + '/' + _item.split : _item.qty;\n//                 _txt = _txt + `${_txtQty} pizza ${_item.size} de ${_item.flavor}\\n`;\n//             } else if (_item.beverageId && _item.beverage) {\n//                 _txt = _txt + `1 ${_item.beverage}\\n`;\n//             }\n//             total_price += _item.price;\n//         }\n//         if (po.order.deliver_type && po.order.deliver_type === 'pickup')\n//             _txt += 'Cliente vem retirar.'\n//         else\n//             _txt = _txt + '  : ' + po.order.address + '\\n';\n//         _txt = _txt + ': ' + po.order.phone + '\\n';\n//         _txt = _txt + ': ' + formatAsCurrency(total_price) + '\\n';\n//         _txt = _txt + 'O pedido est correto?';\n\n//         const _options = [];\n//         _options.push({\n//             text: 'Sim',\n//             data: {\n//                 type: 'confirmation_yes',\n//                 backTo: 'partial_confirmation',\n//             },\n//             event: 'ORDER_PIZZA_CONFIRMATION',\n//         });\n//         _options.push({\n//             text: 'No',\n//             data: {\n//                 type: 'confirmation_no',\n//                 backTo: 'partial_confirmation',\n//             },\n//             event: 'ORDER_PIZZA_CONFIRMATION',\n//         });\n\n//         return {\n//             type: 'replies',\n//             text: _txt,\n//             options: _options,\n//         };\n//     }\n// }\n\n\n/**\n * Used on Whatsapp\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showFlavorCheckItem = async (pageId, userId, data) => {\n    const prevAnswer = await showFlavor(pageId, userId, data);\n    const nextQuestion = await showOrderOrNextItem(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\nexport const askForPaymentType = async (pageId, userId) => {\n    const _options = [];\n\n    const storeData = await getStoreData(pageId);\n    if (storeData.payment_types && storeData.payment_types.length > 0) {\n        for (let paymentType of storeData.payment_types) {\n            let _txt = paymentType.payment_type;\n            if (paymentType.surcharge_percent > 0) {\n                _txt += ` (Cobramos + ${paymentType.surcharge_percent}% no valor do pedido)`;\n            } else if (paymentType.surcharge_amount > 0) {\n                _txt += ` (Cobramos + ${formatAsCurrency(paymentType.surcharge_amount)} no valor do pedido)`;\n            }\n\n            _options.push({\n                text: _txt, data: {\n                    payment_type: paymentType.payment_type,\n                    surcharge_percent: paymentType.surcharge_percent,\n                    surcharge_amount: paymentType.surcharge_amount,\n                }, event: 'ORDER_PAYMENT_TYPE',\n            });\n        }\n    } else {\n        _options.push({\n            text: 'Dinheiro', data: {\n                payment_type: 'Dinheiro', surcharge_percent: 0, surcharge_amonut: 0,\n            }, event: 'ORDER_PAYMENT_TYPE',\n        });\n        _options.push({\n            text: 'Carto', data: {\n                payment_type: 'Carto', surcharge_percent: 0, surcharge_amount: 0,\n            }, event: 'ORDER_PAYMENT_TYPE',\n        });\n    }\n\n\n    await updateOrder({ pageId, userId, waitingFor: 'payment_type' });\n\n    return {\n        type: 'replies',\n        text: 'Qual a forma de pagamento?',\n        options: _options,\n    };\n}\n\nexport const showPaymentType = async (pageId, userId, data) => {\n    await updateOrder({\n        pageId, userId, paymentType: data.payment_type,\n        surcharge_percent: data.surcharge_percent, surcharge_amount: data.surcharge_amount,\n    });\n\n    let _txtPaymentType = data.payment_type;\n\n    return {\n        type: 'text',\n        text: ' ' + ' Forma de pagamento: ' + _txtPaymentType,\n    };\n}\n\nexport const askForPaymentChange = async (pageId, userId) => {\n    const _options = [];\n    _options.push({ text: 'Sim', data: 'payment_change_yes', event: 'ORDER_PAYMENT_CHANGE' });\n    _options.push({ text: 'No', data: 'payment_change_no', event: 'ORDER_PAYMENT_CHANGE' });\n\n    await updateOrder({ pageId, userId, waitingFor: 'payment_change' });\n\n    return {\n        type: 'replies',\n        text: 'Precisa de troco?',\n        options: _options,\n    };\n}\n\n\n/**\n * Used on Whatsapp\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showPaymentTypeAskForPaymentChange = async (pageId, userId, data) => {\n    const prevAnswer = await showPaymentType(pageId, userId, data);\n    const nextQuestion = await askForPaymentChange(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\nexport const showPaymentChange = async (pageId, userId, data) => {\n    await updateOrder({ pageId, userId, paymentChange: data });\n\n    let _txtPaymentChange = data === 'payment_change_yes'\n        ? 'Levaremos trocado'\n        : 'No precisa de troco';\n\n    return {\n        type: 'text',\n        text: ' ' + _txtPaymentChange,\n    };\n}\n\nexport const askForComments = async (pageId, userId) => {\n    const _options = [];\n    _options.push({ text: 'Sim', data: 'comments_yes', event: 'ORDER_COMMENTS' });\n    _options.push({ text: 'No', data: 'comments_no', event: 'ORDER_COMMENTS' });\n\n    await updateOrder({ pageId, userId, waitingFor: 'comments' });\n\n    return {\n        type: 'replies',\n        text: 'Quer enviar alguma observao sobre o pedido ou entrega?',\n        options: _options,\n    };\n}\n\nexport const showPaymentChangeAskForComments = async (pageId, userId, data) => {\n    const prevAnswer = await showPaymentChange(pageId, userId, data);\n    const nextQuestion = await askForComments(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\nexport const askToTypeComments = async (pageID, userID, item) => {\n    let _txt;\n    if (item) {\n        await updateOrder({ pageId: pageID, userId: userID, waitingFor: 'typed_comments_item', waitingForData: item.id });\n        _txt = 'Diga o que gostaria de pedir: por ex. sem cebola ou ovos. Pode digitar:';\n    } else {\n        await updateOrder({ pageId: pageID, userId: userID, waitingFor: 'typed_comments' });\n        _txt = 'Digite as observaes que voc tem para a entrega ou pedido. Pode digitar!';\n    }\n    return {\n        type: 'text',\n        text: _txt,\n    }\n}\n\n\nexport const showComments = async (pageId, userId, text) => {\n    await updateOrder({ pageId, userId, comments: text });\n\n    let _txtComments = 'Observaes para o pedido/entrega:\\n';\n    _txtComments += text;\n\n    return {\n        type: 'text',\n        text: ' ' + _txtComments,\n    };\n}\n\nexport const showFullOrder = async (pageId, userId) => {\n    // await updateOrder({ pageId, userId, waitingFor: 'full_confirmation', backToConfirmation: null });\n\n    const po = await getOrderPending({ pageId, userId, isComplete: true });\n\n    let total_price = 0;\n    let _txt = 'Seguem os detalhes do seu pedido:\\n\\n';\n\n    _txt = _txt + ': ' + po.order.id + '\\n';\n    for (const item of po.items) {\n        if (item.flavorId) {\n            let _txtQty = item.split > 1 ? item.qty + '/' + item.split : item.qty;\n            let _txtSize = item.sizeId ? item.size : '';\n            // _txt = _txt + `_${item.category}_: ${_txtQty} ${item.flavor}  ${_txtSize}\\n`;\n            _txt = _txt + `${_txtQty} ${item.flavor}  ${_txtSize}\\n`;\n            total_price += item.price;\n        }\n    }\n\n    if (po.order.deliver_type && po.order.deliver_type === 'pickup') {\n        _txt += 'Cliente retira.\\n'\n        if (po.order.store_address)\n            _txt += ' Nosso endereo: ' + po.order.store_address + '\\n';\n    } else {\n        _txt += '  : ' + po.order.address + '\\n';\n\n        if (po.order.delivery_fee > 0) {\n            _txt += `  : ${formatAsCurrency(po.order.delivery_fee)}\\n`\n            total_price += po.order.delivery_fee;\n        }\n    }\n\n    _txt = _txt + ': ' + po.order.phone + '\\n';\n    _txt = _txt + '  : ' + po.order.payment_type + '\\n';\n\n    if (po.payment_change === 'payment_change_yes') {\n        _txt = _txt + ' ? Sim \\n';\n    }\n\n    if (po.order.surcharge_percent > 0) {\n        _txt += `  ${po.order.payment_type}: ${po.order.surcharge_percent * 100}%\\n`\n        total_price += total_price * po.order.surcharge_percent;\n    }\n\n    if (po.order.surcharge_amount > 0) {\n        _txt += `  ${po.order.payment_type}: ${formatAsCurrency(po.order.surcharge_amount)}\\n`\n        total_price += po.order.surcharge_amount;\n    }\n\n    _txt = _txt + ': ' + formatAsCurrency(total_price) + '\\n';\n\n    let _txtComments = po.order.comments || 'Sem observaes';\n    _txt = _txt + ': ' + _txtComments + '\\n';\n\n    return {\n        type: 'text',\n        text: _txt,\n    }\n\n    // the code below was used to ask for a final confirmation.\n    // _txt = _txt + 'Posso confirmar o pedido?';\n\n    // const _options = [];\n    // _options.push({\n    //     text: 'Sim',\n    //     data: {\n    //         type: 'confirmation_yes',\n    //         backTo: 'full_confirmation',\n    //     },\n    //     event: 'ORDER_CONFIRMATION',\n    // });\n    // _options.push({\n    //     text: 'No',\n    //     data: {\n    //         type: 'confirmation_no',\n    //         backTo: 'full_confirmation',\n    //     },\n    //     event: 'ORDER_CONFIRMATION',\n    // });\n\n    // return {\n    //     type: 'replies',\n    //     text: _txt,\n    //     options: _options,\n    // };\n}\n\n/**\n * Used on Whatsapp\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showPaymentTypeAskForComments = async (pageId, userId, data) => {\n    const prevAnswer = await showPaymentType(pageId, userId, data);\n    const nextQuestion = await askForComments(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n/**\n * Used on Whatsapp\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showFullOrderConfirmOrder = async (pageId, userId, data) => {\n    if (data && data !== 'comments_no')\n        await showComments(pageId, userId, data);\n    // const nextQuestion = await showFullOrder(pageId, userId);\n\n    const prevAnswer = await showFullOrder(pageId, userId);\n    const nextAnswer = await confirmOrder(pageId, userId);\n\n    nextAnswer.text = prevAnswer.text + '\\n\\n' + nextAnswer.text;\n    return nextAnswer;\n}\n\nexport const confirmOrder = async (pageId, userId) => {\n    await updateOrder({ pageId, userId, confirmOrder: true, calcTotal: true });\n\n    return {\n        type: 'text',\n        text: ' Pedido Confirmado!',\n    };\n}\n\nexport const askForChangeOrder = async (pageId, userId, data) => {\n    let confirmStep;\n    if (data && data.hasOwnProperty('backTo')) {\n        confirmStep = data.backTo;\n    }\n\n    if (confirmStep) {\n        await updateOrder({ pageId, userId, waitingFor: 'change_order', backToConfirmation: confirmStep });\n    } else {\n        await updateOrder({ pageId, userId, waitingFor: 'change_order' });\n    }\n\n    let _txt = 'O que voc gostaria de fazer com o seu pedido?';\n\n    const _options = [];\n    _options.push({ text: 'Mudar pedido', data: 'changeOrder', event: 'ORDER_WANT_CHANGE' });\n    _options.push({ text: 'Mudar endereo', data: 'change_address', event: 'ORDER_CHANGE' });\n\n    if (confirmStep) {\n        // confirmStep can be 'partial_confirmation' or 'full_confirmation'\n        const _evt = confirmStep === 'partial_confirmation'\n            ? 'ORDER_PIZZA_CONFIRMATION'\n            : 'ORDER_CONFIRMATION';\n\n        _options.push({\n            text: 'Confirmar.',\n            data: { type: 'confirmation_yes', backTo: confirmStep },\n            event: _evt,\n        });\n    }\n\n    return {\n        type: 'replies',\n        text: _txt,\n        options: _options,\n    };\n}\n\nexport const askForOptionsToChange = async (pageId, userId, item) => {\n    try {\n        let _txt = 'Ok, o que voc gostaria de fazer?';\n\n        const _options = [];\n        _options.push({ text: 'Mandar observao para esse item', data: item, event: 'ORDER_CHANGE_ITEM' });\n        _options.push({ text: 'Cancelar/Remover', data: item, event: 'ORDER_CANCEL_ITEM' });\n\n        return {\n            type: 'replies',\n            text: _txt,\n            options: _options,\n        };\n    } catch (askForOptionsToChangeErr) {\n        console.error({ askForOptionsToChangeErr });\n        throw askForOptionsToChangeErr;\n    }\n}\n\nexport const askForSpecificItem = async (pageId, userId, data) => {\n    const pendingOrder = await getOrderPending({ pageId, userId, isComplete: true });\n    if (pendingOrder.items && pendingOrder.items.length > 1) {\n\n        const _options = [];\n        let _itemId = 0;\n        for (let item of pendingOrder.items) {\n            if (item.itemId !== _itemId) {\n                let _txt;\n                if (item.size && item.flavor) {\n                    let _sizeSplit = `${item.size}`;\n                    if (item.split && item.split > 1) {\n                        if (item.category.toUpperCase().indexOf('PIZZA') > -1)\n                            _sizeSplit = 'Pizza ' + _sizeSplit;\n                        _sizeSplit = _sizeSplit + ` ${item.split} Sabores`;\n                    } else\n                        _sizeSplit = item.flavor + ' ' + _sizeSplit;\n\n                    _txt = `${_sizeSplit}`;\n                } else {\n                    _txt = item.flavor;\n                }\n\n                if (_txt) {\n                    if (data && data.option === 'change_item') {\n                        _options.push({ text: _txt, data: item, event: 'ORDER_CHANGE_ITEM' });\n                    } else {\n                        _options.push({ text: _txt, data: item, event: 'ORDER_CANCEL_ITEM' });\n                    }\n                }\n\n                _itemId = item.itemId;\n            }\n        }\n\n        let _txtHead = 'Escolha qual dos itens deseja ';\n        if (data && data.option === 'change_item')\n            _txtHead = _txtHead + 'alterar:';\n        else\n            _txtHead = _txtHead + 'remover:';\n\n\n        return {\n            type: 'replies',\n            text: _txtHead,\n            options: _options,\n        };\n    } else {\n        await updateOrder({ pageId, userId, completeItem: false });\n        return await askForOptionsToChange(pageId, userId, pendingOrder.items[0]);\n    }\n}\n\n/**\n *\n * @param {*} pageId\n * @param {*} userId\n */\nexport const askForWantBeverage = async (pageId, userId) => {\n    updateOrder({ pageId, userId, waitingFor: 'want_beverage' });\n\n    const pendingOrder = await getOrderPending({ pageId, userId, isComplete: false });\n\n    const noBeverage = pendingOrder.order.no_beverage;\n\n    if (typeof noBeverage === 'undefined') {\n\n        let _txt = 'Gostaria de algo para beber?';\n\n        const _options = [];\n        _options.push({ text: 'Sim', data: 'beverage_yes', event: 'ORDER_CONFIRM_BEVERAGE' });\n        _options.push({ text: 'No', data: 'beverage_no', event: 'ORDER_CONFIRM_BEVERAGE' });\n        return {\n            type: 'replies',\n            text: _txt,\n            options: _options,\n        };\n    } else {\n        return showFullOrder(pageId, userId);\n    }\n}\n/**\n *\n * @param {*} pageId\n * @param {*} userId\n * @param {*} multiple\n */\nexport const askForBeverages = async (pageId, userId, multiple) => {\n    await updateOrder({ pageId, userId, waitingFor: 'beverage', noBeverage: false });\n\n    const beveragesArr = await getBeverages(pageId);\n    let _rangeIni = (multiple - 1) * 4;\n    let _rangeEnd = multiple * 4;\n\n    const _options = [];\n    for (let i = _rangeIni; i < _rangeEnd; i++) {\n        if (beveragesArr[i]) {\n            const _bev = beveragesArr[i];\n            const _data = { id: _bev.id, beverage: _bev.name, price: _bev.price }\n            const buttons = { text: 'Quero', data: _data, event: 'ORDER_BEVERAGE' };\n\n            let _subtext = _bev.kind;\n            if (_bev.price) {\n                _subtext = _subtext.concat('\\n R$', _bev.price);\n            }\n            _options.push({ text: _bev.name, subtext: _subtext, buttons });\n        }\n    }\n    if ((beveragesArr.length + 1) > _rangeEnd) {\n        multiple++;\n        const buttonsOpt = {\n            text: '+ Opes',\n            data: { option: 'beverages_more', multiple: multiple },\n            event: 'ORDER_BEVERAGE',\n        };\n        _options.push({\n            text: 'Clique aqui p/ ver + opes',\n            buttons: buttonsOpt,\n            isOnlyButtons: true,\n        });\n    } else {\n        const _data = { option: 'beverages_cancel' }\n        const buttons = { text: 'Sem bebida', data: _data, event: 'ORDER_BEVERAGE' };\n        let _subtext = 'Se no encontrou, selecione \"Sem bebida\"';\n        _options.push({ text: 'Sem bebida', subtext: _subtext, buttons });\n    }\n\n    return {\n        type: 'fulllist',\n        text: 'Selecione uma bebida:',\n        options: _options,\n    };\n}\n\n/**\n * Show that user did not want beverage and update order with this info.\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showNoBeverage = async (pageId, userId, data) => {\n    await updateOrder({ pageId, userId, noBeverage: true, waitingFor: 'confirm' });\n\n    return { type: 'text', text: ' ' + ' Sem bebida para o seu pedido. ' };\n}\n\n/**\n * Show the chosen beverage.\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showBeverage = async (pageId, userId, data) => {\n    await updateOrder({ pageId, userId, beverageId: data.id, beveragePrice: data.price, completeItem: true, noBeverage: false, waitingFor: 'full_confirmation', calcTotal: true });\n\n    return {\n        type: 'text',\n        text: ' ' + '1 Bebida: ' + data.beverage,\n    }\n}\n\n/**\n * Used on Whatsapp\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showBeverageAskForPaymentType = async (pageId, userId, data) => {\n    const prevAnswer = await showBeverage(pageId, userId, data);\n    const nextQuestion = await askForPaymentType(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n/**\n * Used on Whatsapp\n * @param {*} pageId\n * @param {*} userId\n * @param {*} data\n */\nexport const showNoBeverageAskForPaymentType = async (pageId, userId, data) => {\n    const prevAnswer = await showNoBeverage(pageId, userId, data);\n    const nextQuestion = await askForPaymentType(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n/**\n * Cancel the selected item, reorder the itemIds and askForSize\n * @param {*} pageId\n * @param {*} userId\n * @param {*} itemId\n */\nexport const changeItem = async (pageId, userId, item) => {\n    return askToTypeComments(pageId, userId, item);\n}\n\nexport const showCommentsItem = async (pageId, userId, data) => {\n    const po = await getOrderPending({ pageId, userId, isComplete: false });\n\n    if (po && po.order && po.order.waitingFor === 'typed_comments_item') {\n        // without await to run later.\n        updateItemDirect(pageId, po.order.id, po.order.waitingForData, data);\n    }\n\n    return await showPartialOrder(pageId, userId);\n}\n\n\nexport const cancelItem = async (pageId, userId, item) => {\n    const po = await getOrderPending({ pageId, userId, isComplete: false });\n    const result1 = await deleteItem(pageId, po.order.id, item.itemId);\n    console.info('cancelItem:', result1);\n    // if (result1) {\n    if (po.order.backToConfirmation === 'full_confirmation') {\n        return await showFullOrder(pageId, userId);\n    } else\n        return await showPartialOrder(pageId, userId);\n    // }\n}\n\n\nexport const updateItemAskOptions = async (pageId, userId, item) => {\n    // const item = await updateStatusSpecificItem(objectId, 0);\n    return await askForOptionsToChange(pageId, userId, item);\n}\n\nexport const sendShippingNotification = async (pageId, userId, orderId) => {\n    const { accessToken } = await getOnePageToken(pageId);\n\n    const _txt = 'O seu pedido nmero ' + orderId + ' acabou de sair para entrega. Bom apetite!';\n\n    const out = new Elements();\n    out.add({ text: _txt });\n    await Bot.send_message_tag(accessToken, userId, out);\n}\n\nexport const sendRejectionNotification = async (pageId, userId, orderId, rejectionExplanation) => {\n    const { accessToken } = await getOnePageToken(pageId);\n\n    const _txt = 'Infelizmente no poderemos atender o seu pedido nmero '\n        + orderId\n        + '. Segue o motivo: '\n        + rejectionExplanation;\n\n    const out = new Elements();\n    out.add({ text: _txt });\n    await Bot.send_message_tag(accessToken, userId, out);\n}\n\n/**\n * Delete the pending order and shows the Main Menu.\n * @param {*} pageId\n * @param {*} userId\n */\nexport const cancelPendingOrder = async (pageId, userId) => {\n    await cancelOrder({ pageId, userId });\n\n    const out = await sendMainMenu();\n    out.text = ' Pedido Cancelado!' + '\\n\\n' + out.text;\n\n    return out;\n}\n\nexport const showDeliverAskForCategory = async (pageId, userId, data, user, source) => {\n    const prevAnswer = await showDeliver(pageId, userId, data, user, source);\n    const nextQuestion = await askForCategory(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n\nexport const showAddressAskForCategory = async (pageId, userId, addrData, source) => {\n    const prevAnswer = await showAddress(pageId, userId, addrData, source);\n    const nextQuestion = await askForCategory(pageId, userId);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\n/**\n * \n * @param {*} pageId\n * @param {*} userId\n * @param {*} split: if true, only show categories that are marked 'is_pizza'.\n * Show only categories with split to allow user mix categories in same pizza.\n */\nexport const askForCategory = async (pageId, userId, split) => {\n    await updateOrder({ pageId, userId, waitingFor: 'category', waitingForData: split });\n\n    const categories = await getCategories(pageId);\n\n    let _txt = '';\n    if (split) {\n        _txt = `Para escolher o ${split}o. sabor, escolha a categoria:\\n`\n    } else {\n        _txt = 'Selecione uma categoria:';\n    }\n\n    const _options = [];\n    for (let item of categories) {\n        if (split && !item.is_pizza)\n            continue;\n\n        const _data = { id: item.id, name: item.name }\n        const buttons = { text: 'Quero', data: _data, event: 'ORDER_CATEGORY' };\n\n        _options.push({ text: item.name, subtext: item.name, buttons });\n    }\n\n    const buttons = { text: 'Voltar', data: 'partial_confirmation', event: 'ORDER_PARTIAL_CONFIRMATION' };\n    _options.push({ text: 'Voltar para o pedido', subtext: 'Voltar para o pedido', buttons });\n\n    return {\n        type: 'list',\n        text: _txt,\n        options: _options,\n    }\n}\n\nexport const showCategory = async (pageId, userId, data) => {\n    await updateOrder({ pageId, userId, categoryId: data.id, eraseSize: true });\n\n    return {\n        type: 'text',\n        text: ' ' + 'Categoria: ' + data.name,\n    }\n}\n\n\nexport const showCategoryAskForSize = async (pageId, userId, data) => {\n    const prevAnswer = await showCategory(pageId, userId, data);\n    const nextQuestion = await askForSizeCat(pageId, userId, data.id);\n\n    nextQuestion.text = prevAnswer.text + '\\n\\n' + nextQuestion.text;\n    return nextQuestion;\n}\n\nexport const askForSizeCat = async (pageId, userId, categoryId) => {\n    const po = await getOrderPending({ pageId, userId, isComplete: false });\n\n    if (!categoryId)\n        categoryId = po.order.currentItemCategory;\n\n    // User is spliting the pizza into more than one category\n    if (po.order.originalSplit > 1 && po.order.currentItemSplit <= po.order.originalSplit) {\n        return askForFlavor(pageId, userId, 1, po);\n    } else {\n\n        const category = await getCategory(pageId, categoryId);\n\n        if (category.price_by_size) {\n            const sizesWithPricing = await getPricingSizing(pageId, categoryId); // only sizes with pricing\n\n            // only 1 size priced, bot IS NOT ASKS FOR THAT.\n            if (sizesWithPricing.length === 1) {\n                const size = await getSize(pageId, sizesWithPricing[0]);\n                const sizeData = {\n                    id: size.id,\n                    size: size.size,\n                }\n                // Update the order with the unique size and checkSplit\n                return showSizeCheckSplit(pageId, userId, sizeData);\n            } else {\n                // Without await, to run later\n                updateOrder({ pageId, userId, waitingFor: 'size' });\n\n                const _text = 'Selecione o tamanho:';\n\n                const _options = [];\n                const sizes = await getSizes(pageId, sizesWithPricing);\n\n                for (let i = 0; i < sizes.length; i++) {\n                    const _data = { id: sizes[i].id, size: sizes[i].size, split: sizes[i].split };\n                    _options.push({ text: sizes[i].size, data: _data, event: 'ORDER_SIZE' });\n                }\n\n                return {\n                    type: 'replies',\n                    text: _text,\n                    options: _options,\n                }\n            }\n        } else {\n            return await askForFlavor(pageId, userId, 1);\n        }\n    }\n}\n"],"file":"botController.js"}