{"version":3,"sources":["../../../src/api/bot/simpleBotController.js"],"names":["basicReply","pageId","userId","replyText","user","data","confirm","_phone","waitingFor","comments","confirmOrder","phone","type","text","basicOption","optionText","message","_options","push","subText","hidden","options","basicComments","basicPostComments","autoReplyMsg","postComments","mergeComments","order","basicAutoReply","sentAutoReply"],"mappings":"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","sourcesContent":["import { updateOrder } from '../controllers/simpleOrdersController';\nimport { formatWhatsappNumber } from '../util/util';\n// import { emitEventBotWebapp } from './redisController';\n\n/**\n *\n * @param {*} pageId .\n * @param {*} userId .\n * @param {*} replyText is gonna be returned by bot\n * @param {*} user\n * @param {*} data message received by the bot\n */\nexport const basicReply = async (pageId, userId, replyText, user, data) => {\n    const confirm = !!data;\n    const _phone = formatWhatsappNumber(userId);\n    await updateOrder(\n        {\n            pageId, userId,\n            waitingFor: 'typed_comments',\n            user: user,\n            comments: data,\n            confirmOrder: confirm,\n            phone: _phone,\n        });\n    return { type: 'text', text: replyText };\n}\n\nexport const basicOption = async (pageId, userId, text, optionText, data, user, message) => {\n    const _phone = formatWhatsappNumber(userId);\n\n    await updateOrder({\n        pageId,\n        userId,\n        waitingFor: 'typed_comments',\n        user: user,\n        phone: _phone,\n        comments: message,\n    });\n\n    const _options = [];\n    _options.push({ text: optionText, subText: data, hidden: true });\n\n    return {\n        type: 'list',\n        text: text,\n        options: _options,\n    };\n}\n\n/**\n * Just update the comments, do not return nothing.\n * @param {*} pageId\n * @param {*} userId\n * @param {*} text\n */\nexport const basicComments = async (pageId, userId, text, user) => {\n    await updateOrder({ pageId, userId, waitingFor: 'typed_comments', comments: text, user: user, confirmOrder: true });\n    return true;\n}\n\n/**\n * Just update the comments, do not return nothing.\n * @param {*} pageId\n * @param {*} userId\n * @param {*} text\n */\nexport const basicPostComments = async (pageId, userId, text, user, autoReplyMsg) => {\n    const _phone = formatWhatsappNumber(userId);\n    const order = await updateOrder({\n        pageId, userId,\n        phone: _phone,\n        waitingFor: 'typed_comments',\n        postComments: text,\n        user: user,\n        mergeComments: true,\n        autoReplyMsg: autoReplyMsg,\n    });\n    return order;\n\n    // WhatsappWebBot-Delay - This solution works well with delay managed by whatsapp-web-bot.\n    // if (autoReplyMsg) {\n    //     if (!order.sent_autoreply) {            \n    //         return basicAutoReply(pageId, userId, autoReplyMsg)\n    //     } else return true;\n    // } else return true;\n}\n\n// WhatsappWebBot-Delay - This solution works well with delay managed by whatsapp-web-bot.\n// export const basicAutoReply = async (pageId, userId, text) => {\n//     await updateOrder({\n//         pageId, userId, sentAutoReply: true, comments: text, mergeComments: true,\n//     });\n//     return { type: 'text', text: text, msgType: 'withdelay' };\n// }\n\nexport const basicAutoReply = async (pageId, userId, text) => {\n    await updateOrder({\n        pageId, userId, sentAutoReply: true, comments: text, mergeComments: true,\n    });\n    return true;\n}"],"file":"simpleBotController.js"}