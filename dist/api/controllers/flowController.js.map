{"version":3,"sources":["../../../src/api/controllers/flowController.js"],"names":["deleteManyFlows","pageID","Flow","deleteMany","pageId","exec","updateFlow","orderData","orderId","userId","step","find","select","sort","limit","resultLastId","itemId","length","id","record","save"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;AAEA;;;;AAIO,IAAMA,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,iBAAOC,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACdC,iBAAKC,UAAL,CAAgB;AAAEC,cAAAA,MAAM,EAAEH;AAAV,aAAhB,EAAoCI,IAApC,EADc;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAfL,eAAe;AAAA;AAAA;AAAA,GAArB;;;;AAIA,IAAMM,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAG,kBAAMC,SAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACdC,YAAAA,OADc,GACoBD,SADpB,CACdC,OADc,EACLC,MADK,GACoBF,SADpB,CACLE,MADK,EACGL,MADH,GACoBG,SADpB,CACGH,MADH,EACWM,IADX,GACoBH,SADpB,CACWG,IADX;AAAA;AAAA,mBAGGR,iBAAKS,IAAL,CAAU;AAAEP,cAAAA,MAAM,EAAEA,MAAV;AAAkBI,cAAAA,OAAO,EAAEA;AAA3B,aAAV,EAAgDI,MAAhD,CAAuD,IAAvD,EAA6DC,IAA7D,CAAkE,KAAlE,EAAyEC,KAAzE,CAA+E,CAA/E,EAAkFT,IAAlF,EAHH;;AAAA;AAGlBU,YAAAA,YAHkB;AAIlBC,YAAAA,MAJkB,GAIT,CAJS;AAKtB,gBAAID,YAAY,IAAIA,YAAY,CAACE,MAAjC,EACID,MAAM,GAAGD,YAAY,CAAC,CAAD,CAAZ,CAAgBG,EAAhB,GAAqB,CAA9B;AAEEC,YAAAA,MARgB,GAQP,IAAIjB,gBAAJ,CAAS;AACpBgB,cAAAA,EAAE,EAAEF,MADgB;AAEpBR,cAAAA,OAAO,EAAEA,OAFW;AAGpBC,cAAAA,MAAM,EAAEA,MAHY;AAIpBL,cAAAA,MAAM,EAAEA,MAJY;AAKpBM,cAAAA,IAAI,EAAEA;AALc,aAAT,CARO;AAAA;AAAA,mBAehBS,MAAM,CAACC,IAAP,EAfgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAVd,UAAU;AAAA;AAAA;AAAA,GAAhB","sourcesContent":["import mongoose from 'mongoose';\nimport Flow from '../models/flow';\n\n/**\n * Delete all records from a pageID\n * @param {*} pageID \n */\nexport const deleteManyFlows = async (pageID) => {\n    return await Flow.deleteMany({ pageId: pageID }).exec();\n}\n\nexport const updateFlow = async orderData => {\n    const { orderId, userId, pageId, step } = orderData;\n\n    let resultLastId = await Flow.find({ pageId: pageId, orderId: orderId }).select('id').sort('-id').limit(1).exec();\n    let itemId = 1;\n    if (resultLastId && resultLastId.length)\n        itemId = resultLastId[0].id + 1;\n\n    const record = new Flow({\n        id: itemId,\n        orderId: orderId,\n        userId: userId,\n        pageId: pageId,\n        step: step\n    });\n    await record.save();\n}"],"file":"flowController.js"}